import{r as $o,j as he}from"./index-DX2mtma_.js";import{s as Ie}from"./settingsService-Tte2DU1T.js";const Cd=({imageUrl:t,onClose:e})=>($o.useEffect(()=>{const n=o=>{o.key==="Escape"&&e()};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[e]),he.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 p-4 transition-opacity duration-300",onClick:e,role:"dialog","aria-modal":"true",children:[he.jsx("button",{className:"absolute top-4 right-4 text-white text-4xl font-bold hover:text-gray-300 transition-colors z-50",onClick:e,"aria-label":"Close image viewer",children:"Ã—"}),he.jsx("div",{className:"relative max-w-full max-h-full",onClick:n=>n.stopPropagation(),children:he.jsx("img",{src:t,alt:"Full size view",className:"block max-w-[95vw] max-h-[95vh] object-contain rounded-lg shadow-2xl"})})]}));var Yo={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Oo,Wo;function Ko(){return{geminiUrl:Oo,vertexUrl:Wo}}function zo(t,e,n,o){var i,a;if(!(t!=null&&t.baseUrl)){const l=Ko();return e?(i=l.vertexUrl)!==null&&i!==void 0?i:n:(a=l.geminiUrl)!==null&&a!==void 0?a:o}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class K{}function E(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(o,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const a=e[i];return a!=null?String(a):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function s(t,e,n){for(let a=0;a<e.length-1;a++){const l=e[a];if(l.endsWith("[]")){const u=l.slice(0,-2);if(!(u in t))if(Array.isArray(n))t[u]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(t[u])){const d=t[u];if(Array.isArray(n))for(let c=0;c<d.length;c++){const p=d[c];s(p,e.slice(a+1),n[c])}else for(const c of d)s(c,e.slice(a+1),n)}return}else if(l.endsWith("[0]")){const u=l.slice(0,-3);u in t||(t[u]=[{}]);const d=t[u];s(d[0],e.slice(a+1),n);return}(!t[l]||typeof t[l]!="object")&&(t[l]={}),t=t[l]}const o=e[e.length-1],i=t[o];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${o}`)}else o==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[o]=n}function r(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let o=0;o<e.length;o++){if(typeof t!="object"||t===null)return n;const i=e[o];if(i.endsWith("[]")){const a=i.slice(0,-2);if(a in t){const l=t[a];return Array.isArray(l)?l.map(u=>r(u,e.slice(o+1),n)):n}else return n}else t=t[i]}return t}catch(o){if(o instanceof TypeError)return n;throw o}}function Xo(t,e){for(const[n,o]of Object.entries(e)){const i=n.split("."),a=o.split("."),l=new Set;let u=-1;for(let d=0;d<i.length;d++)if(i[d]==="*"){u=d;break}if(u!==-1&&a.length>u)for(let d=u;d<a.length;d++){const c=a[d];c!=="*"&&!c.endsWith("[]")&&!c.endsWith("[0]")&&l.add(c)}Ve(t,i,a,0,l)}}function Ve(t,e,n,o,i){if(o>=e.length||typeof t!="object"||t===null)return;const a=e[o];if(a.endsWith("[]")){const l=a.slice(0,-2),u=t;if(l in u&&Array.isArray(u[l]))for(const d of u[l])Ve(d,e,n,o+1,i)}else if(a==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const l=t,u=Object.keys(l).filter(c=>!c.startsWith("_")&&!i.has(c)),d={};for(const c of u)d[c]=l[c];for(const[c,p]of Object.entries(d)){const f=[];for(const h of n.slice(o))h==="*"?f.push(c):f.push(h);s(l,f,p)}for(const c of u)delete l[c]}}else{const l=t;a in l&&Ve(l[a],e,n,o+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function et(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Qo(t){const e={},n=r(t,["operationName"]);n!=null&&s(e,["operationName"],n);const o=r(t,["resourceName"]);return o!=null&&s(e,["_url","resourceName"],o),e}function Zo(t){const e={},n=r(t,["name"]);n!=null&&s(e,["name"],n);const o=r(t,["metadata"]);o!=null&&s(e,["metadata"],o);const i=r(t,["done"]);i!=null&&s(e,["done"],i);const a=r(t,["error"]);a!=null&&s(e,["error"],a);const l=r(t,["response","generateVideoResponse"]);return l!=null&&s(e,["response"],ei(l)),e}function jo(t){const e={},n=r(t,["name"]);n!=null&&s(e,["name"],n);const o=r(t,["metadata"]);o!=null&&s(e,["metadata"],o);const i=r(t,["done"]);i!=null&&s(e,["done"],i);const a=r(t,["error"]);a!=null&&s(e,["error"],a);const l=r(t,["response"]);return l!=null&&s(e,["response"],ti(l)),e}function ei(t){const e={},n=r(t,["generatedSamples"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>ni(l))),s(e,["generatedVideos"],a)}const o=r(t,["raiMediaFilteredCount"]);o!=null&&s(e,["raiMediaFilteredCount"],o);const i=r(t,["raiMediaFilteredReasons"]);return i!=null&&s(e,["raiMediaFilteredReasons"],i),e}function ti(t){const e={},n=r(t,["videos"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>oi(l))),s(e,["generatedVideos"],a)}const o=r(t,["raiMediaFilteredCount"]);o!=null&&s(e,["raiMediaFilteredCount"],o);const i=r(t,["raiMediaFilteredReasons"]);return i!=null&&s(e,["raiMediaFilteredReasons"],i),e}function ni(t){const e={},n=r(t,["video"]);return n!=null&&s(e,["video"],ui(n)),e}function oi(t){const e={},n=r(t,["_self"]);return n!=null&&s(e,["video"],ci(n)),e}function ii(t){const e={},n=r(t,["operationName"]);return n!=null&&s(e,["_url","operationName"],n),e}function ri(t){const e={},n=r(t,["operationName"]);return n!=null&&s(e,["_url","operationName"],n),e}function si(t){const e={},n=r(t,["name"]);n!=null&&s(e,["name"],n);const o=r(t,["metadata"]);o!=null&&s(e,["metadata"],o);const i=r(t,["done"]);i!=null&&s(e,["done"],i);const a=r(t,["error"]);a!=null&&s(e,["error"],a);const l=r(t,["response"]);return l!=null&&s(e,["response"],ai(l)),e}function ai(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["parent"]);o!=null&&s(e,["parent"],o);const i=r(t,["documentName"]);return i!=null&&s(e,["documentName"],i),e}function Wn(t){const e={},n=r(t,["name"]);n!=null&&s(e,["name"],n);const o=r(t,["metadata"]);o!=null&&s(e,["metadata"],o);const i=r(t,["done"]);i!=null&&s(e,["done"],i);const a=r(t,["error"]);a!=null&&s(e,["error"],a);const l=r(t,["response"]);return l!=null&&s(e,["response"],li(l)),e}function li(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["parent"]);o!=null&&s(e,["parent"],o);const i=r(t,["documentName"]);return i!=null&&s(e,["documentName"],i),e}function ui(t){const e={},n=r(t,["uri"]);n!=null&&s(e,["uri"],n);const o=r(t,["encodedVideo"]);o!=null&&s(e,["videoBytes"],et(o));const i=r(t,["encoding"]);return i!=null&&s(e,["mimeType"],i),e}function ci(t){const e={},n=r(t,["gcsUri"]);n!=null&&s(e,["uri"],n);const o=r(t,["bytesBase64Encoded"]);o!=null&&s(e,["videoBytes"],et(o));const i=r(t,["mimeType"]);return i!=null&&s(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ft;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(ft||(ft={}));var ht;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(ht||(ht={}));var mt;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(mt||(mt={}));var M;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(M||(M={}));var gt;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(gt||(gt={}));var yt;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(yt||(yt={}));var vt;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(vt||(vt={}));var Tt;(function(t){t.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",t.HTTP_IN_QUERY="HTTP_IN_QUERY",t.HTTP_IN_HEADER="HTTP_IN_HEADER",t.HTTP_IN_PATH="HTTP_IN_PATH",t.HTTP_IN_BODY="HTTP_IN_BODY",t.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Tt||(Tt={}));var Et;(function(t){t.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",t.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",t.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",t.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Et||(Et={}));var St;(function(t){t.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",t.LOW="LOW",t.HIGH="HIGH"})(St||(St={}));var It;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(It||(It={}));var Ct;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Ct||(Ct={}));var _t;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(_t||(_t={}));var At;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE",t.IMAGE_RECITATION="IMAGE_RECITATION",t.IMAGE_OTHER="IMAGE_OTHER"})(At||(At={}));var wt;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(wt||(wt={}));var Rt;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Rt||(Rt={}));var Pt;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Pt||(Pt={}));var Mt;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(Mt||(Mt={}));var Nt;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Nt||(Nt={}));var ee;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(ee||(ee={}));var xt;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(xt||(xt={}));var Dt;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Dt||(Dt={}));var kt;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(kt||(kt={}));var qe;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(qe||(qe={}));var Ut;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V",t.TUNING_TASK_R2V="TUNING_TASK_R2V"})(Ut||(Ut={}));var Lt;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Lt||(Lt={}));var Ft;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(Ft||(Ft={}));var bt;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(bt||(bt={}));var Gt;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Gt||(Gt={}));var Vt;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Vt||(Vt={}));var qt;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(qt||(qt={}));var Ht;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(Ht||(Ht={}));var Bt;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(Bt||(Bt={}));var Jt;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(Jt||(Jt={}));var $t;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})($t||($t={}));var Yt;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Yt||(Yt={}));var Ot;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Ot||(Ot={}));var Wt;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Wt||(Wt={}));var Kt;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(Kt||(Kt={}));var zt;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(zt||(zt={}));var Xt;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(Xt||(Xt={}));var Qt;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(Qt||(Qt={}));var Zt;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING"})(Zt||(Zt={}));var jt;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.STATE_PENDING="STATE_PENDING",t.STATE_ACTIVE="STATE_ACTIVE",t.STATE_FAILED="STATE_FAILED"})(jt||(jt={}));var en;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(en||(en={}));var tn;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(tn||(tn={}));var nn;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(nn||(nn={}));var on;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(on||(on={}));var rn;(function(t){t.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",t.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",t.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(rn||(rn={}));var sn;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(sn||(sn={}));var an;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(an||(an={}));var ln;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(ln||(ln={}));var un;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(un||(un={}));var cn;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(cn||(cn={}));var dn;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(dn||(dn={}));var oe;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(oe||(oe={}));class He{constructor(e){const n={};for(const o of e.headers.entries())n[o[0]]=o[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class de{get text(){var e,n,o,i,a,l,u,d;if(((i=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let c="",p=!1;const f=[];for(const h of(d=(u=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[m,g]of Object.entries(h))m!=="text"&&m!=="thought"&&m!=="thoughtSignature"&&(g!==null||g!==void 0)&&f.push(m);if(typeof h.text=="string"){if(typeof h.thought=="boolean"&&h.thought)continue;p=!0,c+=h.text}}return f.length>0&&console.warn(`there are non-text parts ${f} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),p?c:void 0}get data(){var e,n,o,i,a,l,u,d;if(((i=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let c="";const p=[];for(const f of(d=(u=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[h,m]of Object.entries(f))h!=="inlineData"&&(m!==null||m!==void 0)&&p.push(h);f.inlineData&&typeof f.inlineData.data=="string"&&(c+=atob(f.inlineData.data))}return p.length>0&&console.warn(`there are non-data parts ${p} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),c.length>0?btoa(c):void 0}get functionCalls(){var e,n,o,i,a,l,u,d;if(((i=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const c=(d=(u=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(p=>p.functionCall).map(p=>p.functionCall).filter(p=>p!==void 0);if((c==null?void 0:c.length)!==0)return c}get executableCode(){var e,n,o,i,a,l,u,d,c;if(((i=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const p=(d=(u=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(f=>f.executableCode).map(f=>f.executableCode).filter(f=>f!==void 0);if((p==null?void 0:p.length)!==0)return(c=p==null?void 0:p[0])===null||c===void 0?void 0:c.code}get codeExecutionResult(){var e,n,o,i,a,l,u,d,c;if(((i=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const p=(d=(u=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(f=>f.codeExecutionResult).map(f=>f.codeExecutionResult).filter(f=>f!==void 0);if((p==null?void 0:p.length)!==0)return(c=p==null?void 0:p[0])===null||c===void 0?void 0:c.output}}class pn{}class fn{}class di{}class pi{}class fi{}class hi{}class hn{}class mn{}class gn{}class mi{}class Ce{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const o=new Ce;let i;const a=e;return n?i=jo(a):i=Zo(a),Object.assign(o,i),o}}class yn{}class vn{}class Tn{}class En{}class gi{}class yi{}class vi{}class tt{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const o=new tt,a=si(e);return Object.assign(o,a),o}}class Ti{}class Ei{}class Si{}class Sn{}class Ii{get text(){var e,n,o;let i="",a=!1;const l=[];for(const u of(o=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&o!==void 0?o:[]){for(const[d,c]of Object.entries(u))d!=="text"&&d!=="thought"&&c!==null&&l.push(d);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;a=!0,i+=u.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?i:void 0}get data(){var e,n,o;let i="";const a=[];for(const l of(o=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&o!==void 0?o:[]){for(const[u,d]of Object.entries(l))u!=="inlineData"&&d!==null&&a.push(u);l.inlineData&&typeof l.inlineData.data=="string"&&(i+=atob(l.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class Ci{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class nt{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const o=new nt,a=Wn(e);return Object.assign(o,a),o}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function N(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Kn(t,e){const n=N(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function zn(t){return Array.isArray(t)?t.map(e=>_e(e)):[_e(t)]}function _e(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function Xn(t){const e=_e(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Qn(t){const e=_e(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function In(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function Zn(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>In(e)):[In(t)]}function Be(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function Cn(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function _n(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function b(t){if(t==null)throw new Error("ContentUnion is required");return Be(t)?t:{role:"user",parts:Zn(t)}}function ot(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const o=b(n);return o.parts&&o.parts.length>0&&o.parts[0].text!==void 0?[o.parts[0].text]:[]});if(t.isVertexAI()){const n=b(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>b(n)):[b(e)]}function q(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(Cn(t)||_n(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[b(t)]}const e=[],n=[],o=Be(t[0]);for(const i of t){const a=Be(i);if(a!=o)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(i);else{if(Cn(i)||_n(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return o||e.push({role:"user",parts:Zn(n)}),e}function _i(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(o=>o!=="null");if(n.length===1)e.type=Object.values(M).includes(n[0].toUpperCase())?n[0].toUpperCase():M.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const o of n)e.anyOf.push({type:Object.values(M).includes(o.toUpperCase())?o.toUpperCase():M.TYPE_UNSPECIFIED})}}function re(t){const e={},n=["items"],o=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=t.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,t=a[1]):a[1].type==="null"&&(e.nullable=!0,t=a[0])),t.type instanceof Array&&_i(t.type,e);for(const[l,u]of Object.entries(t))if(u!=null)if(l=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;e.type=Object.values(M).includes(u.toUpperCase())?u.toUpperCase():M.TYPE_UNSPECIFIED}else if(n.includes(l))e[l]=re(u);else if(o.includes(l)){const d=[];for(const c of u){if(c.type=="null"){e.nullable=!0;continue}d.push(re(c))}e[l]=d}else if(i.includes(l)){const d={};for(const[c,p]of Object.entries(u))d[c]=re(p);e[l]=d}else{if(l==="additionalProperties")continue;e[l]=u}return e}function it(t){return re(t)}function rt(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function st(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function le(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=re(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=re(e.response));return t}function ue(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function Ai(t,e,n,o=1){const i=!e.startsWith(`${n}/`)&&e.split("/").length===o;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:i?`${n}/${e}`:e}function z(t,e){if(typeof e!="string")throw new Error("name must be a string");return Ai(t,e,"cachedContents")}function jn(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function Q(t){return et(t)}function wi(t){return t!=null&&typeof t=="object"&&"name"in t}function Ri(t){return t!=null&&typeof t=="object"&&"video"in t}function Pi(t){return t!=null&&typeof t=="object"&&"uri"in t}function eo(t){var e;let n;if(wi(t)&&(n=t.name),!(Pi(t)&&(n=t.uri,n===void 0))&&!(Ri(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function to(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function no(t){for(const e of["models","tunedModels","publisherModels"])if(Mi(t,e))return t[e];return[]}function Mi(t,e){return t!==null&&typeof t=="object"&&e in t}function Ni(t,e={}){const n=t,o={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(o.responseJsonSchema=n.outputSchema),e.behavior&&(o.behavior=e.behavior),{functionDeclarations:[o]}}function xi(t,e={}){const n=[],o=new Set;for(const i of t){const a=i.name;if(o.has(a))throw new Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);o.add(a);const l=Ni(i,e);l.functionDeclarations&&n.push(...l.functionDeclarations)}return{functionDeclarations:n}}function oo(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const o=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(i>0||o!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(o>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function Di(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function io(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return t;let a=!1;for(const l of i){if(typeof l!="object"||l===null)continue;const d=l.response;if(typeof d!="object"||d===null)continue;if(d.embedding!==void 0){a=!0;break}}return a&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function ce(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function ro(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ki(t){const e={},n=r(t,["responsesFile"]);n!=null&&s(e,["fileName"],n);const o=r(t,["inlinedResponses","inlinedResponses"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>fr(l))),s(e,["inlinedResponses"],a)}const i=r(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),s(e,["inlinedEmbedContentResponses"],a)}return e}function Ui(t){const e={},n=r(t,["predictionsFormat"]);n!=null&&s(e,["format"],n);const o=r(t,["gcsDestination","outputUriPrefix"]);o!=null&&s(e,["gcsUri"],o);const i=r(t,["bigqueryDestination","outputUri"]);return i!=null&&s(e,["bigqueryUri"],i),e}function Li(t){const e={},n=r(t,["format"]);n!=null&&s(e,["predictionsFormat"],n);const o=r(t,["gcsUri"]);o!=null&&s(e,["gcsDestination","outputUriPrefix"],o);const i=r(t,["bigqueryUri"]);if(i!=null&&s(e,["bigqueryDestination","outputUri"],i),r(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(r(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(r(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Ee(t){const e={},n=r(t,["name"]);n!=null&&s(e,["name"],n);const o=r(t,["metadata","displayName"]);o!=null&&s(e,["displayName"],o);const i=r(t,["metadata","state"]);i!=null&&s(e,["state"],ro(i));const a=r(t,["metadata","createTime"]);a!=null&&s(e,["createTime"],a);const l=r(t,["metadata","endTime"]);l!=null&&s(e,["endTime"],l);const u=r(t,["metadata","updateTime"]);u!=null&&s(e,["updateTime"],u);const d=r(t,["metadata","model"]);d!=null&&s(e,["model"],d);const c=r(t,["metadata","output"]);return c!=null&&s(e,["dest"],ki(io(c))),e}function Je(t){const e={},n=r(t,["name"]);n!=null&&s(e,["name"],n);const o=r(t,["displayName"]);o!=null&&s(e,["displayName"],o);const i=r(t,["state"]);i!=null&&s(e,["state"],ro(i));const a=r(t,["error"]);a!=null&&s(e,["error"],a);const l=r(t,["createTime"]);l!=null&&s(e,["createTime"],l);const u=r(t,["startTime"]);u!=null&&s(e,["startTime"],u);const d=r(t,["endTime"]);d!=null&&s(e,["endTime"],d);const c=r(t,["updateTime"]);c!=null&&s(e,["updateTime"],c);const p=r(t,["model"]);p!=null&&s(e,["model"],p);const f=r(t,["inputConfig"]);f!=null&&s(e,["src"],Fi(f));const h=r(t,["outputConfig"]);h!=null&&s(e,["dest"],Ui(io(h)));const m=r(t,["completionStats"]);return m!=null&&s(e,["completionStats"],m),e}function Fi(t){const e={},n=r(t,["instancesFormat"]);n!=null&&s(e,["format"],n);const o=r(t,["gcsSource","uris"]);o!=null&&s(e,["gcsUri"],o);const i=r(t,["bigquerySource","inputUri"]);return i!=null&&s(e,["bigqueryUri"],i),e}function bi(t,e){const n={};if(r(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(r(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(r(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const o=r(e,["fileName"]);o!=null&&s(n,["fileName"],o);const i=r(e,["inlinedRequests"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>pr(t,l))),s(n,["requests","requests"],a)}return n}function Gi(t){const e={},n=r(t,["format"]);n!=null&&s(e,["instancesFormat"],n);const o=r(t,["gcsUri"]);o!=null&&s(e,["gcsSource","uris"],o);const i=r(t,["bigqueryUri"]);if(i!=null&&s(e,["bigquerySource","inputUri"],i),r(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(r(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function Vi(t){const e={},n=r(t,["data"]);if(n!=null&&s(e,["data"],n),r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=r(t,["mimeType"]);return o!=null&&s(e,["mimeType"],o),e}function qi(t,e){const n={},o=r(e,["name"]);return o!=null&&s(n,["_url","name"],ce(t,o)),n}function Hi(t,e){const n={},o=r(e,["name"]);return o!=null&&s(n,["_url","name"],ce(t,o)),n}function Bi(t){const e={},n=r(t,["content"]);n!=null&&s(e,["content"],n);const o=r(t,["citationMetadata"]);o!=null&&s(e,["citationMetadata"],Ji(o));const i=r(t,["tokenCount"]);i!=null&&s(e,["tokenCount"],i);const a=r(t,["finishReason"]);a!=null&&s(e,["finishReason"],a);const l=r(t,["avgLogprobs"]);l!=null&&s(e,["avgLogprobs"],l);const u=r(t,["groundingMetadata"]);u!=null&&s(e,["groundingMetadata"],u);const d=r(t,["index"]);d!=null&&s(e,["index"],d);const c=r(t,["logprobsResult"]);c!=null&&s(e,["logprobsResult"],c);const p=r(t,["safetyRatings"]);if(p!=null){let h=p;Array.isArray(h)&&(h=h.map(m=>m)),s(e,["safetyRatings"],h)}const f=r(t,["urlContextMetadata"]);return f!=null&&s(e,["urlContextMetadata"],f),e}function Ji(t){const e={},n=r(t,["citationSources"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>i)),s(e,["citations"],o)}return e}function so(t){const e={},n=r(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(a=>Er(a))),s(e,["parts"],i)}const o=r(t,["role"]);return o!=null&&s(e,["role"],o),e}function $i(t,e){const n={},o=r(t,["displayName"]);if(e!==void 0&&o!=null&&s(e,["batch","displayName"],o),r(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function Yi(t,e){const n={},o=r(t,["displayName"]);e!==void 0&&o!=null&&s(e,["displayName"],o);const i=r(t,["dest"]);return e!==void 0&&i!=null&&s(e,["outputConfig"],Li(Di(i))),n}function An(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["_url","model"],N(t,o));const i=r(e,["src"]);i!=null&&s(n,["batch","inputConfig"],bi(t,oo(t,i)));const a=r(e,["config"]);return a!=null&&$i(a,n),n}function Oi(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["model"],N(t,o));const i=r(e,["src"]);i!=null&&s(n,["inputConfig"],Gi(oo(t,i)));const a=r(e,["config"]);return a!=null&&Yi(a,n),n}function Wi(t,e){const n={},o=r(t,["displayName"]);return e!==void 0&&o!=null&&s(e,["batch","displayName"],o),n}function Ki(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["_url","model"],N(t,o));const i=r(e,["src"]);i!=null&&s(n,["batch","inputConfig"],tr(t,i));const a=r(e,["config"]);return a!=null&&Wi(a,n),n}function zi(t,e){const n={},o=r(e,["name"]);return o!=null&&s(n,["_url","name"],ce(t,o)),n}function Xi(t,e){const n={},o=r(e,["name"]);return o!=null&&s(n,["_url","name"],ce(t,o)),n}function Qi(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["name"]);o!=null&&s(e,["name"],o);const i=r(t,["done"]);i!=null&&s(e,["done"],i);const a=r(t,["error"]);return a!=null&&s(e,["error"],a),e}function Zi(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["name"]);o!=null&&s(e,["name"],o);const i=r(t,["done"]);i!=null&&s(e,["done"],i);const a=r(t,["error"]);return a!=null&&s(e,["error"],a),e}function ji(t,e){const n={},o=r(e,["contents"]);if(o!=null){let a=ot(t,o);Array.isArray(a)&&(a=a.map(l=>l)),s(n,["requests[]","request","content"],a)}const i=r(e,["config"]);return i!=null&&(s(n,["_self"],er(i,n)),Xo(n,{"requests[].*":"requests[].request.*"})),n}function er(t,e){const n={},o=r(t,["taskType"]);e!==void 0&&o!=null&&s(e,["requests[]","taskType"],o);const i=r(t,["title"]);e!==void 0&&i!=null&&s(e,["requests[]","title"],i);const a=r(t,["outputDimensionality"]);if(e!==void 0&&a!=null&&s(e,["requests[]","outputDimensionality"],a),r(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(r(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function tr(t,e){const n={},o=r(e,["fileName"]);o!=null&&s(n,["file_name"],o);const i=r(e,["inlinedRequests"]);return i!=null&&s(n,["requests"],ji(t,i)),n}function nr(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["fileUri"]);n!=null&&s(e,["fileUri"],n);const o=r(t,["mimeType"]);return o!=null&&s(e,["mimeType"],o),e}function or(t){const e={},n=r(t,["id"]);n!=null&&s(e,["id"],n);const o=r(t,["args"]);o!=null&&s(e,["args"],o);const i=r(t,["name"]);if(i!=null&&s(e,["name"],i),r(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(r(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function ir(t){const e={},n=r(t,["mode"]);n!=null&&s(e,["mode"],n);const o=r(t,["allowedFunctionNames"]);if(o!=null&&s(e,["allowedFunctionNames"],o),r(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function rr(t,e,n){const o={},i=r(e,["systemInstruction"]);n!==void 0&&i!=null&&s(n,["systemInstruction"],so(b(i)));const a=r(e,["temperature"]);a!=null&&s(o,["temperature"],a);const l=r(e,["topP"]);l!=null&&s(o,["topP"],l);const u=r(e,["topK"]);u!=null&&s(o,["topK"],u);const d=r(e,["candidateCount"]);d!=null&&s(o,["candidateCount"],d);const c=r(e,["maxOutputTokens"]);c!=null&&s(o,["maxOutputTokens"],c);const p=r(e,["stopSequences"]);p!=null&&s(o,["stopSequences"],p);const f=r(e,["responseLogprobs"]);f!=null&&s(o,["responseLogprobs"],f);const h=r(e,["logprobs"]);h!=null&&s(o,["logprobs"],h);const m=r(e,["presencePenalty"]);m!=null&&s(o,["presencePenalty"],m);const g=r(e,["frequencyPenalty"]);g!=null&&s(o,["frequencyPenalty"],g);const v=r(e,["seed"]);v!=null&&s(o,["seed"],v);const y=r(e,["responseMimeType"]);y!=null&&s(o,["responseMimeType"],y);const T=r(e,["responseSchema"]);T!=null&&s(o,["responseSchema"],it(T));const I=r(e,["responseJsonSchema"]);if(I!=null&&s(o,["responseJsonSchema"],I),r(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(r(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const S=r(e,["safetySettings"]);if(n!==void 0&&S!=null){let D=S;Array.isArray(D)&&(D=D.map(Y=>Sr(Y))),s(n,["safetySettings"],D)}const C=r(e,["tools"]);if(n!==void 0&&C!=null){let D=ue(C);Array.isArray(D)&&(D=D.map(Y=>Cr(le(Y)))),s(n,["tools"],D)}const w=r(e,["toolConfig"]);if(n!==void 0&&w!=null&&s(n,["toolConfig"],Ir(w)),r(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const P=r(e,["cachedContent"]);n!==void 0&&P!=null&&s(n,["cachedContent"],z(t,P));const R=r(e,["responseModalities"]);R!=null&&s(o,["responseModalities"],R);const U=r(e,["mediaResolution"]);U!=null&&s(o,["mediaResolution"],U);const _=r(e,["speechConfig"]);if(_!=null&&s(o,["speechConfig"],rt(_)),r(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const x=r(e,["thinkingConfig"]);x!=null&&s(o,["thinkingConfig"],x);const L=r(e,["imageConfig"]);L!=null&&s(o,["imageConfig"],dr(L));const X=r(e,["enableEnhancedCivicAnswers"]);return X!=null&&s(o,["enableEnhancedCivicAnswers"],X),o}function sr(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["candidates"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(c=>Bi(c))),s(e,["candidates"],d)}const i=r(t,["modelVersion"]);i!=null&&s(e,["modelVersion"],i);const a=r(t,["promptFeedback"]);a!=null&&s(e,["promptFeedback"],a);const l=r(t,["responseId"]);l!=null&&s(e,["responseId"],l);const u=r(t,["usageMetadata"]);return u!=null&&s(e,["usageMetadata"],u),e}function ar(t,e){const n={},o=r(e,["name"]);return o!=null&&s(n,["_url","name"],ce(t,o)),n}function lr(t,e){const n={},o=r(e,["name"]);return o!=null&&s(n,["_url","name"],ce(t,o)),n}function ur(t){const e={};if(r(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=r(t,["enableWidget"]);return n!=null&&s(e,["enableWidget"],n),e}function cr(t){const e={};if(r(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(r(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=r(t,["timeRangeFilter"]);return n!=null&&s(e,["timeRangeFilter"],n),e}function dr(t){const e={},n=r(t,["aspectRatio"]);n!=null&&s(e,["aspectRatio"],n);const o=r(t,["imageSize"]);if(o!=null&&s(e,["imageSize"],o),r(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(r(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function pr(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["request","model"],N(t,o));const i=r(e,["contents"]);if(i!=null){let u=q(i);Array.isArray(u)&&(u=u.map(d=>so(d))),s(n,["request","contents"],u)}const a=r(e,["metadata"]);a!=null&&s(n,["metadata"],a);const l=r(e,["config"]);return l!=null&&s(n,["request","generationConfig"],rr(t,l,r(n,["request"],{}))),n}function fr(t){const e={},n=r(t,["response"]);n!=null&&s(e,["response"],sr(n));const o=r(t,["error"]);return o!=null&&s(e,["error"],o),e}function hr(t,e){const n={},o=r(t,["pageSize"]);e!==void 0&&o!=null&&s(e,["_query","pageSize"],o);const i=r(t,["pageToken"]);if(e!==void 0&&i!=null&&s(e,["_query","pageToken"],i),r(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function mr(t,e){const n={},o=r(t,["pageSize"]);e!==void 0&&o!=null&&s(e,["_query","pageSize"],o);const i=r(t,["pageToken"]);e!==void 0&&i!=null&&s(e,["_query","pageToken"],i);const a=r(t,["filter"]);return e!==void 0&&a!=null&&s(e,["_query","filter"],a),n}function gr(t){const e={},n=r(t,["config"]);return n!=null&&hr(n,e),e}function yr(t){const e={},n=r(t,["config"]);return n!=null&&mr(n,e),e}function vr(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["nextPageToken"]);o!=null&&s(e,["nextPageToken"],o);const i=r(t,["operations"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>Ee(l))),s(e,["batchJobs"],a)}return e}function Tr(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["nextPageToken"]);o!=null&&s(e,["nextPageToken"],o);const i=r(t,["batchPredictionJobs"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>Je(l))),s(e,["batchJobs"],a)}return e}function Er(t){const e={},n=r(t,["mediaResolution"]);n!=null&&s(e,["mediaResolution"],n);const o=r(t,["codeExecutionResult"]);o!=null&&s(e,["codeExecutionResult"],o);const i=r(t,["executableCode"]);i!=null&&s(e,["executableCode"],i);const a=r(t,["fileData"]);a!=null&&s(e,["fileData"],nr(a));const l=r(t,["functionCall"]);l!=null&&s(e,["functionCall"],or(l));const u=r(t,["functionResponse"]);u!=null&&s(e,["functionResponse"],u);const d=r(t,["inlineData"]);d!=null&&s(e,["inlineData"],Vi(d));const c=r(t,["text"]);c!=null&&s(e,["text"],c);const p=r(t,["thought"]);p!=null&&s(e,["thought"],p);const f=r(t,["thoughtSignature"]);f!=null&&s(e,["thoughtSignature"],f);const h=r(t,["videoMetadata"]);return h!=null&&s(e,["videoMetadata"],h),e}function Sr(t){const e={},n=r(t,["category"]);if(n!=null&&s(e,["category"],n),r(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const o=r(t,["threshold"]);return o!=null&&s(e,["threshold"],o),e}function Ir(t){const e={},n=r(t,["functionCallingConfig"]);n!=null&&s(e,["functionCallingConfig"],ir(n));const o=r(t,["retrievalConfig"]);return o!=null&&s(e,["retrievalConfig"],o),e}function Cr(t){const e={},n=r(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(f=>f)),s(e,["functionDeclarations"],p)}if(r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=r(t,["googleSearchRetrieval"]);o!=null&&s(e,["googleSearchRetrieval"],o);const i=r(t,["computerUse"]);i!=null&&s(e,["computerUse"],i);const a=r(t,["fileSearch"]);a!=null&&s(e,["fileSearch"],a);const l=r(t,["codeExecution"]);if(l!=null&&s(e,["codeExecution"],l),r(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=r(t,["googleMaps"]);u!=null&&s(e,["googleMaps"],ur(u));const d=r(t,["googleSearch"]);d!=null&&s(e,["googleSearch"],cr(d));const c=r(t,["urlContext"]);return c!=null&&s(e,["urlContext"],c),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var W;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",t.PAGED_ITEM_DOCUMENTS="documents"})(W||(W={}));class te{constructor(e,n,o,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,o,i)}init(e,n,o){var i,a;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!o||Object.keys(o).length===0?l={config:{}}:typeof o=="object"?l=Object.assign({},o):l=o,l.config&&(l.config.pageToken=n.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(a=(i=l.config)===null||i===void 0?void 0:i.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _r extends K{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new te(W.PAGED_ITEM_BATCH_JOBS,o=>this.listInternal(o),await this.listInternal(n),n),this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)}}createInlinedGenerateContentRequest(e){const n=An(this.apiClient,e),o=n._url,i=E("{model}:batchGenerateContent",o),u=n.batch.inputConfig.requests,d=u.requests,c=[];for(const p of d){const f=Object.assign({},p);if(f.systemInstruction){const h=f.systemInstruction;delete f.systemInstruction;const m=f.request;m.systemInstruction=h,f.request=m}c.push(f)}return u.requests=c,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const o=n?Object.assign({},n):{},i=Date.now().toString();if(o.displayName||(o.displayName=`genaiBatchJob_${i}`),o.dest===void 0){const a=this.getGcsUri(e),l=this.getBigqueryUri(e);if(a)a.endsWith(".jsonl")?o.dest=`${a.slice(0,-6)}/dest`:o.dest=`${a}_dest_${i}`;else if(l)o.dest=`${l}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return o}async createInternal(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Oi(this.apiClient,e);return u=E("batchPredictionJobs",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>Je(p))}else{const c=An(this.apiClient,e);return u=E("{model}:batchGenerateContent",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>Ee(p))}}async createEmbeddingsInternal(e){var n,o;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Ki(this.apiClient,e);return a=E("{model}:asyncBatchEmbedContent",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>Ee(d))}}async get(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=lr(this.apiClient,e);return u=E("batchPredictionJobs/{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>Je(p))}else{const c=ar(this.apiClient,e);return u=E("batches/{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>Ee(p))}}async cancel(e){var n,o,i,a;let l="",u={};if(this.apiClient.isVertexAI()){const d=Hi(this.apiClient,e);l=E("batchPredictionJobs/{name}:cancel",d._url),u=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}else{const d=qi(this.apiClient,e);l=E("batches/{name}:cancel",d._url),u=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal})}}async listInternal(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=yr(e);return u=E("batchPredictionJobs",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=Tr(p),h=new Sn;return Object.assign(h,f),h})}else{const c=gr(e);return u=E("batches",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=vr(p),h=new Sn;return Object.assign(h,f),h})}}async delete(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Xi(this.apiClient,e);return u=E("batchPredictionJobs/{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>Zi(p))}else{const c=zi(this.apiClient,e);return u=E("batches/{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>Qi(p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ar(t){const e={},n=r(t,["data"]);if(n!=null&&s(e,["data"],n),r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=r(t,["mimeType"]);return o!=null&&s(e,["mimeType"],o),e}function wn(t){const e={},n=r(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(a=>Kr(a))),s(e,["parts"],i)}const o=r(t,["role"]);return o!=null&&s(e,["role"],o),e}function wr(t,e){const n={},o=r(t,["ttl"]);e!==void 0&&o!=null&&s(e,["ttl"],o);const i=r(t,["expireTime"]);e!==void 0&&i!=null&&s(e,["expireTime"],i);const a=r(t,["displayName"]);e!==void 0&&a!=null&&s(e,["displayName"],a);const l=r(t,["contents"]);if(e!==void 0&&l!=null){let p=q(l);Array.isArray(p)&&(p=p.map(f=>wn(f))),s(e,["contents"],p)}const u=r(t,["systemInstruction"]);e!==void 0&&u!=null&&s(e,["systemInstruction"],wn(b(u)));const d=r(t,["tools"]);if(e!==void 0&&d!=null){let p=d;Array.isArray(p)&&(p=p.map(f=>Xr(f))),s(e,["tools"],p)}const c=r(t,["toolConfig"]);if(e!==void 0&&c!=null&&s(e,["toolConfig"],zr(c)),r(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function Rr(t,e){const n={},o=r(t,["ttl"]);e!==void 0&&o!=null&&s(e,["ttl"],o);const i=r(t,["expireTime"]);e!==void 0&&i!=null&&s(e,["expireTime"],i);const a=r(t,["displayName"]);e!==void 0&&a!=null&&s(e,["displayName"],a);const l=r(t,["contents"]);if(e!==void 0&&l!=null){let f=q(l);Array.isArray(f)&&(f=f.map(h=>h)),s(e,["contents"],f)}const u=r(t,["systemInstruction"]);e!==void 0&&u!=null&&s(e,["systemInstruction"],b(u));const d=r(t,["tools"]);if(e!==void 0&&d!=null){let f=d;Array.isArray(f)&&(f=f.map(h=>Qr(h))),s(e,["tools"],f)}const c=r(t,["toolConfig"]);e!==void 0&&c!=null&&s(e,["toolConfig"],c);const p=r(t,["kmsKeyName"]);return e!==void 0&&p!=null&&s(e,["encryption_spec","kmsKeyName"],p),n}function Pr(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["model"],Kn(t,o));const i=r(e,["config"]);return i!=null&&wr(i,n),n}function Mr(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["model"],Kn(t,o));const i=r(e,["config"]);return i!=null&&Rr(i,n),n}function Nr(t,e){const n={},o=r(e,["name"]);return o!=null&&s(n,["_url","name"],z(t,o)),n}function xr(t,e){const n={},o=r(e,["name"]);return o!=null&&s(n,["_url","name"],z(t,o)),n}function Dr(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&s(e,["sdkHttpResponse"],n),e}function kr(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&s(e,["sdkHttpResponse"],n),e}function Ur(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["fileUri"]);n!=null&&s(e,["fileUri"],n);const o=r(t,["mimeType"]);return o!=null&&s(e,["mimeType"],o),e}function Lr(t){const e={},n=r(t,["id"]);n!=null&&s(e,["id"],n);const o=r(t,["args"]);o!=null&&s(e,["args"],o);const i=r(t,["name"]);if(i!=null&&s(e,["name"],i),r(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(r(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Fr(t){const e={},n=r(t,["mode"]);n!=null&&s(e,["mode"],n);const o=r(t,["allowedFunctionNames"]);if(o!=null&&s(e,["allowedFunctionNames"],o),r(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function br(t){const e={};if(r(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=r(t,["description"]);n!=null&&s(e,["description"],n);const o=r(t,["name"]);o!=null&&s(e,["name"],o);const i=r(t,["parameters"]);i!=null&&s(e,["parameters"],i);const a=r(t,["parametersJsonSchema"]);a!=null&&s(e,["parametersJsonSchema"],a);const l=r(t,["response"]);l!=null&&s(e,["response"],l);const u=r(t,["responseJsonSchema"]);return u!=null&&s(e,["responseJsonSchema"],u),e}function Gr(t,e){const n={},o=r(e,["name"]);return o!=null&&s(n,["_url","name"],z(t,o)),n}function Vr(t,e){const n={},o=r(e,["name"]);return o!=null&&s(n,["_url","name"],z(t,o)),n}function qr(t){const e={};if(r(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=r(t,["enableWidget"]);return n!=null&&s(e,["enableWidget"],n),e}function Hr(t){const e={};if(r(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(r(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=r(t,["timeRangeFilter"]);return n!=null&&s(e,["timeRangeFilter"],n),e}function Br(t,e){const n={},o=r(t,["pageSize"]);e!==void 0&&o!=null&&s(e,["_query","pageSize"],o);const i=r(t,["pageToken"]);return e!==void 0&&i!=null&&s(e,["_query","pageToken"],i),n}function Jr(t,e){const n={},o=r(t,["pageSize"]);e!==void 0&&o!=null&&s(e,["_query","pageSize"],o);const i=r(t,["pageToken"]);return e!==void 0&&i!=null&&s(e,["_query","pageToken"],i),n}function $r(t){const e={},n=r(t,["config"]);return n!=null&&Br(n,e),e}function Yr(t){const e={},n=r(t,["config"]);return n!=null&&Jr(n,e),e}function Or(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["nextPageToken"]);o!=null&&s(e,["nextPageToken"],o);const i=r(t,["cachedContents"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),s(e,["cachedContents"],a)}return e}function Wr(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["nextPageToken"]);o!=null&&s(e,["nextPageToken"],o);const i=r(t,["cachedContents"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),s(e,["cachedContents"],a)}return e}function Kr(t){const e={},n=r(t,["mediaResolution"]);n!=null&&s(e,["mediaResolution"],n);const o=r(t,["codeExecutionResult"]);o!=null&&s(e,["codeExecutionResult"],o);const i=r(t,["executableCode"]);i!=null&&s(e,["executableCode"],i);const a=r(t,["fileData"]);a!=null&&s(e,["fileData"],Ur(a));const l=r(t,["functionCall"]);l!=null&&s(e,["functionCall"],Lr(l));const u=r(t,["functionResponse"]);u!=null&&s(e,["functionResponse"],u);const d=r(t,["inlineData"]);d!=null&&s(e,["inlineData"],Ar(d));const c=r(t,["text"]);c!=null&&s(e,["text"],c);const p=r(t,["thought"]);p!=null&&s(e,["thought"],p);const f=r(t,["thoughtSignature"]);f!=null&&s(e,["thoughtSignature"],f);const h=r(t,["videoMetadata"]);return h!=null&&s(e,["videoMetadata"],h),e}function zr(t){const e={},n=r(t,["functionCallingConfig"]);n!=null&&s(e,["functionCallingConfig"],Fr(n));const o=r(t,["retrievalConfig"]);return o!=null&&s(e,["retrievalConfig"],o),e}function Xr(t){const e={},n=r(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(f=>f)),s(e,["functionDeclarations"],p)}if(r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=r(t,["googleSearchRetrieval"]);o!=null&&s(e,["googleSearchRetrieval"],o);const i=r(t,["computerUse"]);i!=null&&s(e,["computerUse"],i);const a=r(t,["fileSearch"]);a!=null&&s(e,["fileSearch"],a);const l=r(t,["codeExecution"]);if(l!=null&&s(e,["codeExecution"],l),r(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=r(t,["googleMaps"]);u!=null&&s(e,["googleMaps"],qr(u));const d=r(t,["googleSearch"]);d!=null&&s(e,["googleSearch"],Hr(d));const c=r(t,["urlContext"]);return c!=null&&s(e,["urlContext"],c),e}function Qr(t){const e={},n=r(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(h=>br(h))),s(e,["functionDeclarations"],f)}const o=r(t,["retrieval"]);o!=null&&s(e,["retrieval"],o);const i=r(t,["googleSearchRetrieval"]);i!=null&&s(e,["googleSearchRetrieval"],i);const a=r(t,["computerUse"]);if(a!=null&&s(e,["computerUse"],a),r(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=r(t,["codeExecution"]);l!=null&&s(e,["codeExecution"],l);const u=r(t,["enterpriseWebSearch"]);u!=null&&s(e,["enterpriseWebSearch"],u);const d=r(t,["googleMaps"]);d!=null&&s(e,["googleMaps"],d);const c=r(t,["googleSearch"]);c!=null&&s(e,["googleSearch"],c);const p=r(t,["urlContext"]);return p!=null&&s(e,["urlContext"],p),e}function Zr(t,e){const n={},o=r(t,["ttl"]);e!==void 0&&o!=null&&s(e,["ttl"],o);const i=r(t,["expireTime"]);return e!==void 0&&i!=null&&s(e,["expireTime"],i),n}function jr(t,e){const n={},o=r(t,["ttl"]);e!==void 0&&o!=null&&s(e,["ttl"],o);const i=r(t,["expireTime"]);return e!==void 0&&i!=null&&s(e,["expireTime"],i),n}function es(t,e){const n={},o=r(e,["name"]);o!=null&&s(n,["_url","name"],z(t,o));const i=r(e,["config"]);return i!=null&&Zr(i,n),n}function ts(t,e){const n={},o=r(e,["name"]);o!=null&&s(n,["_url","name"],z(t,o));const i=r(e,["config"]);return i!=null&&jr(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ns extends K{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new te(W.PAGED_ITEM_CACHED_CONTENTS,o=>this.listInternal(o),await this.listInternal(n),n)}async create(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Mr(this.apiClient,e);return u=E("cachedContents",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>p)}else{const c=Pr(this.apiClient,e);return u=E("cachedContents",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>p)}}async get(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Vr(this.apiClient,e);return u=E("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>p)}else{const c=Gr(this.apiClient,e);return u=E("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>p)}}async delete(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=xr(this.apiClient,e);return u=E("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=kr(p),h=new Tn;return Object.assign(h,f),h})}else{const c=Nr(this.apiClient,e);return u=E("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=Dr(p),h=new Tn;return Object.assign(h,f),h})}}async update(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=ts(this.apiClient,e);return u=E("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>p)}else{const c=es(this.apiClient,e);return u=E("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>p)}}async listInternal(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Yr(e);return u=E("cachedContents",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=Wr(p),h=new En;return Object.assign(h,f),h})}else{const c=$r(e);return u=E("cachedContents",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=Or(p),h=new En;return Object.assign(h,f),h})}}}function Ae(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(t);i<o.length;i++)e.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(t,o[i])&&(n[o[i]]=t[o[i]]);return n}function Rn(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function A(t){return this instanceof A?(this.v=t,this):new A(t)}function B(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=n.apply(t,e||[]),i,a=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",l),i[Symbol.asyncIterator]=function(){return this},i;function l(m){return function(g){return Promise.resolve(g).then(m,f)}}function u(m,g){o[m]&&(i[m]=function(v){return new Promise(function(y,T){a.push([m,v,y,T])>1||d(m,v)})},g&&(i[m]=g(i[m])))}function d(m,g){try{c(o[m](g))}catch(v){h(a[0][3],v)}}function c(m){m.value instanceof A?Promise.resolve(m.value.v).then(p,f):h(a[0][2],m)}function p(m){d("next",m)}function f(m){d("throw",m)}function h(m,g){m(g),a.shift(),a.length&&d(a[0][0],a[0][1])}}function J(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Rn=="function"?Rn(t):t[Symbol.iterator](),n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n);function o(a){n[a]=t[a]&&function(l){return new Promise(function(u,d){l=t[a](l),i(u,d,l.done,l.value)})}}function i(a,l,u,d){Promise.resolve(d).then(function(c){a({value:c,done:u})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function os(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:ao(n)}function ao(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function is(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function Pn(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let o=0;for(;o<n;)if(t[o].role==="user")e.push(t[o]),o++;else{const i=[];let a=!0;for(;o<n&&t[o].role==="model";)i.push(t[o]),a&&!ao(t[o])&&(a=!1),o++;a?e.push(...i):e.pop()}return e}class rs{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new ss(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class ss{constructor(e,n,o,i={},a=[]){this.apiClient=e,this.modelsModule=n,this.model=o,this.config=i,this.history=a,this.sendPromise=Promise.resolve(),is(a)}async sendMessage(e){var n;await this.sendPromise;const o=b(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(o),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var a,l,u;const d=await i,c=(l=(a=d.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content,p=d.automaticFunctionCallingHistory,f=this.getHistory(!0).length;let h=[];p!=null&&(h=(u=p.slice(f))!==null&&u!==void 0?u:[]);const m=c?[c]:[];this.recordHistory(o,m,h)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var n;await this.sendPromise;const o=b(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(o),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const a=await i;return this.processStreamResponse(a,o)}getHistory(e=!1){const n=e?Pn(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){return B(this,arguments,function*(){var i,a,l,u,d,c;const p=[];try{for(var f=!0,h=J(e),m;m=yield A(h.next()),i=m.done,!i;f=!0){u=m.value,f=!1;const g=u;if(os(g)){const v=(c=(d=g.candidates)===null||d===void 0?void 0:d[0])===null||c===void 0?void 0:c.content;v!==void 0&&p.push(v)}yield yield A(g)}}catch(g){a={error:g}}finally{try{!f&&!i&&(l=h.return)&&(yield A(l.call(h)))}finally{if(a)throw a.error}}this.recordHistory(n,p)})}recordHistory(e,n,o){let i=[];n.length>0&&n.every(a=>a.role!==void 0)?i=n:i.push({role:"model",parts:[]}),o&&o.length>0?this.history.push(...Pn(o)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Pe extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Pe.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function as(t){const e={},n=r(t,["file"]);return n!=null&&s(e,["file"],n),e}function ls(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&s(e,["sdkHttpResponse"],n),e}function us(t){const e={},n=r(t,["name"]);return n!=null&&s(e,["_url","file"],eo(n)),e}function cs(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&s(e,["sdkHttpResponse"],n),e}function ds(t){const e={},n=r(t,["name"]);return n!=null&&s(e,["_url","file"],eo(n)),e}function ps(t,e){const n={},o=r(t,["pageSize"]);e!==void 0&&o!=null&&s(e,["_query","pageSize"],o);const i=r(t,["pageToken"]);return e!==void 0&&i!=null&&s(e,["_query","pageToken"],i),n}function fs(t){const e={},n=r(t,["config"]);return n!=null&&ps(n,e),e}function hs(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["nextPageToken"]);o!=null&&s(e,["nextPageToken"],o);const i=r(t,["files"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),s(e,["files"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ms extends K{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new te(W.PAGED_ITEM_FILES,o=>this.listInternal(o),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,o;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=fs(e);return a=E("files",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(c=>{const p=c;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const c=hs(d),p=new Ti;return Object.assign(p,c),p})}}async createInternal(e){var n,o;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=as(e);return a=E("upload/v1beta/files",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>{const c=ls(d),p=new Ei;return Object.assign(p,c),p})}}async get(e){var n,o;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=ds(e);return a=E("files/{file}",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async delete(e){var n,o;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=us(e);return a=E("files/{file}",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(c=>{const p=c;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const c=cs(d),p=new Si;return Object.assign(p,c),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Se(t){const e={},n=r(t,["data"]);if(n!=null&&s(e,["data"],n),r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=r(t,["mimeType"]);return o!=null&&s(e,["mimeType"],o),e}function gs(t){const e={},n=r(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(a=>Ds(a))),s(e,["parts"],i)}const o=r(t,["role"]);return o!=null&&s(e,["role"],o),e}function ys(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["fileUri"]);n!=null&&s(e,["fileUri"],n);const o=r(t,["mimeType"]);return o!=null&&s(e,["mimeType"],o),e}function vs(t){const e={},n=r(t,["id"]);n!=null&&s(e,["id"],n);const o=r(t,["args"]);o!=null&&s(e,["args"],o);const i=r(t,["name"]);if(i!=null&&s(e,["name"],i),r(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(r(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Ts(t){const e={};if(r(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=r(t,["description"]);n!=null&&s(e,["description"],n);const o=r(t,["name"]);o!=null&&s(e,["name"],o);const i=r(t,["parameters"]);i!=null&&s(e,["parameters"],i);const a=r(t,["parametersJsonSchema"]);a!=null&&s(e,["parametersJsonSchema"],a);const l=r(t,["response"]);l!=null&&s(e,["response"],l);const u=r(t,["responseJsonSchema"]);return u!=null&&s(e,["responseJsonSchema"],u),e}function Es(t){const e={},n=r(t,["modelSelectionConfig"]);n!=null&&s(e,["modelConfig"],n);const o=r(t,["responseJsonSchema"]);o!=null&&s(e,["responseJsonSchema"],o);const i=r(t,["audioTimestamp"]);i!=null&&s(e,["audioTimestamp"],i);const a=r(t,["candidateCount"]);a!=null&&s(e,["candidateCount"],a);const l=r(t,["enableAffectiveDialog"]);l!=null&&s(e,["enableAffectiveDialog"],l);const u=r(t,["frequencyPenalty"]);u!=null&&s(e,["frequencyPenalty"],u);const d=r(t,["logprobs"]);d!=null&&s(e,["logprobs"],d);const c=r(t,["maxOutputTokens"]);c!=null&&s(e,["maxOutputTokens"],c);const p=r(t,["mediaResolution"]);p!=null&&s(e,["mediaResolution"],p);const f=r(t,["presencePenalty"]);f!=null&&s(e,["presencePenalty"],f);const h=r(t,["responseLogprobs"]);h!=null&&s(e,["responseLogprobs"],h);const m=r(t,["responseMimeType"]);m!=null&&s(e,["responseMimeType"],m);const g=r(t,["responseModalities"]);g!=null&&s(e,["responseModalities"],g);const v=r(t,["responseSchema"]);v!=null&&s(e,["responseSchema"],v);const y=r(t,["routingConfig"]);y!=null&&s(e,["routingConfig"],y);const T=r(t,["seed"]);T!=null&&s(e,["seed"],T);const I=r(t,["speechConfig"]);I!=null&&s(e,["speechConfig"],lo(I));const S=r(t,["stopSequences"]);S!=null&&s(e,["stopSequences"],S);const C=r(t,["temperature"]);C!=null&&s(e,["temperature"],C);const w=r(t,["thinkingConfig"]);w!=null&&s(e,["thinkingConfig"],w);const P=r(t,["topK"]);P!=null&&s(e,["topK"],P);const R=r(t,["topP"]);if(R!=null&&s(e,["topP"],R),r(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function Ss(t){const e={};if(r(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=r(t,["enableWidget"]);return n!=null&&s(e,["enableWidget"],n),e}function Is(t){const e={};if(r(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(r(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=r(t,["timeRangeFilter"]);return n!=null&&s(e,["timeRangeFilter"],n),e}function Cs(t,e){const n={},o=r(t,["generationConfig"]);e!==void 0&&o!=null&&s(e,["setup","generationConfig"],o);const i=r(t,["responseModalities"]);e!==void 0&&i!=null&&s(e,["setup","generationConfig","responseModalities"],i);const a=r(t,["temperature"]);e!==void 0&&a!=null&&s(e,["setup","generationConfig","temperature"],a);const l=r(t,["topP"]);e!==void 0&&l!=null&&s(e,["setup","generationConfig","topP"],l);const u=r(t,["topK"]);e!==void 0&&u!=null&&s(e,["setup","generationConfig","topK"],u);const d=r(t,["maxOutputTokens"]);e!==void 0&&d!=null&&s(e,["setup","generationConfig","maxOutputTokens"],d);const c=r(t,["mediaResolution"]);e!==void 0&&c!=null&&s(e,["setup","generationConfig","mediaResolution"],c);const p=r(t,["seed"]);e!==void 0&&p!=null&&s(e,["setup","generationConfig","seed"],p);const f=r(t,["speechConfig"]);e!==void 0&&f!=null&&s(e,["setup","generationConfig","speechConfig"],st(f));const h=r(t,["thinkingConfig"]);e!==void 0&&h!=null&&s(e,["setup","generationConfig","thinkingConfig"],h);const m=r(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&s(e,["setup","generationConfig","enableAffectiveDialog"],m);const g=r(t,["systemInstruction"]);e!==void 0&&g!=null&&s(e,["setup","systemInstruction"],gs(b(g)));const v=r(t,["tools"]);if(e!==void 0&&v!=null){let P=ue(v);Array.isArray(P)&&(P=P.map(R=>Us(le(R)))),s(e,["setup","tools"],P)}const y=r(t,["sessionResumption"]);e!==void 0&&y!=null&&s(e,["setup","sessionResumption"],ks(y));const T=r(t,["inputAudioTranscription"]);e!==void 0&&T!=null&&s(e,["setup","inputAudioTranscription"],T);const I=r(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&s(e,["setup","outputAudioTranscription"],I);const S=r(t,["realtimeInputConfig"]);e!==void 0&&S!=null&&s(e,["setup","realtimeInputConfig"],S);const C=r(t,["contextWindowCompression"]);e!==void 0&&C!=null&&s(e,["setup","contextWindowCompression"],C);const w=r(t,["proactivity"]);if(e!==void 0&&w!=null&&s(e,["setup","proactivity"],w),r(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function _s(t,e){const n={},o=r(t,["generationConfig"]);e!==void 0&&o!=null&&s(e,["setup","generationConfig"],Es(o));const i=r(t,["responseModalities"]);e!==void 0&&i!=null&&s(e,["setup","generationConfig","responseModalities"],i);const a=r(t,["temperature"]);e!==void 0&&a!=null&&s(e,["setup","generationConfig","temperature"],a);const l=r(t,["topP"]);e!==void 0&&l!=null&&s(e,["setup","generationConfig","topP"],l);const u=r(t,["topK"]);e!==void 0&&u!=null&&s(e,["setup","generationConfig","topK"],u);const d=r(t,["maxOutputTokens"]);e!==void 0&&d!=null&&s(e,["setup","generationConfig","maxOutputTokens"],d);const c=r(t,["mediaResolution"]);e!==void 0&&c!=null&&s(e,["setup","generationConfig","mediaResolution"],c);const p=r(t,["seed"]);e!==void 0&&p!=null&&s(e,["setup","generationConfig","seed"],p);const f=r(t,["speechConfig"]);e!==void 0&&f!=null&&s(e,["setup","generationConfig","speechConfig"],lo(st(f)));const h=r(t,["thinkingConfig"]);e!==void 0&&h!=null&&s(e,["setup","generationConfig","thinkingConfig"],h);const m=r(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&s(e,["setup","generationConfig","enableAffectiveDialog"],m);const g=r(t,["systemInstruction"]);e!==void 0&&g!=null&&s(e,["setup","systemInstruction"],b(g));const v=r(t,["tools"]);if(e!==void 0&&v!=null){let R=ue(v);Array.isArray(R)&&(R=R.map(U=>Ls(le(U)))),s(e,["setup","tools"],R)}const y=r(t,["sessionResumption"]);e!==void 0&&y!=null&&s(e,["setup","sessionResumption"],y);const T=r(t,["inputAudioTranscription"]);e!==void 0&&T!=null&&s(e,["setup","inputAudioTranscription"],T);const I=r(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&s(e,["setup","outputAudioTranscription"],I);const S=r(t,["realtimeInputConfig"]);e!==void 0&&S!=null&&s(e,["setup","realtimeInputConfig"],S);const C=r(t,["contextWindowCompression"]);e!==void 0&&C!=null&&s(e,["setup","contextWindowCompression"],C);const w=r(t,["proactivity"]);e!==void 0&&w!=null&&s(e,["setup","proactivity"],w);const P=r(t,["explicitVadSignal"]);return e!==void 0&&P!=null&&s(e,["setup","explicitVadSignal"],P),n}function As(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["setup","model"],N(t,o));const i=r(e,["config"]);return i!=null&&s(n,["config"],Cs(i,n)),n}function ws(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["setup","model"],N(t,o));const i=r(e,["config"]);return i!=null&&s(n,["config"],_s(i,n)),n}function Rs(t){const e={},n=r(t,["musicGenerationConfig"]);return n!=null&&s(e,["musicGenerationConfig"],n),e}function Ps(t){const e={},n=r(t,["weightedPrompts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>i)),s(e,["weightedPrompts"],o)}return e}function Ms(t){const e={},n=r(t,["media"]);if(n!=null){let c=zn(n);Array.isArray(c)&&(c=c.map(p=>Se(p))),s(e,["mediaChunks"],c)}const o=r(t,["audio"]);o!=null&&s(e,["audio"],Se(Qn(o)));const i=r(t,["audioStreamEnd"]);i!=null&&s(e,["audioStreamEnd"],i);const a=r(t,["video"]);a!=null&&s(e,["video"],Se(Xn(a)));const l=r(t,["text"]);l!=null&&s(e,["text"],l);const u=r(t,["activityStart"]);u!=null&&s(e,["activityStart"],u);const d=r(t,["activityEnd"]);return d!=null&&s(e,["activityEnd"],d),e}function Ns(t){const e={},n=r(t,["media"]);if(n!=null){let c=zn(n);Array.isArray(c)&&(c=c.map(p=>p)),s(e,["mediaChunks"],c)}const o=r(t,["audio"]);o!=null&&s(e,["audio"],Qn(o));const i=r(t,["audioStreamEnd"]);i!=null&&s(e,["audioStreamEnd"],i);const a=r(t,["video"]);a!=null&&s(e,["video"],Xn(a));const l=r(t,["text"]);l!=null&&s(e,["text"],l);const u=r(t,["activityStart"]);u!=null&&s(e,["activityStart"],u);const d=r(t,["activityEnd"]);return d!=null&&s(e,["activityEnd"],d),e}function xs(t){const e={},n=r(t,["setupComplete"]);n!=null&&s(e,["setupComplete"],n);const o=r(t,["serverContent"]);o!=null&&s(e,["serverContent"],o);const i=r(t,["toolCall"]);i!=null&&s(e,["toolCall"],i);const a=r(t,["toolCallCancellation"]);a!=null&&s(e,["toolCallCancellation"],a);const l=r(t,["usageMetadata"]);l!=null&&s(e,["usageMetadata"],Fs(l));const u=r(t,["goAway"]);u!=null&&s(e,["goAway"],u);const d=r(t,["sessionResumptionUpdate"]);d!=null&&s(e,["sessionResumptionUpdate"],d);const c=r(t,["voiceActivityDetectionSignal"]);return c!=null&&s(e,["voiceActivityDetectionSignal"],c),e}function Ds(t){const e={},n=r(t,["mediaResolution"]);n!=null&&s(e,["mediaResolution"],n);const o=r(t,["codeExecutionResult"]);o!=null&&s(e,["codeExecutionResult"],o);const i=r(t,["executableCode"]);i!=null&&s(e,["executableCode"],i);const a=r(t,["fileData"]);a!=null&&s(e,["fileData"],ys(a));const l=r(t,["functionCall"]);l!=null&&s(e,["functionCall"],vs(l));const u=r(t,["functionResponse"]);u!=null&&s(e,["functionResponse"],u);const d=r(t,["inlineData"]);d!=null&&s(e,["inlineData"],Se(d));const c=r(t,["text"]);c!=null&&s(e,["text"],c);const p=r(t,["thought"]);p!=null&&s(e,["thought"],p);const f=r(t,["thoughtSignature"]);f!=null&&s(e,["thoughtSignature"],f);const h=r(t,["videoMetadata"]);return h!=null&&s(e,["videoMetadata"],h),e}function ks(t){const e={},n=r(t,["handle"]);if(n!=null&&s(e,["handle"],n),r(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function lo(t){const e={},n=r(t,["voiceConfig"]);n!=null&&s(e,["voiceConfig"],n);const o=r(t,["languageCode"]);if(o!=null&&s(e,["languageCode"],o),r(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function Us(t){const e={},n=r(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(f=>f)),s(e,["functionDeclarations"],p)}if(r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=r(t,["googleSearchRetrieval"]);o!=null&&s(e,["googleSearchRetrieval"],o);const i=r(t,["computerUse"]);i!=null&&s(e,["computerUse"],i);const a=r(t,["fileSearch"]);a!=null&&s(e,["fileSearch"],a);const l=r(t,["codeExecution"]);if(l!=null&&s(e,["codeExecution"],l),r(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=r(t,["googleMaps"]);u!=null&&s(e,["googleMaps"],Ss(u));const d=r(t,["googleSearch"]);d!=null&&s(e,["googleSearch"],Is(d));const c=r(t,["urlContext"]);return c!=null&&s(e,["urlContext"],c),e}function Ls(t){const e={},n=r(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(h=>Ts(h))),s(e,["functionDeclarations"],f)}const o=r(t,["retrieval"]);o!=null&&s(e,["retrieval"],o);const i=r(t,["googleSearchRetrieval"]);i!=null&&s(e,["googleSearchRetrieval"],i);const a=r(t,["computerUse"]);if(a!=null&&s(e,["computerUse"],a),r(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=r(t,["codeExecution"]);l!=null&&s(e,["codeExecution"],l);const u=r(t,["enterpriseWebSearch"]);u!=null&&s(e,["enterpriseWebSearch"],u);const d=r(t,["googleMaps"]);d!=null&&s(e,["googleMaps"],d);const c=r(t,["googleSearch"]);c!=null&&s(e,["googleSearch"],c);const p=r(t,["urlContext"]);return p!=null&&s(e,["urlContext"],p),e}function Fs(t){const e={},n=r(t,["promptTokenCount"]);n!=null&&s(e,["promptTokenCount"],n);const o=r(t,["cachedContentTokenCount"]);o!=null&&s(e,["cachedContentTokenCount"],o);const i=r(t,["candidatesTokenCount"]);i!=null&&s(e,["responseTokenCount"],i);const a=r(t,["toolUsePromptTokenCount"]);a!=null&&s(e,["toolUsePromptTokenCount"],a);const l=r(t,["thoughtsTokenCount"]);l!=null&&s(e,["thoughtsTokenCount"],l);const u=r(t,["totalTokenCount"]);u!=null&&s(e,["totalTokenCount"],u);const d=r(t,["promptTokensDetails"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(g=>g)),s(e,["promptTokensDetails"],m)}const c=r(t,["cacheTokensDetails"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(g=>g)),s(e,["cacheTokensDetails"],m)}const p=r(t,["candidatesTokensDetails"]);if(p!=null){let m=p;Array.isArray(m)&&(m=m.map(g=>g)),s(e,["responseTokensDetails"],m)}const f=r(t,["toolUsePromptTokensDetails"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(g=>g)),s(e,["toolUsePromptTokensDetails"],m)}const h=r(t,["trafficType"]);return h!=null&&s(e,["trafficType"],h),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bs(t){const e={},n=r(t,["data"]);if(n!=null&&s(e,["data"],n),r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=r(t,["mimeType"]);return o!=null&&s(e,["mimeType"],o),e}function Gs(t){const e={},n=r(t,["content"]);n!=null&&s(e,["content"],n);const o=r(t,["citationMetadata"]);o!=null&&s(e,["citationMetadata"],Vs(o));const i=r(t,["tokenCount"]);i!=null&&s(e,["tokenCount"],i);const a=r(t,["finishReason"]);a!=null&&s(e,["finishReason"],a);const l=r(t,["avgLogprobs"]);l!=null&&s(e,["avgLogprobs"],l);const u=r(t,["groundingMetadata"]);u!=null&&s(e,["groundingMetadata"],u);const d=r(t,["index"]);d!=null&&s(e,["index"],d);const c=r(t,["logprobsResult"]);c!=null&&s(e,["logprobsResult"],c);const p=r(t,["safetyRatings"]);if(p!=null){let h=p;Array.isArray(h)&&(h=h.map(m=>m)),s(e,["safetyRatings"],h)}const f=r(t,["urlContextMetadata"]);return f!=null&&s(e,["urlContextMetadata"],f),e}function Vs(t){const e={},n=r(t,["citationSources"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>i)),s(e,["citations"],o)}return e}function qs(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["_url","model"],N(t,o));const i=r(e,["contents"]);if(i!=null){let a=q(i);Array.isArray(a)&&(a=a.map(l=>l)),s(n,["contents"],a)}return n}function Hs(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["tokensInfo"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(a=>a)),s(e,["tokensInfo"],i)}return e}function Bs(t){const e={},n=r(t,["values"]);n!=null&&s(e,["values"],n);const o=r(t,["statistics"]);return o!=null&&s(e,["statistics"],Js(o)),e}function Js(t){const e={},n=r(t,["truncated"]);n!=null&&s(e,["truncated"],n);const o=r(t,["token_count"]);return o!=null&&s(e,["tokenCount"],o),e}function Me(t){const e={},n=r(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(a=>Za(a))),s(e,["parts"],i)}const o=r(t,["role"]);return o!=null&&s(e,["role"],o),e}function $s(t){const e={},n=r(t,["controlType"]);n!=null&&s(e,["controlType"],n);const o=r(t,["enableControlImageComputation"]);return o!=null&&s(e,["computeControl"],o),e}function Ys(t){const e={};if(r(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(r(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(r(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function Os(t,e){const n={},o=r(t,["systemInstruction"]);e!==void 0&&o!=null&&s(e,["systemInstruction"],b(o));const i=r(t,["tools"]);if(e!==void 0&&i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>ho(u))),s(e,["tools"],l)}const a=r(t,["generationConfig"]);return e!==void 0&&a!=null&&s(e,["generationConfig"],ba(a)),n}function Ws(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["_url","model"],N(t,o));const i=r(e,["contents"]);if(i!=null){let l=q(i);Array.isArray(l)&&(l=l.map(u=>Me(u))),s(n,["contents"],l)}const a=r(e,["config"]);return a!=null&&Ys(a),n}function Ks(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["_url","model"],N(t,o));const i=r(e,["contents"]);if(i!=null){let l=q(i);Array.isArray(l)&&(l=l.map(u=>u)),s(n,["contents"],l)}const a=r(e,["config"]);return a!=null&&Os(a,n),n}function zs(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["totalTokens"]);o!=null&&s(e,["totalTokens"],o);const i=r(t,["cachedContentTokenCount"]);return i!=null&&s(e,["cachedContentTokenCount"],i),e}function Xs(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["totalTokens"]);return o!=null&&s(e,["totalTokens"],o),e}function Qs(t,e){const n={},o=r(e,["model"]);return o!=null&&s(n,["_url","name"],N(t,o)),n}function Zs(t,e){const n={},o=r(e,["model"]);return o!=null&&s(n,["_url","name"],N(t,o)),n}function js(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&s(e,["sdkHttpResponse"],n),e}function ea(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&s(e,["sdkHttpResponse"],n),e}function ta(t,e){const n={},o=r(t,["outputGcsUri"]);e!==void 0&&o!=null&&s(e,["parameters","storageUri"],o);const i=r(t,["negativePrompt"]);e!==void 0&&i!=null&&s(e,["parameters","negativePrompt"],i);const a=r(t,["numberOfImages"]);e!==void 0&&a!=null&&s(e,["parameters","sampleCount"],a);const l=r(t,["aspectRatio"]);e!==void 0&&l!=null&&s(e,["parameters","aspectRatio"],l);const u=r(t,["guidanceScale"]);e!==void 0&&u!=null&&s(e,["parameters","guidanceScale"],u);const d=r(t,["seed"]);e!==void 0&&d!=null&&s(e,["parameters","seed"],d);const c=r(t,["safetyFilterLevel"]);e!==void 0&&c!=null&&s(e,["parameters","safetySetting"],c);const p=r(t,["personGeneration"]);e!==void 0&&p!=null&&s(e,["parameters","personGeneration"],p);const f=r(t,["includeSafetyAttributes"]);e!==void 0&&f!=null&&s(e,["parameters","includeSafetyAttributes"],f);const h=r(t,["includeRaiReason"]);e!==void 0&&h!=null&&s(e,["parameters","includeRaiReason"],h);const m=r(t,["language"]);e!==void 0&&m!=null&&s(e,["parameters","language"],m);const g=r(t,["outputMimeType"]);e!==void 0&&g!=null&&s(e,["parameters","outputOptions","mimeType"],g);const v=r(t,["outputCompressionQuality"]);e!==void 0&&v!=null&&s(e,["parameters","outputOptions","compressionQuality"],v);const y=r(t,["addWatermark"]);e!==void 0&&y!=null&&s(e,["parameters","addWatermark"],y);const T=r(t,["labels"]);e!==void 0&&T!=null&&s(e,["labels"],T);const I=r(t,["editMode"]);e!==void 0&&I!=null&&s(e,["parameters","editMode"],I);const S=r(t,["baseSteps"]);return e!==void 0&&S!=null&&s(e,["parameters","editConfig","baseSteps"],S),n}function na(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["_url","model"],N(t,o));const i=r(e,["prompt"]);i!=null&&s(n,["instances[0]","prompt"],i);const a=r(e,["referenceImages"]);if(a!=null){let u=a;Array.isArray(u)&&(u=u.map(d=>il(d))),s(n,["instances[0]","referenceImages"],u)}const l=r(e,["config"]);return l!=null&&ta(l,n),n}function oa(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["predictions"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(a=>Ne(a))),s(e,["generatedImages"],i)}return e}function ia(t,e){const n={},o=r(t,["taskType"]);e!==void 0&&o!=null&&s(e,["requests[]","taskType"],o);const i=r(t,["title"]);e!==void 0&&i!=null&&s(e,["requests[]","title"],i);const a=r(t,["outputDimensionality"]);if(e!==void 0&&a!=null&&s(e,["requests[]","outputDimensionality"],a),r(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(r(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function ra(t,e){const n={},o=r(t,["taskType"]);e!==void 0&&o!=null&&s(e,["instances[]","task_type"],o);const i=r(t,["title"]);e!==void 0&&i!=null&&s(e,["instances[]","title"],i);const a=r(t,["outputDimensionality"]);e!==void 0&&a!=null&&s(e,["parameters","outputDimensionality"],a);const l=r(t,["mimeType"]);e!==void 0&&l!=null&&s(e,["instances[]","mimeType"],l);const u=r(t,["autoTruncate"]);return e!==void 0&&u!=null&&s(e,["parameters","autoTruncate"],u),n}function sa(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["_url","model"],N(t,o));const i=r(e,["contents"]);if(i!=null){let u=ot(t,i);Array.isArray(u)&&(u=u.map(d=>d)),s(n,["requests[]","content"],u)}const a=r(e,["config"]);a!=null&&ia(a,n);const l=r(e,["model"]);return l!==void 0&&s(n,["requests[]","model"],N(t,l)),n}function aa(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["_url","model"],N(t,o));const i=r(e,["contents"]);if(i!=null){let l=ot(t,i);Array.isArray(l)&&(l=l.map(u=>u)),s(n,["instances[]","content"],l)}const a=r(e,["config"]);return a!=null&&ra(a,n),n}function la(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["embeddings"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>l)),s(e,["embeddings"],a)}const i=r(t,["metadata"]);return i!=null&&s(e,["metadata"],i),e}function ua(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["predictions[]","embeddings"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>Bs(l))),s(e,["embeddings"],a)}const i=r(t,["metadata"]);return i!=null&&s(e,["metadata"],i),e}function ca(t){const e={},n=r(t,["endpoint"]);n!=null&&s(e,["name"],n);const o=r(t,["deployedModelId"]);return o!=null&&s(e,["deployedModelId"],o),e}function da(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["fileUri"]);n!=null&&s(e,["fileUri"],n);const o=r(t,["mimeType"]);return o!=null&&s(e,["mimeType"],o),e}function pa(t){const e={},n=r(t,["id"]);n!=null&&s(e,["id"],n);const o=r(t,["args"]);o!=null&&s(e,["args"],o);const i=r(t,["name"]);if(i!=null&&s(e,["name"],i),r(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(r(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function fa(t){const e={},n=r(t,["mode"]);n!=null&&s(e,["mode"],n);const o=r(t,["allowedFunctionNames"]);if(o!=null&&s(e,["allowedFunctionNames"],o),r(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function ha(t){const e={};if(r(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=r(t,["description"]);n!=null&&s(e,["description"],n);const o=r(t,["name"]);o!=null&&s(e,["name"],o);const i=r(t,["parameters"]);i!=null&&s(e,["parameters"],i);const a=r(t,["parametersJsonSchema"]);a!=null&&s(e,["parametersJsonSchema"],a);const l=r(t,["response"]);l!=null&&s(e,["response"],l);const u=r(t,["responseJsonSchema"]);return u!=null&&s(e,["responseJsonSchema"],u),e}function ma(t,e,n){const o={},i=r(e,["systemInstruction"]);n!==void 0&&i!=null&&s(n,["systemInstruction"],Me(b(i)));const a=r(e,["temperature"]);a!=null&&s(o,["temperature"],a);const l=r(e,["topP"]);l!=null&&s(o,["topP"],l);const u=r(e,["topK"]);u!=null&&s(o,["topK"],u);const d=r(e,["candidateCount"]);d!=null&&s(o,["candidateCount"],d);const c=r(e,["maxOutputTokens"]);c!=null&&s(o,["maxOutputTokens"],c);const p=r(e,["stopSequences"]);p!=null&&s(o,["stopSequences"],p);const f=r(e,["responseLogprobs"]);f!=null&&s(o,["responseLogprobs"],f);const h=r(e,["logprobs"]);h!=null&&s(o,["logprobs"],h);const m=r(e,["presencePenalty"]);m!=null&&s(o,["presencePenalty"],m);const g=r(e,["frequencyPenalty"]);g!=null&&s(o,["frequencyPenalty"],g);const v=r(e,["seed"]);v!=null&&s(o,["seed"],v);const y=r(e,["responseMimeType"]);y!=null&&s(o,["responseMimeType"],y);const T=r(e,["responseSchema"]);T!=null&&s(o,["responseSchema"],it(T));const I=r(e,["responseJsonSchema"]);if(I!=null&&s(o,["responseJsonSchema"],I),r(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(r(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const S=r(e,["safetySettings"]);if(n!==void 0&&S!=null){let D=S;Array.isArray(D)&&(D=D.map(Y=>rl(Y))),s(n,["safetySettings"],D)}const C=r(e,["tools"]);if(n!==void 0&&C!=null){let D=ue(C);Array.isArray(D)&&(D=D.map(Y=>pl(le(Y)))),s(n,["tools"],D)}const w=r(e,["toolConfig"]);if(n!==void 0&&w!=null&&s(n,["toolConfig"],dl(w)),r(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const P=r(e,["cachedContent"]);n!==void 0&&P!=null&&s(n,["cachedContent"],z(t,P));const R=r(e,["responseModalities"]);R!=null&&s(o,["responseModalities"],R);const U=r(e,["mediaResolution"]);U!=null&&s(o,["mediaResolution"],U);const _=r(e,["speechConfig"]);if(_!=null&&s(o,["speechConfig"],rt(_)),r(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const x=r(e,["thinkingConfig"]);x!=null&&s(o,["thinkingConfig"],x);const L=r(e,["imageConfig"]);L!=null&&s(o,["imageConfig"],Ba(L));const X=r(e,["enableEnhancedCivicAnswers"]);return X!=null&&s(o,["enableEnhancedCivicAnswers"],X),o}function ga(t,e,n){const o={},i=r(e,["systemInstruction"]);n!==void 0&&i!=null&&s(n,["systemInstruction"],b(i));const a=r(e,["temperature"]);a!=null&&s(o,["temperature"],a);const l=r(e,["topP"]);l!=null&&s(o,["topP"],l);const u=r(e,["topK"]);u!=null&&s(o,["topK"],u);const d=r(e,["candidateCount"]);d!=null&&s(o,["candidateCount"],d);const c=r(e,["maxOutputTokens"]);c!=null&&s(o,["maxOutputTokens"],c);const p=r(e,["stopSequences"]);p!=null&&s(o,["stopSequences"],p);const f=r(e,["responseLogprobs"]);f!=null&&s(o,["responseLogprobs"],f);const h=r(e,["logprobs"]);h!=null&&s(o,["logprobs"],h);const m=r(e,["presencePenalty"]);m!=null&&s(o,["presencePenalty"],m);const g=r(e,["frequencyPenalty"]);g!=null&&s(o,["frequencyPenalty"],g);const v=r(e,["seed"]);v!=null&&s(o,["seed"],v);const y=r(e,["responseMimeType"]);y!=null&&s(o,["responseMimeType"],y);const T=r(e,["responseSchema"]);T!=null&&s(o,["responseSchema"],it(T));const I=r(e,["responseJsonSchema"]);I!=null&&s(o,["responseJsonSchema"],I);const S=r(e,["routingConfig"]);S!=null&&s(o,["routingConfig"],S);const C=r(e,["modelSelectionConfig"]);C!=null&&s(o,["modelConfig"],C);const w=r(e,["safetySettings"]);if(n!==void 0&&w!=null){let O=w;Array.isArray(O)&&(O=O.map(Le=>Le)),s(n,["safetySettings"],O)}const P=r(e,["tools"]);if(n!==void 0&&P!=null){let O=ue(P);Array.isArray(O)&&(O=O.map(Le=>ho(le(Le)))),s(n,["tools"],O)}const R=r(e,["toolConfig"]);n!==void 0&&R!=null&&s(n,["toolConfig"],R);const U=r(e,["labels"]);n!==void 0&&U!=null&&s(n,["labels"],U);const _=r(e,["cachedContent"]);n!==void 0&&_!=null&&s(n,["cachedContent"],z(t,_));const x=r(e,["responseModalities"]);x!=null&&s(o,["responseModalities"],x);const L=r(e,["mediaResolution"]);L!=null&&s(o,["mediaResolution"],L);const X=r(e,["speechConfig"]);X!=null&&s(o,["speechConfig"],fo(rt(X)));const D=r(e,["audioTimestamp"]);D!=null&&s(o,["audioTimestamp"],D);const Y=r(e,["thinkingConfig"]);Y!=null&&s(o,["thinkingConfig"],Y);const pt=r(e,["imageConfig"]);if(pt!=null&&s(o,["imageConfig"],Ja(pt)),r(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return o}function Mn(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["_url","model"],N(t,o));const i=r(e,["contents"]);if(i!=null){let l=q(i);Array.isArray(l)&&(l=l.map(u=>Me(u))),s(n,["contents"],l)}const a=r(e,["config"]);return a!=null&&s(n,["generationConfig"],ma(t,a,n)),n}function Nn(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["_url","model"],N(t,o));const i=r(e,["contents"]);if(i!=null){let l=q(i);Array.isArray(l)&&(l=l.map(u=>u)),s(n,["contents"],l)}const a=r(e,["config"]);return a!=null&&s(n,["generationConfig"],ga(t,a,n)),n}function xn(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["candidates"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(c=>Gs(c))),s(e,["candidates"],d)}const i=r(t,["modelVersion"]);i!=null&&s(e,["modelVersion"],i);const a=r(t,["promptFeedback"]);a!=null&&s(e,["promptFeedback"],a);const l=r(t,["responseId"]);l!=null&&s(e,["responseId"],l);const u=r(t,["usageMetadata"]);return u!=null&&s(e,["usageMetadata"],u),e}function Dn(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["candidates"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(p=>p)),s(e,["candidates"],c)}const i=r(t,["createTime"]);i!=null&&s(e,["createTime"],i);const a=r(t,["modelVersion"]);a!=null&&s(e,["modelVersion"],a);const l=r(t,["promptFeedback"]);l!=null&&s(e,["promptFeedback"],l);const u=r(t,["responseId"]);u!=null&&s(e,["responseId"],u);const d=r(t,["usageMetadata"]);return d!=null&&s(e,["usageMetadata"],d),e}function ya(t,e){const n={};if(r(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(r(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const o=r(t,["numberOfImages"]);e!==void 0&&o!=null&&s(e,["parameters","sampleCount"],o);const i=r(t,["aspectRatio"]);e!==void 0&&i!=null&&s(e,["parameters","aspectRatio"],i);const a=r(t,["guidanceScale"]);if(e!==void 0&&a!=null&&s(e,["parameters","guidanceScale"],a),r(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=r(t,["safetyFilterLevel"]);e!==void 0&&l!=null&&s(e,["parameters","safetySetting"],l);const u=r(t,["personGeneration"]);e!==void 0&&u!=null&&s(e,["parameters","personGeneration"],u);const d=r(t,["includeSafetyAttributes"]);e!==void 0&&d!=null&&s(e,["parameters","includeSafetyAttributes"],d);const c=r(t,["includeRaiReason"]);e!==void 0&&c!=null&&s(e,["parameters","includeRaiReason"],c);const p=r(t,["language"]);e!==void 0&&p!=null&&s(e,["parameters","language"],p);const f=r(t,["outputMimeType"]);e!==void 0&&f!=null&&s(e,["parameters","outputOptions","mimeType"],f);const h=r(t,["outputCompressionQuality"]);if(e!==void 0&&h!=null&&s(e,["parameters","outputOptions","compressionQuality"],h),r(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(r(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const m=r(t,["imageSize"]);if(e!==void 0&&m!=null&&s(e,["parameters","sampleImageSize"],m),r(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function va(t,e){const n={},o=r(t,["outputGcsUri"]);e!==void 0&&o!=null&&s(e,["parameters","storageUri"],o);const i=r(t,["negativePrompt"]);e!==void 0&&i!=null&&s(e,["parameters","negativePrompt"],i);const a=r(t,["numberOfImages"]);e!==void 0&&a!=null&&s(e,["parameters","sampleCount"],a);const l=r(t,["aspectRatio"]);e!==void 0&&l!=null&&s(e,["parameters","aspectRatio"],l);const u=r(t,["guidanceScale"]);e!==void 0&&u!=null&&s(e,["parameters","guidanceScale"],u);const d=r(t,["seed"]);e!==void 0&&d!=null&&s(e,["parameters","seed"],d);const c=r(t,["safetyFilterLevel"]);e!==void 0&&c!=null&&s(e,["parameters","safetySetting"],c);const p=r(t,["personGeneration"]);e!==void 0&&p!=null&&s(e,["parameters","personGeneration"],p);const f=r(t,["includeSafetyAttributes"]);e!==void 0&&f!=null&&s(e,["parameters","includeSafetyAttributes"],f);const h=r(t,["includeRaiReason"]);e!==void 0&&h!=null&&s(e,["parameters","includeRaiReason"],h);const m=r(t,["language"]);e!==void 0&&m!=null&&s(e,["parameters","language"],m);const g=r(t,["outputMimeType"]);e!==void 0&&g!=null&&s(e,["parameters","outputOptions","mimeType"],g);const v=r(t,["outputCompressionQuality"]);e!==void 0&&v!=null&&s(e,["parameters","outputOptions","compressionQuality"],v);const y=r(t,["addWatermark"]);e!==void 0&&y!=null&&s(e,["parameters","addWatermark"],y);const T=r(t,["labels"]);e!==void 0&&T!=null&&s(e,["labels"],T);const I=r(t,["imageSize"]);e!==void 0&&I!=null&&s(e,["parameters","sampleImageSize"],I);const S=r(t,["enhancePrompt"]);return e!==void 0&&S!=null&&s(e,["parameters","enhancePrompt"],S),n}function Ta(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["_url","model"],N(t,o));const i=r(e,["prompt"]);i!=null&&s(n,["instances[0]","prompt"],i);const a=r(e,["config"]);return a!=null&&ya(a,n),n}function Ea(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["_url","model"],N(t,o));const i=r(e,["prompt"]);i!=null&&s(n,["instances[0]","prompt"],i);const a=r(e,["config"]);return a!=null&&va(a,n),n}function Sa(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["predictions"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>ka(l))),s(e,["generatedImages"],a)}const i=r(t,["positivePromptSafetyAttributes"]);return i!=null&&s(e,["positivePromptSafetyAttributes"],co(i)),e}function Ia(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["predictions"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>Ne(l))),s(e,["generatedImages"],a)}const i=r(t,["positivePromptSafetyAttributes"]);return i!=null&&s(e,["positivePromptSafetyAttributes"],po(i)),e}function Ca(t,e){const n={},o=r(t,["numberOfVideos"]);if(e!==void 0&&o!=null&&s(e,["parameters","sampleCount"],o),r(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(r(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=r(t,["durationSeconds"]);if(e!==void 0&&i!=null&&s(e,["parameters","durationSeconds"],i),r(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=r(t,["aspectRatio"]);e!==void 0&&a!=null&&s(e,["parameters","aspectRatio"],a);const l=r(t,["resolution"]);e!==void 0&&l!=null&&s(e,["parameters","resolution"],l);const u=r(t,["personGeneration"]);if(e!==void 0&&u!=null&&s(e,["parameters","personGeneration"],u),r(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const d=r(t,["negativePrompt"]);e!==void 0&&d!=null&&s(e,["parameters","negativePrompt"],d);const c=r(t,["enhancePrompt"]);if(e!==void 0&&c!=null&&s(e,["parameters","enhancePrompt"],c),r(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const p=r(t,["lastFrame"]);e!==void 0&&p!=null&&s(e,["instances[0]","lastFrame"],xe(p));const f=r(t,["referenceImages"]);if(e!==void 0&&f!=null){let h=f;Array.isArray(h)&&(h=h.map(m=>Al(m))),s(e,["instances[0]","referenceImages"],h)}if(r(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(r(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function _a(t,e){const n={},o=r(t,["numberOfVideos"]);e!==void 0&&o!=null&&s(e,["parameters","sampleCount"],o);const i=r(t,["outputGcsUri"]);e!==void 0&&i!=null&&s(e,["parameters","storageUri"],i);const a=r(t,["fps"]);e!==void 0&&a!=null&&s(e,["parameters","fps"],a);const l=r(t,["durationSeconds"]);e!==void 0&&l!=null&&s(e,["parameters","durationSeconds"],l);const u=r(t,["seed"]);e!==void 0&&u!=null&&s(e,["parameters","seed"],u);const d=r(t,["aspectRatio"]);e!==void 0&&d!=null&&s(e,["parameters","aspectRatio"],d);const c=r(t,["resolution"]);e!==void 0&&c!=null&&s(e,["parameters","resolution"],c);const p=r(t,["personGeneration"]);e!==void 0&&p!=null&&s(e,["parameters","personGeneration"],p);const f=r(t,["pubsubTopic"]);e!==void 0&&f!=null&&s(e,["parameters","pubsubTopic"],f);const h=r(t,["negativePrompt"]);e!==void 0&&h!=null&&s(e,["parameters","negativePrompt"],h);const m=r(t,["enhancePrompt"]);e!==void 0&&m!=null&&s(e,["parameters","enhancePrompt"],m);const g=r(t,["generateAudio"]);e!==void 0&&g!=null&&s(e,["parameters","generateAudio"],g);const v=r(t,["lastFrame"]);e!==void 0&&v!=null&&s(e,["instances[0]","lastFrame"],$(v));const y=r(t,["referenceImages"]);if(e!==void 0&&y!=null){let S=y;Array.isArray(S)&&(S=S.map(C=>wl(C))),s(e,["instances[0]","referenceImages"],S)}const T=r(t,["mask"]);e!==void 0&&T!=null&&s(e,["instances[0]","mask"],_l(T));const I=r(t,["compressionQuality"]);return e!==void 0&&I!=null&&s(e,["parameters","compressionQuality"],I),n}function Aa(t){const e={},n=r(t,["name"]);n!=null&&s(e,["name"],n);const o=r(t,["metadata"]);o!=null&&s(e,["metadata"],o);const i=r(t,["done"]);i!=null&&s(e,["done"],i);const a=r(t,["error"]);a!=null&&s(e,["error"],a);const l=r(t,["response","generateVideoResponse"]);return l!=null&&s(e,["response"],Ma(l)),e}function wa(t){const e={},n=r(t,["name"]);n!=null&&s(e,["name"],n);const o=r(t,["metadata"]);o!=null&&s(e,["metadata"],o);const i=r(t,["done"]);i!=null&&s(e,["done"],i);const a=r(t,["error"]);a!=null&&s(e,["error"],a);const l=r(t,["response"]);return l!=null&&s(e,["response"],Na(l)),e}function Ra(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["_url","model"],N(t,o));const i=r(e,["prompt"]);i!=null&&s(n,["instances[0]","prompt"],i);const a=r(e,["image"]);a!=null&&s(n,["instances[0]","image"],xe(a));const l=r(e,["video"]);l!=null&&s(n,["instances[0]","video"],mo(l));const u=r(e,["source"]);u!=null&&xa(u,n);const d=r(e,["config"]);return d!=null&&Ca(d,n),n}function Pa(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["_url","model"],N(t,o));const i=r(e,["prompt"]);i!=null&&s(n,["instances[0]","prompt"],i);const a=r(e,["image"]);a!=null&&s(n,["instances[0]","image"],$(a));const l=r(e,["video"]);l!=null&&s(n,["instances[0]","video"],go(l));const u=r(e,["source"]);u!=null&&Da(u,n);const d=r(e,["config"]);return d!=null&&_a(d,n),n}function Ma(t){const e={},n=r(t,["generatedSamples"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>La(l))),s(e,["generatedVideos"],a)}const o=r(t,["raiMediaFilteredCount"]);o!=null&&s(e,["raiMediaFilteredCount"],o);const i=r(t,["raiMediaFilteredReasons"]);return i!=null&&s(e,["raiMediaFilteredReasons"],i),e}function Na(t){const e={},n=r(t,["videos"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>Fa(l))),s(e,["generatedVideos"],a)}const o=r(t,["raiMediaFilteredCount"]);o!=null&&s(e,["raiMediaFilteredCount"],o);const i=r(t,["raiMediaFilteredReasons"]);return i!=null&&s(e,["raiMediaFilteredReasons"],i),e}function xa(t,e){const n={},o=r(t,["prompt"]);e!==void 0&&o!=null&&s(e,["instances[0]","prompt"],o);const i=r(t,["image"]);e!==void 0&&i!=null&&s(e,["instances[0]","image"],xe(i));const a=r(t,["video"]);return e!==void 0&&a!=null&&s(e,["instances[0]","video"],mo(a)),n}function Da(t,e){const n={},o=r(t,["prompt"]);e!==void 0&&o!=null&&s(e,["instances[0]","prompt"],o);const i=r(t,["image"]);e!==void 0&&i!=null&&s(e,["instances[0]","image"],$(i));const a=r(t,["video"]);return e!==void 0&&a!=null&&s(e,["instances[0]","video"],go(a)),n}function ka(t){const e={},n=r(t,["_self"]);n!=null&&s(e,["image"],$a(n));const o=r(t,["raiFilteredReason"]);o!=null&&s(e,["raiFilteredReason"],o);const i=r(t,["_self"]);return i!=null&&s(e,["safetyAttributes"],co(i)),e}function Ne(t){const e={},n=r(t,["_self"]);n!=null&&s(e,["image"],uo(n));const o=r(t,["raiFilteredReason"]);o!=null&&s(e,["raiFilteredReason"],o);const i=r(t,["_self"]);i!=null&&s(e,["safetyAttributes"],po(i));const a=r(t,["prompt"]);return a!=null&&s(e,["enhancedPrompt"],a),e}function Ua(t){const e={},n=r(t,["_self"]);n!=null&&s(e,["mask"],uo(n));const o=r(t,["labels"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(a=>a)),s(e,["labels"],i)}return e}function La(t){const e={},n=r(t,["video"]);return n!=null&&s(e,["video"],Il(n)),e}function Fa(t){const e={},n=r(t,["_self"]);return n!=null&&s(e,["video"],Cl(n)),e}function ba(t){const e={},n=r(t,["modelSelectionConfig"]);n!=null&&s(e,["modelConfig"],n);const o=r(t,["responseJsonSchema"]);o!=null&&s(e,["responseJsonSchema"],o);const i=r(t,["audioTimestamp"]);i!=null&&s(e,["audioTimestamp"],i);const a=r(t,["candidateCount"]);a!=null&&s(e,["candidateCount"],a);const l=r(t,["enableAffectiveDialog"]);l!=null&&s(e,["enableAffectiveDialog"],l);const u=r(t,["frequencyPenalty"]);u!=null&&s(e,["frequencyPenalty"],u);const d=r(t,["logprobs"]);d!=null&&s(e,["logprobs"],d);const c=r(t,["maxOutputTokens"]);c!=null&&s(e,["maxOutputTokens"],c);const p=r(t,["mediaResolution"]);p!=null&&s(e,["mediaResolution"],p);const f=r(t,["presencePenalty"]);f!=null&&s(e,["presencePenalty"],f);const h=r(t,["responseLogprobs"]);h!=null&&s(e,["responseLogprobs"],h);const m=r(t,["responseMimeType"]);m!=null&&s(e,["responseMimeType"],m);const g=r(t,["responseModalities"]);g!=null&&s(e,["responseModalities"],g);const v=r(t,["responseSchema"]);v!=null&&s(e,["responseSchema"],v);const y=r(t,["routingConfig"]);y!=null&&s(e,["routingConfig"],y);const T=r(t,["seed"]);T!=null&&s(e,["seed"],T);const I=r(t,["speechConfig"]);I!=null&&s(e,["speechConfig"],fo(I));const S=r(t,["stopSequences"]);S!=null&&s(e,["stopSequences"],S);const C=r(t,["temperature"]);C!=null&&s(e,["temperature"],C);const w=r(t,["thinkingConfig"]);w!=null&&s(e,["thinkingConfig"],w);const P=r(t,["topK"]);P!=null&&s(e,["topK"],P);const R=r(t,["topP"]);if(R!=null&&s(e,["topP"],R),r(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function Ga(t,e){const n={},o=r(e,["model"]);return o!=null&&s(n,["_url","name"],N(t,o)),n}function Va(t,e){const n={},o=r(e,["model"]);return o!=null&&s(n,["_url","name"],N(t,o)),n}function qa(t){const e={};if(r(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=r(t,["enableWidget"]);return n!=null&&s(e,["enableWidget"],n),e}function Ha(t){const e={};if(r(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(r(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=r(t,["timeRangeFilter"]);return n!=null&&s(e,["timeRangeFilter"],n),e}function Ba(t){const e={},n=r(t,["aspectRatio"]);n!=null&&s(e,["aspectRatio"],n);const o=r(t,["imageSize"]);if(o!=null&&s(e,["imageSize"],o),r(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(r(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function Ja(t){const e={},n=r(t,["aspectRatio"]);n!=null&&s(e,["aspectRatio"],n);const o=r(t,["imageSize"]);o!=null&&s(e,["imageSize"],o);const i=r(t,["outputMimeType"]);i!=null&&s(e,["imageOutputOptions","mimeType"],i);const a=r(t,["outputCompressionQuality"]);return a!=null&&s(e,["imageOutputOptions","compressionQuality"],a),e}function $a(t){const e={},n=r(t,["bytesBase64Encoded"]);n!=null&&s(e,["imageBytes"],Q(n));const o=r(t,["mimeType"]);return o!=null&&s(e,["mimeType"],o),e}function uo(t){const e={},n=r(t,["gcsUri"]);n!=null&&s(e,["gcsUri"],n);const o=r(t,["bytesBase64Encoded"]);o!=null&&s(e,["imageBytes"],Q(o));const i=r(t,["mimeType"]);return i!=null&&s(e,["mimeType"],i),e}function xe(t){const e={};if(r(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=r(t,["imageBytes"]);n!=null&&s(e,["bytesBase64Encoded"],Q(n));const o=r(t,["mimeType"]);return o!=null&&s(e,["mimeType"],o),e}function $(t){const e={},n=r(t,["gcsUri"]);n!=null&&s(e,["gcsUri"],n);const o=r(t,["imageBytes"]);o!=null&&s(e,["bytesBase64Encoded"],Q(o));const i=r(t,["mimeType"]);return i!=null&&s(e,["mimeType"],i),e}function Ya(t,e,n){const o={},i=r(e,["pageSize"]);n!==void 0&&i!=null&&s(n,["_query","pageSize"],i);const a=r(e,["pageToken"]);n!==void 0&&a!=null&&s(n,["_query","pageToken"],a);const l=r(e,["filter"]);n!==void 0&&l!=null&&s(n,["_query","filter"],l);const u=r(e,["queryBase"]);return n!==void 0&&u!=null&&s(n,["_url","models_url"],to(t,u)),o}function Oa(t,e,n){const o={},i=r(e,["pageSize"]);n!==void 0&&i!=null&&s(n,["_query","pageSize"],i);const a=r(e,["pageToken"]);n!==void 0&&a!=null&&s(n,["_query","pageToken"],a);const l=r(e,["filter"]);n!==void 0&&l!=null&&s(n,["_query","filter"],l);const u=r(e,["queryBase"]);return n!==void 0&&u!=null&&s(n,["_url","models_url"],to(t,u)),o}function Wa(t,e){const n={},o=r(e,["config"]);return o!=null&&Ya(t,o,n),n}function Ka(t,e){const n={},o=r(e,["config"]);return o!=null&&Oa(t,o,n),n}function za(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["nextPageToken"]);o!=null&&s(e,["nextPageToken"],o);const i=r(t,["_self"]);if(i!=null){let a=no(i);Array.isArray(a)&&(a=a.map(l=>$e(l))),s(e,["models"],a)}return e}function Xa(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["nextPageToken"]);o!=null&&s(e,["nextPageToken"],o);const i=r(t,["_self"]);if(i!=null){let a=no(i);Array.isArray(a)&&(a=a.map(l=>Ye(l))),s(e,["models"],a)}return e}function Qa(t){const e={},n=r(t,["maskMode"]);n!=null&&s(e,["maskMode"],n);const o=r(t,["segmentationClasses"]);o!=null&&s(e,["maskClasses"],o);const i=r(t,["maskDilation"]);return i!=null&&s(e,["dilation"],i),e}function $e(t){const e={},n=r(t,["name"]);n!=null&&s(e,["name"],n);const o=r(t,["displayName"]);o!=null&&s(e,["displayName"],o);const i=r(t,["description"]);i!=null&&s(e,["description"],i);const a=r(t,["version"]);a!=null&&s(e,["version"],a);const l=r(t,["_self"]);l!=null&&s(e,["tunedModelInfo"],fl(l));const u=r(t,["inputTokenLimit"]);u!=null&&s(e,["inputTokenLimit"],u);const d=r(t,["outputTokenLimit"]);d!=null&&s(e,["outputTokenLimit"],d);const c=r(t,["supportedGenerationMethods"]);c!=null&&s(e,["supportedActions"],c);const p=r(t,["temperature"]);p!=null&&s(e,["temperature"],p);const f=r(t,["maxTemperature"]);f!=null&&s(e,["maxTemperature"],f);const h=r(t,["topP"]);h!=null&&s(e,["topP"],h);const m=r(t,["topK"]);m!=null&&s(e,["topK"],m);const g=r(t,["thinking"]);return g!=null&&s(e,["thinking"],g),e}function Ye(t){const e={},n=r(t,["name"]);n!=null&&s(e,["name"],n);const o=r(t,["displayName"]);o!=null&&s(e,["displayName"],o);const i=r(t,["description"]);i!=null&&s(e,["description"],i);const a=r(t,["versionId"]);a!=null&&s(e,["version"],a);const l=r(t,["deployedModels"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(h=>ca(h))),s(e,["endpoints"],f)}const u=r(t,["labels"]);u!=null&&s(e,["labels"],u);const d=r(t,["_self"]);d!=null&&s(e,["tunedModelInfo"],hl(d));const c=r(t,["defaultCheckpointId"]);c!=null&&s(e,["defaultCheckpointId"],c);const p=r(t,["checkpoints"]);if(p!=null){let f=p;Array.isArray(f)&&(f=f.map(h=>h)),s(e,["checkpoints"],f)}return e}function Za(t){const e={},n=r(t,["mediaResolution"]);n!=null&&s(e,["mediaResolution"],n);const o=r(t,["codeExecutionResult"]);o!=null&&s(e,["codeExecutionResult"],o);const i=r(t,["executableCode"]);i!=null&&s(e,["executableCode"],i);const a=r(t,["fileData"]);a!=null&&s(e,["fileData"],da(a));const l=r(t,["functionCall"]);l!=null&&s(e,["functionCall"],pa(l));const u=r(t,["functionResponse"]);u!=null&&s(e,["functionResponse"],u);const d=r(t,["inlineData"]);d!=null&&s(e,["inlineData"],bs(d));const c=r(t,["text"]);c!=null&&s(e,["text"],c);const p=r(t,["thought"]);p!=null&&s(e,["thought"],p);const f=r(t,["thoughtSignature"]);f!=null&&s(e,["thoughtSignature"],f);const h=r(t,["videoMetadata"]);return h!=null&&s(e,["videoMetadata"],h),e}function ja(t){const e={},n=r(t,["productImage"]);return n!=null&&s(e,["image"],$(n)),e}function el(t,e){const n={},o=r(t,["numberOfImages"]);e!==void 0&&o!=null&&s(e,["parameters","sampleCount"],o);const i=r(t,["baseSteps"]);e!==void 0&&i!=null&&s(e,["parameters","baseSteps"],i);const a=r(t,["outputGcsUri"]);e!==void 0&&a!=null&&s(e,["parameters","storageUri"],a);const l=r(t,["seed"]);e!==void 0&&l!=null&&s(e,["parameters","seed"],l);const u=r(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&s(e,["parameters","safetySetting"],u);const d=r(t,["personGeneration"]);e!==void 0&&d!=null&&s(e,["parameters","personGeneration"],d);const c=r(t,["addWatermark"]);e!==void 0&&c!=null&&s(e,["parameters","addWatermark"],c);const p=r(t,["outputMimeType"]);e!==void 0&&p!=null&&s(e,["parameters","outputOptions","mimeType"],p);const f=r(t,["outputCompressionQuality"]);e!==void 0&&f!=null&&s(e,["parameters","outputOptions","compressionQuality"],f);const h=r(t,["enhancePrompt"]);e!==void 0&&h!=null&&s(e,["parameters","enhancePrompt"],h);const m=r(t,["labels"]);return e!==void 0&&m!=null&&s(e,["labels"],m),n}function tl(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["_url","model"],N(t,o));const i=r(e,["source"]);i!=null&&ol(i,n);const a=r(e,["config"]);return a!=null&&el(a,n),n}function nl(t){const e={},n=r(t,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>Ne(i))),s(e,["generatedImages"],o)}return e}function ol(t,e){const n={},o=r(t,["prompt"]);e!==void 0&&o!=null&&s(e,["instances[0]","prompt"],o);const i=r(t,["personImage"]);e!==void 0&&i!=null&&s(e,["instances[0]","personImage","image"],$(i));const a=r(t,["productImages"]);if(e!==void 0&&a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>ja(u))),s(e,["instances[0]","productImages"],l)}return n}function il(t){const e={},n=r(t,["referenceImage"]);n!=null&&s(e,["referenceImage"],$(n));const o=r(t,["referenceId"]);o!=null&&s(e,["referenceId"],o);const i=r(t,["referenceType"]);i!=null&&s(e,["referenceType"],i);const a=r(t,["maskImageConfig"]);a!=null&&s(e,["maskImageConfig"],Qa(a));const l=r(t,["controlImageConfig"]);l!=null&&s(e,["controlImageConfig"],$s(l));const u=r(t,["styleImageConfig"]);u!=null&&s(e,["styleImageConfig"],u);const d=r(t,["subjectImageConfig"]);return d!=null&&s(e,["subjectImageConfig"],d),e}function co(t){const e={},n=r(t,["safetyAttributes","categories"]);n!=null&&s(e,["categories"],n);const o=r(t,["safetyAttributes","scores"]);o!=null&&s(e,["scores"],o);const i=r(t,["contentType"]);return i!=null&&s(e,["contentType"],i),e}function po(t){const e={},n=r(t,["safetyAttributes","categories"]);n!=null&&s(e,["categories"],n);const o=r(t,["safetyAttributes","scores"]);o!=null&&s(e,["scores"],o);const i=r(t,["contentType"]);return i!=null&&s(e,["contentType"],i),e}function rl(t){const e={},n=r(t,["category"]);if(n!=null&&s(e,["category"],n),r(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const o=r(t,["threshold"]);return o!=null&&s(e,["threshold"],o),e}function sl(t){const e={},n=r(t,["image"]);return n!=null&&s(e,["image"],$(n)),e}function al(t,e){const n={},o=r(t,["mode"]);e!==void 0&&o!=null&&s(e,["parameters","mode"],o);const i=r(t,["maxPredictions"]);e!==void 0&&i!=null&&s(e,["parameters","maxPredictions"],i);const a=r(t,["confidenceThreshold"]);e!==void 0&&a!=null&&s(e,["parameters","confidenceThreshold"],a);const l=r(t,["maskDilation"]);e!==void 0&&l!=null&&s(e,["parameters","maskDilation"],l);const u=r(t,["binaryColorThreshold"]);e!==void 0&&u!=null&&s(e,["parameters","binaryColorThreshold"],u);const d=r(t,["labels"]);return e!==void 0&&d!=null&&s(e,["labels"],d),n}function ll(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["_url","model"],N(t,o));const i=r(e,["source"]);i!=null&&cl(i,n);const a=r(e,["config"]);return a!=null&&al(a,n),n}function ul(t){const e={},n=r(t,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>Ua(i))),s(e,["generatedMasks"],o)}return e}function cl(t,e){const n={},o=r(t,["prompt"]);e!==void 0&&o!=null&&s(e,["instances[0]","prompt"],o);const i=r(t,["image"]);e!==void 0&&i!=null&&s(e,["instances[0]","image"],$(i));const a=r(t,["scribbleImage"]);return e!==void 0&&a!=null&&s(e,["instances[0]","scribble"],sl(a)),n}function fo(t){const e={},n=r(t,["voiceConfig"]);n!=null&&s(e,["voiceConfig"],n);const o=r(t,["languageCode"]);if(o!=null&&s(e,["languageCode"],o),r(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function dl(t){const e={},n=r(t,["functionCallingConfig"]);n!=null&&s(e,["functionCallingConfig"],fa(n));const o=r(t,["retrievalConfig"]);return o!=null&&s(e,["retrievalConfig"],o),e}function pl(t){const e={},n=r(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(f=>f)),s(e,["functionDeclarations"],p)}if(r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=r(t,["googleSearchRetrieval"]);o!=null&&s(e,["googleSearchRetrieval"],o);const i=r(t,["computerUse"]);i!=null&&s(e,["computerUse"],i);const a=r(t,["fileSearch"]);a!=null&&s(e,["fileSearch"],a);const l=r(t,["codeExecution"]);if(l!=null&&s(e,["codeExecution"],l),r(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=r(t,["googleMaps"]);u!=null&&s(e,["googleMaps"],qa(u));const d=r(t,["googleSearch"]);d!=null&&s(e,["googleSearch"],Ha(d));const c=r(t,["urlContext"]);return c!=null&&s(e,["urlContext"],c),e}function ho(t){const e={},n=r(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(h=>ha(h))),s(e,["functionDeclarations"],f)}const o=r(t,["retrieval"]);o!=null&&s(e,["retrieval"],o);const i=r(t,["googleSearchRetrieval"]);i!=null&&s(e,["googleSearchRetrieval"],i);const a=r(t,["computerUse"]);if(a!=null&&s(e,["computerUse"],a),r(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=r(t,["codeExecution"]);l!=null&&s(e,["codeExecution"],l);const u=r(t,["enterpriseWebSearch"]);u!=null&&s(e,["enterpriseWebSearch"],u);const d=r(t,["googleMaps"]);d!=null&&s(e,["googleMaps"],d);const c=r(t,["googleSearch"]);c!=null&&s(e,["googleSearch"],c);const p=r(t,["urlContext"]);return p!=null&&s(e,["urlContext"],p),e}function fl(t){const e={},n=r(t,["baseModel"]);n!=null&&s(e,["baseModel"],n);const o=r(t,["createTime"]);o!=null&&s(e,["createTime"],o);const i=r(t,["updateTime"]);return i!=null&&s(e,["updateTime"],i),e}function hl(t){const e={},n=r(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&s(e,["baseModel"],n);const o=r(t,["createTime"]);o!=null&&s(e,["createTime"],o);const i=r(t,["updateTime"]);return i!=null&&s(e,["updateTime"],i),e}function ml(t,e){const n={},o=r(t,["displayName"]);e!==void 0&&o!=null&&s(e,["displayName"],o);const i=r(t,["description"]);e!==void 0&&i!=null&&s(e,["description"],i);const a=r(t,["defaultCheckpointId"]);return e!==void 0&&a!=null&&s(e,["defaultCheckpointId"],a),n}function gl(t,e){const n={},o=r(t,["displayName"]);e!==void 0&&o!=null&&s(e,["displayName"],o);const i=r(t,["description"]);e!==void 0&&i!=null&&s(e,["description"],i);const a=r(t,["defaultCheckpointId"]);return e!==void 0&&a!=null&&s(e,["defaultCheckpointId"],a),n}function yl(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["_url","name"],N(t,o));const i=r(e,["config"]);return i!=null&&ml(i,n),n}function vl(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["_url","model"],N(t,o));const i=r(e,["config"]);return i!=null&&gl(i,n),n}function Tl(t,e){const n={},o=r(t,["outputGcsUri"]);e!==void 0&&o!=null&&s(e,["parameters","storageUri"],o);const i=r(t,["safetyFilterLevel"]);e!==void 0&&i!=null&&s(e,["parameters","safetySetting"],i);const a=r(t,["personGeneration"]);e!==void 0&&a!=null&&s(e,["parameters","personGeneration"],a);const l=r(t,["includeRaiReason"]);e!==void 0&&l!=null&&s(e,["parameters","includeRaiReason"],l);const u=r(t,["outputMimeType"]);e!==void 0&&u!=null&&s(e,["parameters","outputOptions","mimeType"],u);const d=r(t,["outputCompressionQuality"]);e!==void 0&&d!=null&&s(e,["parameters","outputOptions","compressionQuality"],d);const c=r(t,["enhanceInputImage"]);e!==void 0&&c!=null&&s(e,["parameters","upscaleConfig","enhanceInputImage"],c);const p=r(t,["imagePreservationFactor"]);e!==void 0&&p!=null&&s(e,["parameters","upscaleConfig","imagePreservationFactor"],p);const f=r(t,["labels"]);e!==void 0&&f!=null&&s(e,["labels"],f);const h=r(t,["numberOfImages"]);e!==void 0&&h!=null&&s(e,["parameters","sampleCount"],h);const m=r(t,["mode"]);return e!==void 0&&m!=null&&s(e,["parameters","mode"],m),n}function El(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["_url","model"],N(t,o));const i=r(e,["image"]);i!=null&&s(n,["instances[0]","image"],$(i));const a=r(e,["upscaleFactor"]);a!=null&&s(n,["parameters","upscaleConfig","upscaleFactor"],a);const l=r(e,["config"]);return l!=null&&Tl(l,n),n}function Sl(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["predictions"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(a=>Ne(a))),s(e,["generatedImages"],i)}return e}function Il(t){const e={},n=r(t,["uri"]);n!=null&&s(e,["uri"],n);const o=r(t,["encodedVideo"]);o!=null&&s(e,["videoBytes"],Q(o));const i=r(t,["encoding"]);return i!=null&&s(e,["mimeType"],i),e}function Cl(t){const e={},n=r(t,["gcsUri"]);n!=null&&s(e,["uri"],n);const o=r(t,["bytesBase64Encoded"]);o!=null&&s(e,["videoBytes"],Q(o));const i=r(t,["mimeType"]);return i!=null&&s(e,["mimeType"],i),e}function _l(t){const e={},n=r(t,["image"]);n!=null&&s(e,["_self"],$(n));const o=r(t,["maskMode"]);return o!=null&&s(e,["maskMode"],o),e}function Al(t){const e={},n=r(t,["image"]);n!=null&&s(e,["image"],xe(n));const o=r(t,["referenceType"]);return o!=null&&s(e,["referenceType"],o),e}function wl(t){const e={},n=r(t,["image"]);n!=null&&s(e,["image"],$(n));const o=r(t,["referenceType"]);return o!=null&&s(e,["referenceType"],o),e}function mo(t){const e={},n=r(t,["uri"]);n!=null&&s(e,["uri"],n);const o=r(t,["videoBytes"]);o!=null&&s(e,["encodedVideo"],Q(o));const i=r(t,["mimeType"]);return i!=null&&s(e,["encoding"],i),e}function go(t){const e={},n=r(t,["uri"]);n!=null&&s(e,["gcsUri"],n);const o=r(t,["videoBytes"]);o!=null&&s(e,["bytesBase64Encoded"],Q(o));const i=r(t,["mimeType"]);return i!=null&&s(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Rl(t,e){const n={},o=r(t,["displayName"]);return e!==void 0&&o!=null&&s(e,["displayName"],o),n}function Pl(t){const e={},n=r(t,["config"]);return n!=null&&Rl(n,e),e}function Ml(t,e){const n={},o=r(t,["force"]);return e!==void 0&&o!=null&&s(e,["_query","force"],o),n}function Nl(t){const e={},n=r(t,["name"]);n!=null&&s(e,["_url","name"],n);const o=r(t,["config"]);return o!=null&&Ml(o,e),e}function xl(t){const e={},n=r(t,["name"]);return n!=null&&s(e,["_url","name"],n),e}function Dl(t,e){const n={},o=r(t,["customMetadata"]);if(e!==void 0&&o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>l)),s(e,["customMetadata"],a)}const i=r(t,["chunkingConfig"]);return e!==void 0&&i!=null&&s(e,["chunkingConfig"],i),n}function kl(t){const e={},n=r(t,["name"]);n!=null&&s(e,["name"],n);const o=r(t,["metadata"]);o!=null&&s(e,["metadata"],o);const i=r(t,["done"]);i!=null&&s(e,["done"],i);const a=r(t,["error"]);a!=null&&s(e,["error"],a);const l=r(t,["response"]);return l!=null&&s(e,["response"],Ll(l)),e}function Ul(t){const e={},n=r(t,["fileSearchStoreName"]);n!=null&&s(e,["_url","file_search_store_name"],n);const o=r(t,["fileName"]);o!=null&&s(e,["fileName"],o);const i=r(t,["config"]);return i!=null&&Dl(i,e),e}function Ll(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["parent"]);o!=null&&s(e,["parent"],o);const i=r(t,["documentName"]);return i!=null&&s(e,["documentName"],i),e}function Fl(t,e){const n={},o=r(t,["pageSize"]);e!==void 0&&o!=null&&s(e,["_query","pageSize"],o);const i=r(t,["pageToken"]);return e!==void 0&&i!=null&&s(e,["_query","pageToken"],i),n}function bl(t){const e={},n=r(t,["config"]);return n!=null&&Fl(n,e),e}function Gl(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["nextPageToken"]);o!=null&&s(e,["nextPageToken"],o);const i=r(t,["fileSearchStores"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),s(e,["fileSearchStores"],a)}return e}function yo(t,e){const n={},o=r(t,["mimeType"]);e!==void 0&&o!=null&&s(e,["mimeType"],o);const i=r(t,["displayName"]);e!==void 0&&i!=null&&s(e,["displayName"],i);const a=r(t,["customMetadata"]);if(e!==void 0&&a!=null){let u=a;Array.isArray(u)&&(u=u.map(d=>d)),s(e,["customMetadata"],u)}const l=r(t,["chunkingConfig"]);return e!==void 0&&l!=null&&s(e,["chunkingConfig"],l),n}function Vl(t){const e={},n=r(t,["fileSearchStoreName"]);n!=null&&s(e,["_url","file_search_store_name"],n);const o=r(t,["config"]);return o!=null&&yo(o,e),e}function ql(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&s(e,["sdkHttpResponse"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Hl="Content-Type",Bl="X-Server-Timeout",Jl="User-Agent",Oe="x-goog-api-client",$l="1.33.0",Yl=`google-genai-sdk/${$l}`,Ol="v1beta1",Wl="v1beta";class Kl{constructor(e){var n,o;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Ol,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(o=this.clientOptions.apiVersion)!==null&&o!==void 0?o:Wl,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const o=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&o.push(e.apiVersion),o.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,o){const i=[this.getRequestUrlInternal(n)];return o&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const o=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,o);if(e.queryParams)for(const[l,u]of Object.entries(e.queryParams))i.searchParams.append(l,String(u));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,n,i.toString(),e.abortSignal),this.unaryApiCall(i,a,e.httpMethod)}patchHttpOptions(e,n){const o=JSON.parse(JSON.stringify(e));for(const[i,a]of Object.entries(n))typeof a=="object"?o[i]=Object.assign(Object.assign({},o[i]),a):a!==void 0&&(o[i]=a);return o}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const o=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,o);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,n,i.toString(),e.abortSignal),this.streamApiCall(i,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,o,i){if(n&&n.timeout||i){const a=new AbortController,l=a.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const u=setTimeout(()=>a.abort(),n.timeout);u&&typeof u.unref=="function"&&u.unref()}i&&i.addEventListener("abort",()=>{a.abort()}),e.signal=l}return n&&n.extraBody!==null&&zl(e,n.extraBody),e.headers=await this.getHeadersInternal(n,o),e}async unaryApiCall(e,n,o){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:o})).then(async i=>(await kn(i),new He(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,n,o){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:o})).then(async i=>(await kn(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){return B(this,arguments,function*(){var o;const i=(o=e==null?void 0:e.body)===null||o===void 0?void 0:o.getReader(),a=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let l="";const u="data:",d=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:c,value:p}=yield A(i.read());if(c){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const f=a.decode(p,{stream:!0});try{const g=JSON.parse(f);if("error"in g){const v=JSON.parse(JSON.stringify(g.error)),y=v.status,T=v.code,I=`got status: ${y}. ${JSON.stringify(g)}`;if(T>=400&&T<600)throw new Pe({message:I,status:T})}}catch(g){if(g.name==="ApiError")throw g}l+=f;let h=-1,m=0;for(;;){h=-1,m=0;for(const y of d){const T=l.indexOf(y);T!==-1&&(h===-1||T<h)&&(h=T,m=y.length)}if(h===-1)break;const g=l.substring(0,h);l=l.substring(h+m);const v=g.trim();if(v.startsWith(u)){const y=v.substring(u.length).trim();try{const T=new Response(y,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield A(new He(T))}catch(T){throw new Error(`exception parsing stream chunk ${y}. ${T}`)}}}}}finally{i.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(o=>{throw new Error(`exception ${o} sending request`)})}getDefaultHeaders(){const e={},n=Yl+" "+this.clientOptions.userAgentExtra;return e[Jl]=n,e[Oe]=n,e[Hl]="application/json",e}async getHeadersInternal(e,n){const o=new Headers;if(e&&e.headers){for(const[i,a]of Object.entries(e.headers))o.append(i,a);e.timeout&&e.timeout>0&&o.append(Bl,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(o,n),o}getFileName(e){var n;let o="";return typeof e=="string"&&(o=e.replace(/[/\\]+$/,""),o=(n=o.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),o}async uploadFile(e,n){var o;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const a=this.clientOptions.uploader,l=await a.stat(e);i.sizeBytes=String(l.size);const u=(o=n==null?void 0:n.mimeType)!==null&&o!==void 0?o:l.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=u;const d={file:i},c=this.getFileName(e),p=E("upload/v1beta/files",d._url),f=await this.fetchUploadUrl(p,i.sizeBytes,i.mimeType,c,d,n==null?void 0:n.httpOptions);return a.upload(e,f,this)}async uploadFileToFileSearchStore(e,n,o){var i;const a=this.clientOptions.uploader,l=await a.stat(n),u=String(l.size),d=(i=o==null?void 0:o.mimeType)!==null&&i!==void 0?i:l.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const c=`upload/v1beta/${e}:uploadToFileSearchStore`,p=this.getFileName(n),f={};o!=null&&yo(o,f);const h=await this.fetchUploadUrl(c,u,d,p,f,o==null?void 0:o.httpOptions);return a.uploadToFileSearchStore(n,h,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,o,i,a,l){var u;let d={};l?d=l:d={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${o}`},i?{"X-Goog-Upload-File-Name":i}:{})};const c=await this.request({path:e,body:JSON.stringify(a),httpMethod:"POST",httpOptions:d});if(!c||!(c!=null&&c.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const p=(u=c==null?void 0:c.headers)===null||u===void 0?void 0:u["x-goog-upload-url"];if(p===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return p}}async function kn(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let o;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?o=await t.json():o={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(o);throw n>=400&&n<600?new Pe({message:i,status:n}):new Error(i)}}function zl(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const a=JSON.parse(t.body);if(typeof a=="object"&&a!==null&&!Array.isArray(a))n=a;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function o(a,l){const u=Object.assign({},a);for(const d in l)if(Object.prototype.hasOwnProperty.call(l,d)){const c=l[d],p=u[d];c&&typeof c=="object"&&!Array.isArray(c)&&p&&typeof p=="object"&&!Array.isArray(p)?u[d]=o(p,c):(p&&c&&typeof p!=typeof c&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${d}". Original type: ${typeof p}, New type: ${typeof c}. Overwriting.`),u[d]=c)}return u}const i=o(n,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Xl="mcp_used/unknown";let Ql=!1;function vo(t){for(const e of t)if(Zl(e)||typeof e=="object"&&"inputSchema"in e)return!0;return Ql}function To(t){var e;const n=(e=t[Oe])!==null&&e!==void 0?e:"";t[Oe]=(n+` ${Xl}`).trimStart()}function Zl(t){return t!==null&&typeof t=="object"&&t instanceof at}function jl(t){return B(this,arguments,function*(n,o=100){let i,a=0;for(;a<o;){const l=yield A(n.listTools({cursor:i}));for(const u of l.tools)yield yield A(u),a++;if(!l.nextCursor)break;i=l.nextCursor}})}class at{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new at(e,n)}async initialize(){var e,n,o,i;if(this.mcpTools.length>0)return;const a={},l=[];for(const p of this.mcpClients)try{for(var u=!0,d=(n=void 0,J(jl(p))),c;c=await d.next(),e=c.done,!e;u=!0){i=c.value,u=!1;const f=i;l.push(f);const h=f.name;if(a[h])throw new Error(`Duplicate function name ${h} found in MCP tools. Please ensure function names are unique.`);a[h]=p}}catch(f){n={error:f}}finally{try{!u&&!e&&(o=d.return)&&await o.call(d)}finally{if(n)throw n.error}}this.mcpTools=l,this.functionNameToMcpClient=a}async tool(){return await this.initialize(),xi(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const o of e)if(o.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[o.name];let a;this.config.timeout&&(a={timeout:this.config.timeout});const l=await i.callTool({name:o.name,arguments:o.args},void 0,a);n.push({functionResponse:{name:o.name,response:l.isError?{error:l}:l}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function eu(t,e,n){const o=new Ci;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(o,i),e(o)}class tu{constructor(e,n,o){this.apiClient=e,this.auth=n,this.webSocketFactory=o}async connect(e){var n,o;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),l=iu(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),d=`${i}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${u}`;let c=()=>{};const p=new Promise(S=>{c=S}),f=e.callbacks,h=function(){c({})},m=this.apiClient,g={onopen:h,onmessage:S=>{eu(m,f.onmessage,S)},onerror:(n=f==null?void 0:f.onerror)!==null&&n!==void 0?n:function(S){},onclose:(o=f==null?void 0:f.onclose)!==null&&o!==void 0?o:function(S){}},v=this.webSocketFactory.create(d,ou(l),g);v.connect(),await p;const I={setup:{model:N(this.apiClient,e.model)}};return v.send(JSON.stringify(I)),new nu(v,this.apiClient)}}class nu{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=Ps(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=Rs(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(oe.PLAY)}pause(){this.sendPlaybackControl(oe.PAUSE)}stop(){this.sendPlaybackControl(oe.STOP)}resetContext(){this.sendPlaybackControl(oe.RESET_CONTEXT)}close(){this.conn.close()}}function ou(t){const e={};return t.forEach((n,o)=>{e[o]=n}),e}function iu(t){const e=new Headers;for(const[n,o]of Object.entries(t))e.append(n,o);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ru="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function su(t,e,n){const o=new Ii;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const a=JSON.parse(i);if(t.isVertexAI()){const l=xs(a);Object.assign(o,l)}else Object.assign(o,a);e(o)}class au{constructor(e,n,o){this.apiClient=e,this.auth=n,this.webSocketFactory=o,this.music=new tu(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,o,i,a,l,u;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const d=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion();let p;const f=this.apiClient.getHeaders();e.config&&e.config.tools&&vo(e.config.tools)&&To(f);const h=du(f);if(this.apiClient.isVertexAI())p=`${d}/ws/google.cloud.aiplatform.${c}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(h,p);else{const _=this.apiClient.getApiKey();let x="BidiGenerateContent",L="key";_!=null&&_.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),c!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),x="BidiGenerateContentConstrained",L="access_token"),p=`${d}/ws/google.ai.generativelanguage.${c}.GenerativeService.${x}?${L}=${_}`}let m=()=>{};const g=new Promise(_=>{m=_}),v=e.callbacks,y=function(){var _;(_=v==null?void 0:v.onopen)===null||_===void 0||_.call(v),m({})},T=this.apiClient,I={onopen:y,onmessage:_=>{su(T,v.onmessage,_)},onerror:(n=v==null?void 0:v.onerror)!==null&&n!==void 0?n:function(_){},onclose:(o=v==null?void 0:v.onclose)!==null&&o!==void 0?o:function(_){}},S=this.webSocketFactory.create(p,cu(h),I);S.connect(),await g;let C=N(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&C.startsWith("publishers/")){const _=this.apiClient.getProject(),x=this.apiClient.getLocation();C=`projects/${_}/locations/${x}/`+C}let w={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[ee.AUDIO]}:e.config.responseModalities=[ee.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const P=(u=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[],R=[];for(const _ of P)if(this.isCallableTool(_)){const x=_;R.push(await x.tool())}else R.push(_);R.length>0&&(e.config.tools=R);const U={model:C,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?w=ws(this.apiClient,U):w=As(this.apiClient,U),delete w.config,S.send(JSON.stringify(w)),new uu(S,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const lu={turnComplete:!0};class uu{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let o=[];try{o=q(n.turns),e.isVertexAI()||(o=o.map(i=>Me(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:o,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let o=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?o=n.functionResponses:o=[n.functionResponses],o.length===0)throw new Error("functionResponses is required.");for(const a of o){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(ru)}return{toolResponse:{functionResponses:o}}}sendClientContent(e){e=Object.assign(Object.assign({},lu),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:Ns(e)}:n={realtimeInput:Ms(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function cu(t){const e={};return t.forEach((n,o)=>{e[o]=n}),e}function du(t){const e=new Headers;for(const[n,o]of Object.entries(t))e.append(n,o);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Un=10;function Ln(t){var e,n,o;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const l of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(se(l)){i=!0;break}if(!i)return!0;const a=(o=t==null?void 0:t.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function se(t){return"callTool"in t&&typeof t.callTool=="function"}function pu(t){var e,n,o;return(o=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>se(i)))!==null&&o!==void 0?o:!1}function Fn(t){var e;const n=[];return!((e=t==null?void 0:t.config)===null||e===void 0)&&e.tools&&t.config.tools.forEach((o,i)=>{if(se(o))return;const a=o;a.functionDeclarations&&a.functionDeclarations.length>0&&n.push(i)}),n}function bn(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class fu extends K{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var o,i,a,l,u;const d=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!pu(n)||Ln(n.config))return await this.generateContentInternal(d);const c=Fn(n);if(c.length>0){const v=c.map(y=>`tools[${y}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${v}.`)}let p,f;const h=q(d.contents),m=(a=(i=(o=d.config)===null||o===void 0?void 0:o.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&a!==void 0?a:Un;let g=0;for(;g<m&&(p=await this.generateContentInternal(d),!(!p.functionCalls||p.functionCalls.length===0));){const v=p.candidates[0].content,y=[];for(const T of(u=(l=n.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[])if(se(T)){const S=await T.callTool(p.functionCalls);y.push(...S)}g++,f={role:"user",parts:y},d.contents=q(d.contents),d.contents.push(v),d.contents.push(f),bn(d.config)&&(h.push(v),h.push(f))}return bn(d.config)&&(p.automaticFunctionCallingHistory=h),p},this.generateContentStream=async n=>{var o,i,a,l,u;if(this.maybeMoveToResponseJsonSchem(n),Ln(n.config)){const f=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(f)}const d=Fn(n);if(d.length>0){const f=d.map(h=>`tools[${h}]`).join(", ");throw new Error(`Incompatible tools found at ${f}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const c=(a=(i=(o=n==null?void 0:n.config)===null||o===void 0?void 0:o.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||a===void 0?void 0:a.streamFunctionCallArguments,p=(u=(l=n==null?void 0:n.config)===null||l===void 0?void 0:l.automaticFunctionCalling)===null||u===void 0?void 0:u.disable;if(c&&!p)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(o=>{var i;let a;const l=[];if(o!=null&&o.generatedImages)for(const d of o.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((i=d==null?void 0:d.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?a=d==null?void 0:d.safetyAttributes:l.push(d);let u;return a?u={generatedImages:l,positivePromptSafetyAttributes:a,sdkHttpResponse:o.sdkHttpResponse}:u={generatedImages:l,sdkHttpResponse:o.sdkHttpResponse},u}),this.list=async n=>{var o;const l={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((o=l.config)===null||o===void 0)&&o.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new te(W.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(l),l)},this.editImage=async n=>{const o={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(o.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(o)},this.upscaleImage=async n=>{let o={numberOfImages:1,mode:"upscale"};n.config&&(o=Object.assign(Object.assign({},o),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:o};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var o,i,a,l,u,d;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((o=n.video)===null||o===void 0)&&o.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((l=(a=n.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.uri&&(!((d=(u=n.source)===null||u===void 0?void 0:u.video)===null||d===void 0)&&d.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,o,i;const a=(n=e.config)===null||n===void 0?void 0:n.tools;if(!a)return e;const l=await Promise.all(a.map(async d=>se(d)?await d.tool():d)),u={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(u.config.tools=l,e.config&&e.config.tools&&vo(e.config.tools)){const d=(i=(o=e.config.httpOptions)===null||o===void 0?void 0:o.headers)!==null&&i!==void 0?i:{};let c=Object.assign({},d);Object.keys(c).length===0&&(c=this.apiClient.getDefaultHeaders()),To(c),u.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:c})}return u}async initAfcToolsMap(e){var n,o,i;const a=new Map;for(const l of(o=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&o!==void 0?o:[])if(se(l)){const u=l,d=await u.tool();for(const c of(i=d.functionDeclarations)!==null&&i!==void 0?i:[]){if(!c.name)throw new Error("Function declaration name is required.");if(a.has(c.name))throw new Error(`Duplicate tool declaration name: ${c.name}`);a.set(c.name,u)}}return a}async processAfcStream(e){var n,o,i;const a=(i=(o=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&i!==void 0?i:Un;let l=!1,u=0;const d=await this.initAfcToolsMap(e);return(function(c,p,f){return B(this,arguments,function*(){for(var h,m,g,v,y,T;u<a;){l&&(u++,l=!1);const w=yield A(c.processParamsMaybeAddMcpUsage(f)),P=yield A(c.generateContentStreamInternal(w)),R=[],U=[];try{for(var I=!0,S=(m=void 0,J(P)),C;C=yield A(S.next()),h=C.done,!h;I=!0){v=C.value,I=!1;const _=v;if(yield yield A(_),_.candidates&&(!((y=_.candidates[0])===null||y===void 0)&&y.content)){U.push(_.candidates[0].content);for(const x of(T=_.candidates[0].content.parts)!==null&&T!==void 0?T:[])if(u<a&&x.functionCall){if(!x.functionCall.name)throw new Error("Function call name was not returned by the model.");if(p.has(x.functionCall.name)){const L=yield A(p.get(x.functionCall.name).callTool([x.functionCall]));R.push(...L)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${p.keys()}, mising tool: ${x.functionCall.name}`)}}}}catch(_){m={error:_}}finally{try{!I&&!h&&(g=S.return)&&(yield A(g.call(S)))}finally{if(m)throw m.error}}if(R.length>0){l=!0;const _=new de;_.candidates=[{content:{role:"user",parts:R}}],yield yield A(_);const x=[];x.push(...U),x.push({role:"user",parts:R});const L=q(f.contents).concat(x);f.contents=L}else break}})})(this,d,e)}async generateContentInternal(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Nn(this.apiClient,e);return u=E("{model}:generateContent",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=Dn(p),h=new de;return Object.assign(h,f),h})}else{const c=Mn(this.apiClient,e);return u=E("{model}:generateContent",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=xn(p),h=new de;return Object.assign(h,f),h})}}async generateContentStreamInternal(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Nn(this.apiClient,e);return u=E("{model}:streamGenerateContent?alt=sse",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),l.then(function(f){return B(this,arguments,function*(){var h,m,g,v;try{for(var y=!0,T=J(f),I;I=yield A(T.next()),h=I.done,!h;y=!0){v=I.value,y=!1;const S=v,C=Dn(yield A(S.json()));C.sdkHttpResponse={headers:S.headers};const w=new de;Object.assign(w,C),yield yield A(w)}}catch(S){m={error:S}}finally{try{!y&&!h&&(g=T.return)&&(yield A(g.call(T)))}finally{if(m)throw m.error}}})})}else{const c=Mn(this.apiClient,e);return u=E("{model}:streamGenerateContent?alt=sse",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),l.then(function(f){return B(this,arguments,function*(){var h,m,g,v;try{for(var y=!0,T=J(f),I;I=yield A(T.next()),h=I.done,!h;y=!0){v=I.value,y=!1;const S=v,C=xn(yield A(S.json()));C.sdkHttpResponse={headers:S.headers};const w=new de;Object.assign(w,C),yield yield A(w)}}catch(S){m={error:S}}finally{try{!y&&!h&&(g=T.return)&&(yield A(g.call(T)))}finally{if(m)throw m.error}}})})}}async embedContent(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=aa(this.apiClient,e);return u=E("{model}:predict",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=ua(p),h=new pn;return Object.assign(h,f),h})}else{const c=sa(this.apiClient,e);return u=E("{model}:batchEmbedContents",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=la(p),h=new pn;return Object.assign(h,f),h})}}async generateImagesInternal(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Ea(this.apiClient,e);return u=E("{model}:predict",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=Ia(p),h=new fn;return Object.assign(h,f),h})}else{const c=Ta(this.apiClient,e);return u=E("{model}:predict",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=Sa(p),h=new fn;return Object.assign(h,f),h})}}async editImageInternal(e){var n,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=na(this.apiClient,e);return a=E("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(c=>{const p=c;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const c=oa(d),p=new di;return Object.assign(p,c),p})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=El(this.apiClient,e);return a=E("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(c=>{const p=c;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const c=Sl(d),p=new pi;return Object.assign(p,c),p})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=tl(this.apiClient,e);return a=E("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>{const c=nl(d),p=new fi;return Object.assign(p,c),p})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=ll(this.apiClient,e);return a=E("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>{const c=ul(d),p=new hi;return Object.assign(p,c),p})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Va(this.apiClient,e);return u=E("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>Ye(p))}else{const c=Ga(this.apiClient,e);return u=E("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>$e(p))}}async listInternal(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Ka(this.apiClient,e);return u=E("{models_url}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=Xa(p),h=new hn;return Object.assign(h,f),h})}else{const c=Wa(this.apiClient,e);return u=E("{models_url}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=za(p),h=new hn;return Object.assign(h,f),h})}}async update(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=vl(this.apiClient,e);return u=E("{model}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>Ye(p))}else{const c=yl(this.apiClient,e);return u=E("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>$e(p))}}async delete(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Zs(this.apiClient,e);return u=E("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=ea(p),h=new mn;return Object.assign(h,f),h})}else{const c=Qs(this.apiClient,e);return u=E("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=js(p),h=new mn;return Object.assign(h,f),h})}}async countTokens(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Ks(this.apiClient,e);return u=E("{model}:countTokens",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=Xs(p),h=new gn;return Object.assign(h,f),h})}else{const c=Ws(this.apiClient,e);return u=E("{model}:countTokens",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=zs(p),h=new gn;return Object.assign(h,f),h})}}async computeTokens(e){var n,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=qs(this.apiClient,e);return a=E("{model}:computeTokens",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(c=>{const p=c;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const c=Hs(d),p=new mi;return Object.assign(p,c),p})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Pa(this.apiClient,e);return u=E("{model}:predictLongRunning",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const f=wa(p),h=new Ce;return Object.assign(h,f),h})}else{const c=Ra(this.apiClient,e);return u=E("{model}:predictLongRunning",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>{const f=Aa(p),h=new Ce;return Object.assign(h,f),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hu extends K{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,o=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let a;o&&"httpOptions"in o&&(a=o.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:a}});return n._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:o});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(e){const n=e.operation,o=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let a;o&&"httpOptions"in o&&(a=o.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:a}});return n._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:o});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=ri(e);return u=E("{operationName}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l}else{const c=ii(e);return u=E("{operationName}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l}}async fetchPredictVideosOperationInternal(e){var n,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=Qo(e);return a=E("{resourceName}:fetchPredictOperation",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function mu(t){const e={},n=r(t,["data"]);if(n!=null&&s(e,["data"],n),r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=r(t,["mimeType"]);return o!=null&&s(e,["mimeType"],o),e}function gu(t){const e={},n=r(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(a=>Au(a))),s(e,["parts"],i)}const o=r(t,["role"]);return o!=null&&s(e,["role"],o),e}function yu(t,e,n){const o={},i=r(e,["expireTime"]);n!==void 0&&i!=null&&s(n,["expireTime"],i);const a=r(e,["newSessionExpireTime"]);n!==void 0&&a!=null&&s(n,["newSessionExpireTime"],a);const l=r(e,["uses"]);n!==void 0&&l!=null&&s(n,["uses"],l);const u=r(e,["liveConnectConstraints"]);n!==void 0&&u!=null&&s(n,["bidiGenerateContentSetup"],_u(t,u));const d=r(e,["lockAdditionalFields"]);return n!==void 0&&d!=null&&s(n,["fieldMask"],d),o}function vu(t,e){const n={},o=r(e,["config"]);return o!=null&&s(n,["config"],yu(t,o,n)),n}function Tu(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["fileUri"]);n!=null&&s(e,["fileUri"],n);const o=r(t,["mimeType"]);return o!=null&&s(e,["mimeType"],o),e}function Eu(t){const e={},n=r(t,["id"]);n!=null&&s(e,["id"],n);const o=r(t,["args"]);o!=null&&s(e,["args"],o);const i=r(t,["name"]);if(i!=null&&s(e,["name"],i),r(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(r(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Su(t){const e={};if(r(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=r(t,["enableWidget"]);return n!=null&&s(e,["enableWidget"],n),e}function Iu(t){const e={};if(r(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(r(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=r(t,["timeRangeFilter"]);return n!=null&&s(e,["timeRangeFilter"],n),e}function Cu(t,e){const n={},o=r(t,["generationConfig"]);e!==void 0&&o!=null&&s(e,["setup","generationConfig"],o);const i=r(t,["responseModalities"]);e!==void 0&&i!=null&&s(e,["setup","generationConfig","responseModalities"],i);const a=r(t,["temperature"]);e!==void 0&&a!=null&&s(e,["setup","generationConfig","temperature"],a);const l=r(t,["topP"]);e!==void 0&&l!=null&&s(e,["setup","generationConfig","topP"],l);const u=r(t,["topK"]);e!==void 0&&u!=null&&s(e,["setup","generationConfig","topK"],u);const d=r(t,["maxOutputTokens"]);e!==void 0&&d!=null&&s(e,["setup","generationConfig","maxOutputTokens"],d);const c=r(t,["mediaResolution"]);e!==void 0&&c!=null&&s(e,["setup","generationConfig","mediaResolution"],c);const p=r(t,["seed"]);e!==void 0&&p!=null&&s(e,["setup","generationConfig","seed"],p);const f=r(t,["speechConfig"]);e!==void 0&&f!=null&&s(e,["setup","generationConfig","speechConfig"],st(f));const h=r(t,["thinkingConfig"]);e!==void 0&&h!=null&&s(e,["setup","generationConfig","thinkingConfig"],h);const m=r(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&s(e,["setup","generationConfig","enableAffectiveDialog"],m);const g=r(t,["systemInstruction"]);e!==void 0&&g!=null&&s(e,["setup","systemInstruction"],gu(b(g)));const v=r(t,["tools"]);if(e!==void 0&&v!=null){let P=ue(v);Array.isArray(P)&&(P=P.map(R=>Ru(le(R)))),s(e,["setup","tools"],P)}const y=r(t,["sessionResumption"]);e!==void 0&&y!=null&&s(e,["setup","sessionResumption"],wu(y));const T=r(t,["inputAudioTranscription"]);e!==void 0&&T!=null&&s(e,["setup","inputAudioTranscription"],T);const I=r(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&s(e,["setup","outputAudioTranscription"],I);const S=r(t,["realtimeInputConfig"]);e!==void 0&&S!=null&&s(e,["setup","realtimeInputConfig"],S);const C=r(t,["contextWindowCompression"]);e!==void 0&&C!=null&&s(e,["setup","contextWindowCompression"],C);const w=r(t,["proactivity"]);if(e!==void 0&&w!=null&&s(e,["setup","proactivity"],w),r(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function _u(t,e){const n={},o=r(e,["model"]);o!=null&&s(n,["setup","model"],N(t,o));const i=r(e,["config"]);return i!=null&&s(n,["config"],Cu(i,n)),n}function Au(t){const e={},n=r(t,["mediaResolution"]);n!=null&&s(e,["mediaResolution"],n);const o=r(t,["codeExecutionResult"]);o!=null&&s(e,["codeExecutionResult"],o);const i=r(t,["executableCode"]);i!=null&&s(e,["executableCode"],i);const a=r(t,["fileData"]);a!=null&&s(e,["fileData"],Tu(a));const l=r(t,["functionCall"]);l!=null&&s(e,["functionCall"],Eu(l));const u=r(t,["functionResponse"]);u!=null&&s(e,["functionResponse"],u);const d=r(t,["inlineData"]);d!=null&&s(e,["inlineData"],mu(d));const c=r(t,["text"]);c!=null&&s(e,["text"],c);const p=r(t,["thought"]);p!=null&&s(e,["thought"],p);const f=r(t,["thoughtSignature"]);f!=null&&s(e,["thoughtSignature"],f);const h=r(t,["videoMetadata"]);return h!=null&&s(e,["videoMetadata"],h),e}function wu(t){const e={},n=r(t,["handle"]);if(n!=null&&s(e,["handle"],n),r(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Ru(t){const e={},n=r(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(f=>f)),s(e,["functionDeclarations"],p)}if(r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=r(t,["googleSearchRetrieval"]);o!=null&&s(e,["googleSearchRetrieval"],o);const i=r(t,["computerUse"]);i!=null&&s(e,["computerUse"],i);const a=r(t,["fileSearch"]);a!=null&&s(e,["fileSearch"],a);const l=r(t,["codeExecution"]);if(l!=null&&s(e,["codeExecution"],l),r(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=r(t,["googleMaps"]);u!=null&&s(e,["googleMaps"],Su(u));const d=r(t,["googleSearch"]);d!=null&&s(e,["googleSearch"],Iu(d));const c=r(t,["urlContext"]);return c!=null&&s(e,["urlContext"],c),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Pu(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const o=t[n];if(typeof o=="object"&&o!=null&&Object.keys(o).length>0){const i=Object.keys(o).map(a=>`${n}.${a}`);e.push(...i)}else e.push(n)}return e.join(",")}function Mu(t,e){let n=null;const o=t.bidiGenerateContentSetup;if(typeof o=="object"&&o!==null&&"setup"in o){const a=o.setup;typeof a=="object"&&a!==null?(t.bidiGenerateContentSetup=a,n=a):delete t.bidiGenerateContentSetup}else o!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(n){const a=Pu(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)a?t.fieldMask=a:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let u=[];i.length>0&&(u=i.map(c=>l.includes(c)?`generationConfig.${c}`:c));const d=[];a&&d.push(a),u.length>0&&d.push(...u),d.length>0?t.fieldMask=d.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class Nu extends K{constructor(e){super(),this.apiClient=e}async create(e){var n,o;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const u=vu(this.apiClient,e);a=E("auth_tokens",u._url),l=u._query,delete u.config,delete u._url,delete u._query;const d=Mu(u,e.config);return i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),i.then(c=>c)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xu(t,e){const n={},o=r(t,["force"]);return e!==void 0&&o!=null&&s(e,["_query","force"],o),n}function Du(t){const e={},n=r(t,["name"]);n!=null&&s(e,["_url","name"],n);const o=r(t,["config"]);return o!=null&&xu(o,e),e}function ku(t){const e={},n=r(t,["name"]);return n!=null&&s(e,["_url","name"],n),e}function Uu(t,e){const n={},o=r(t,["pageSize"]);e!==void 0&&o!=null&&s(e,["_query","pageSize"],o);const i=r(t,["pageToken"]);return e!==void 0&&i!=null&&s(e,["_query","pageToken"],i),n}function Lu(t){const e={},n=r(t,["parent"]);n!=null&&s(e,["_url","parent"],n);const o=r(t,["config"]);return o!=null&&Uu(o,e),e}function Fu(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&s(e,["sdkHttpResponse"],n);const o=r(t,["nextPageToken"]);o!=null&&s(e,["nextPageToken"],o);const i=r(t,["documents"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),s(e,["documents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class bu extends K{constructor(e){super(),this.apiClient=e,this.list=async n=>new te(W.PAGED_ITEM_DOCUMENTS,o=>this.listInternal({parent:n.parent,config:o.config}),await this.listInternal(n),n)}async get(e){var n,o;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=ku(e);return a=E("{name}",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async delete(e){var n,o;let i="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=Du(e);i=E("{name}",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var n,o;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Lu(e);return a=E("{parent}/documents",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>{const c=Fu(d),p=new gi;return Object.assign(p,c),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Gu extends K{constructor(e,n=new bu(e)){super(),this.apiClient=e,this.documents=n,this.list=async(o={})=>new te(W.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(o),o)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var n,o;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Pl(e);return a=E("fileSearchStores",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async get(e){var n,o;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=xl(e);return a=E("{name}",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async delete(e){var n,o;let i="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=Nl(e);i=E("{name}",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var n,o;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=bl(e);return a=E("fileSearchStores",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>{const c=Gl(d),p=new yi;return Object.assign(p,c),p})}}async uploadToFileSearchStoreInternal(e){var n,o;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Vl(e);return a=E("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>{const c=ql(d),p=new vi;return Object.assign(p,c),p})}}async importFile(e){var n,o;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Ul(e);return a=E("{file_search_store_name}:importFile",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>{const c=kl(d),p=new tt;return Object.assign(p,c),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Eo=function(){const{crypto:t}=globalThis;if(t!=null&&t.randomUUID)return Eo=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,o=>(+o^n()&15>>+o/4).toString(16))};const Vu=()=>Eo();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function We(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const Ke=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class H extends Error{}class V extends H{constructor(e,n,o,i){super(`${V.makeMessage(e,n,o)}`),this.status=e,this.headers=i,this.error=n}static makeMessage(e,n,o){const i=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):o;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,n,o,i){if(!e||!i)return new De({message:o,cause:Ke(n)});const a=n;return e===400?new Io(e,a,o,i):e===401?new Co(e,a,o,i):e===403?new _o(e,a,o,i):e===404?new Ao(e,a,o,i):e===409?new wo(e,a,o,i):e===422?new Ro(e,a,o,i):e===429?new Po(e,a,o,i):e>=500?new Mo(e,a,o,i):new V(e,a,o,i)}}class ze extends V{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class De extends V{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class So extends De{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Io extends V{}class Co extends V{}class _o extends V{}class Ao extends V{}class wo extends V{}class Ro extends V{}class Po extends V{}class Mo extends V{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qu=/^[a-z][a-z0-9+.-]*:/i,Hu=t=>qu.test(t);let Xe=t=>(Xe=Array.isArray,Xe(t));const Bu=Xe;let Ju=Bu;const Gn=Ju;function $u(t){if(!t)return!0;for(const e in t)return!1;return!0}function Yu(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const Ou=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new H(`${t} must be an integer`);if(e<0)throw new H(`${t} must be a positive integer`);return e},Wu=t=>{try{return JSON.parse(t)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ku=t=>new Promise(e=>setTimeout(e,t));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ne="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zu(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const Xu=()=>{var t,e,n,o,i;const a=zu();if(a==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ne,"X-Stainless-OS":qn(Deno.build.os),"X-Stainless-Arch":Vn(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(t=Deno.version)===null||t===void 0?void 0:t.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ne,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(a==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ne,"X-Stainless-OS":qn((n=globalThis.process.platform)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Arch":Vn((o=globalThis.process.arch)!==null&&o!==void 0?o:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(i=globalThis.process.version)!==null&&i!==void 0?i:"unknown"};const l=Qu();return l?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ne,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${l.browser}`,"X-Stainless-Runtime-Version":l.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ne,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Qu(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const o=n.exec(navigator.userAgent);if(o){const i=o[1]||0,a=o[2]||0,l=o[3]||0;return{browser:e,version:`${i}.${a}.${l}`}}}return null}const Vn=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",qn=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let me;const Zu=()=>me??(me=Xu());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ju(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function No(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function ec(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return No({start(){},async pull(n){const{done:o,value:i}=await e.next();o?n.close():n.enqueue(i)},async cancel(){var n;await((n=e.return)===null||n===void 0?void 0:n.call(e))}})}function xo(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function tc(t){var e,n;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((n=(e=t[Symbol.asyncIterator]()).return)===null||n===void 0?void 0:n.call(e));return}const o=t.getReader(),i=o.cancel();o.releaseLock(),await i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const nc=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Do=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,n=typeof((t=e==null?void 0:e.versions)===null||t===void 0?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Fe(t,e,n){return Do(),new File(t,e??"unknown_file",n)}function oc(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const ic=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ko=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",rc=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&ko(t),sc=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function ac(t,e,n){if(Do(),t=await t,rc(t))return t instanceof File?t:Fe([await t.arrayBuffer()],t.name);if(sc(t)){const i=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),Fe(await Qe(i),e,n)}const o=await Qe(t);if(e||(e=oc(t)),!(n!=null&&n.type)){const i=o.find(a=>typeof a=="object"&&"type"in a&&a.type);typeof i=="string"&&(n=Object.assign(Object.assign({},n),{type:i}))}return Fe(o,e,n)}async function Qe(t){var e,n,o,i,a;let l=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)l.push(t);else if(ko(t))l.push(t instanceof Blob?t:await t.arrayBuffer());else if(ic(t))try{for(var u=!0,d=J(t),c;c=await d.next(),e=c.done,!e;u=!0){i=c.value,u=!1;const p=i;l.push(...await Qe(p))}}catch(p){n={error:p}}finally{try{!u&&!e&&(o=d.return)&&await o.call(d)}finally{if(n)throw n.error}}else{const p=(a=t==null?void 0:t.constructor)===null||a===void 0?void 0:a.name;throw new Error(`Unexpected data type: ${typeof t}${p?`; constructor: ${p}`:""}${lc(t)}`)}return l}function lc(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Uo{constructor(e){this._client=e}}Uo._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Lo(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Hn=Object.freeze(Object.create(null)),uc=(t=Lo)=>(function(n,...o){if(n.length===1)return n[0];let i=!1;const a=[],l=n.reduce((p,f,h)=>{var m,g,v;/[?#]/.test(f)&&(i=!0);const y=o[h];let T=(i?encodeURIComponent:t)(""+y);return h!==o.length&&(y==null||typeof y=="object"&&y.toString===((v=Object.getPrototypeOf((g=Object.getPrototypeOf((m=y.hasOwnProperty)!==null&&m!==void 0?m:Hn))!==null&&g!==void 0?g:Hn))===null||v===void 0?void 0:v.toString))&&(T=y+"",a.push({start:p.length+f.length,length:T.length,error:`Value of type ${Object.prototype.toString.call(y).slice(8,-1)} is not a valid path parameter`})),p+f+(h===o.length?"":T)},""),u=l.split(/[?#]/,1)[0],d=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let c;for(;(c=d.exec(u))!==null;)a.push({start:c.index,length:c[0].length,error:`Value "${c[0]}" can't be safely passed as a path parameter`});if(a.sort((p,f)=>p.start-f.start),a.length>0){let p=0;const f=a.reduce((h,m)=>{const g=" ".repeat(m.start-p),v="^".repeat(m.length);return p=m.start+m.length,h+g+v},"");throw new H(`Path parameters result in path with invalid segments:
${a.map(h=>h.error).join(`
`)}
${l}
${f}`)}return l}),ge=uc(Lo);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Fo extends Uo{create(e,n){var o;const{api_version:i=this._client.apiVersion}=e,a=Ae(e,["api_version"]);if("model"in a&&"agent_config"in a)throw new H("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in a&&"generation_config"in a)throw new H("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(ge`/${i}/interactions`,Object.assign(Object.assign({body:a},n),{stream:(o=e.stream)!==null&&o!==void 0?o:!1}))}delete(e,n={},o){const{api_version:i=this._client.apiVersion}=n??{};return this._client.delete(ge`/${i}/interactions/${e}`,o)}cancel(e,n={},o){const{api_version:i=this._client.apiVersion}=n??{};return this._client.post(ge`/${i}/interactions/${e}/cancel`,o)}get(e,n={},o){var i;const a=n??{},{api_version:l=this._client.apiVersion}=a,u=Ae(a,["api_version"]);return this._client.get(ge`/${l}/interactions/${e}`,Object.assign(Object.assign({query:u},o),{stream:(i=n==null?void 0:n.stream)!==null&&i!==void 0?i:!1}))}}Fo._key=Object.freeze(["interactions"]);class bo extends Fo{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cc(t){let e=0;for(const i of t)e+=i.length;const n=new Uint8Array(e);let o=0;for(const i of t)n.set(i,o),o+=i.length;return n}let ye;function lt(t){let e;return(ye??(e=new globalThis.TextEncoder,ye=e.encode.bind(e)))(t)}let ve;function Bn(t){let e;return(ve??(e=new globalThis.TextDecoder,ve=e.decode.bind(e)))(t)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ke{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?lt(e):e;this.buffer=cc([this.buffer,n]);const o=[];let i;for(;(i=dc(this.buffer,this.carriageReturnIndex))!=null;){if(i.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=i.index;continue}if(this.carriageReturnIndex!=null&&(i.index!==this.carriageReturnIndex+1||i.carriage)){o.push(Bn(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const a=this.carriageReturnIndex!==null?i.preceding-1:i.preceding,l=Bn(this.buffer.subarray(0,a));o.push(l),this.buffer=this.buffer.subarray(i.index),this.carriageReturnIndex=null}return o}flush(){return this.buffer.length?this.decode(`
`):[]}}ke.NEWLINE_CHARS=new Set([`
`,"\r"]);ke.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function dc(t,e){for(let i=e??0;i<t.length;i++){if(t[i]===10)return{preceding:i,index:i+1,carriage:!1};if(t[i]===13)return{preceding:i,index:i+1,carriage:!0}}return null}function pc(t){for(let o=0;o<t.length-1;o++){if(t[o]===10&&t[o+1]===10||t[o]===13&&t[o+1]===13)return o+2;if(t[o]===13&&t[o+1]===10&&o+3<t.length&&t[o+2]===13&&t[o+3]===10)return o+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const we={off:0,error:200,warn:300,info:400,debug:500},Jn=(t,e,n)=>{if(t){if(Yu(we,t))return t;G(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(we))}`)}};function pe(){}function Te(t,e,n){return!e||we[t]>we[n]?pe:e[t].bind(e)}const fc={error:pe,warn:pe,info:pe,debug:pe};let $n=new WeakMap;function G(t){var e;const n=t.logger,o=(e=t.logLevel)!==null&&e!==void 0?e:"off";if(!n)return fc;const i=$n.get(n);if(i&&i[0]===o)return i[1];const a={error:Te("error",n,o),warn:Te("warn",n,o),info:Te("info",n,o),debug:Te("debug",n,o)};return $n.set(n,[o,a]),a}const j=t=>(t.options&&(t.options=Object.assign({},t.options),delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ie{constructor(e,n,o){this.iterator=e,this.controller=n,this.client=o}static fromSSEResponse(e,n,o){let i=!1;const a=o?G(o):console;function l(){return B(this,arguments,function*(){var d,c,p,f;if(i)throw new H("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let h=!1;try{try{for(var m=!0,g=J(hc(e,n)),v;v=yield A(g.next()),d=v.done,!d;m=!0){f=v.value,m=!1;const y=f;if(!h)if(y.data.startsWith("[DONE]")){h=!0;continue}else try{yield yield A(JSON.parse(y.data))}catch(T){throw a.error("Could not parse message into JSON:",y.data),a.error("From chunk:",y.raw),T}}}catch(y){c={error:y}}finally{try{!m&&!d&&(p=g.return)&&(yield A(p.call(g)))}finally{if(c)throw c.error}}h=!0}catch(y){if(We(y))return yield A(void 0);throw y}finally{h||n.abort()}})}return new ie(l,n,o)}static fromReadableStream(e,n,o){let i=!1;function a(){return B(this,arguments,function*(){var d,c,p,f;const h=new ke,m=xo(e);try{for(var g=!0,v=J(m),y;y=yield A(v.next()),d=y.done,!d;g=!0){f=y.value,g=!1;const T=f;for(const I of h.decode(T))yield yield A(I)}}catch(T){c={error:T}}finally{try{!g&&!d&&(p=v.return)&&(yield A(p.call(v)))}finally{if(c)throw c.error}}for(const T of h.flush())yield yield A(T)})}function l(){return B(this,arguments,function*(){var d,c,p,f;if(i)throw new H("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let h=!1;try{try{for(var m=!0,g=J(a()),v;v=yield A(g.next()),d=v.done,!d;m=!0){f=v.value,m=!1;const y=f;h||y&&(yield yield A(JSON.parse(y)))}}catch(y){c={error:y}}finally{try{!m&&!d&&(p=g.return)&&(yield A(p.call(g)))}finally{if(c)throw c.error}}h=!0}catch(y){if(We(y))return yield A(void 0);throw y}finally{h||n.abort()}})}return new ie(l,n,o)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],o=this.iterator(),i=a=>({next:()=>{if(a.length===0){const l=o.next();e.push(l),n.push(l)}return a.shift()}});return[new ie(()=>i(e),this.controller,this.client),new ie(()=>i(n),this.controller,this.client)]}toReadableStream(){const e=this;let n;return No({async start(){n=e[Symbol.asyncIterator]()},async pull(o){try{const{value:i,done:a}=await n.next();if(a)return o.close();const l=lt(JSON.stringify(i)+`
`);o.enqueue(l)}catch(i){o.error(i)}},async cancel(){var o;await((o=n.return)===null||o===void 0?void 0:o.call(n))}})}}function hc(t,e){return B(this,arguments,function*(){var o,i,a,l;if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new H("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new H("Attempted to iterate over a response with no body");const u=new gc,d=new ke,c=xo(t.body);try{for(var p=!0,f=J(mc(c)),h;h=yield A(f.next()),o=h.done,!o;p=!0){l=h.value,p=!1;const m=l;for(const g of d.decode(m)){const v=u.decode(g);v&&(yield yield A(v))}}}catch(m){i={error:m}}finally{try{!p&&!o&&(a=f.return)&&(yield A(a.call(f)))}finally{if(i)throw i.error}}for(const m of d.flush()){const g=u.decode(m);g&&(yield yield A(g))}})}function mc(t){return B(this,arguments,function*(){var n,o,i,a;let l=new Uint8Array;try{for(var u=!0,d=J(t),c;c=yield A(d.next()),n=c.done,!n;u=!0){a=c.value,u=!1;const p=a;if(p==null)continue;const f=p instanceof ArrayBuffer?new Uint8Array(p):typeof p=="string"?lt(p):p;let h=new Uint8Array(l.length+f.length);h.set(l),h.set(f,l.length),l=h;let m;for(;(m=pc(l))!==-1;)yield yield A(l.slice(0,m)),l=l.slice(m)}}catch(p){o={error:p}}finally{try{!u&&!n&&(i=d.return)&&(yield A(i.call(d)))}finally{if(o)throw o.error}}l.length>0&&(yield yield A(l))})}class gc{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,o,i]=yc(e,":");return i.startsWith(" ")&&(i=i.substring(1)),n==="event"?this.event=i:n==="data"&&this.data.push(i),null}}function yc(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function vc(t,e){const{response:n,requestLogID:o,retryOfRequestLogID:i,startTime:a}=e,l=await(async()=>{var u;if(e.options.stream)return G(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):ie.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const d=n.headers.get("content-type"),c=(u=d==null?void 0:d.split(";")[0])===null||u===void 0?void 0:u.trim();return(c==null?void 0:c.includes("application/json"))||(c==null?void 0:c.endsWith("+json"))?await n.json():await n.text()})();return G(t).debug(`[${o}] response parsed`,j({retryOfRequestLogID:i,url:n.url,status:n.status,body:l,durationMs:Date.now()-a})),l}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ut extends Promise{constructor(e,n,o=vc){super(i=>{i(null)}),this.responsePromise=n,this.parseResponse=o,this.client=e}_thenUnwrap(e){return new ut(this.client,this.responsePromise,async(n,o)=>e(await this.parseResponse(n,o),o))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Go=Symbol("brand.privateNullableHeaders");function*Tc(t){if(!t)return;if(Go in t){const{values:o,nulls:i}=t;yield*o.entries();for(const a of i)yield[a,null];return}let e=!1,n;t instanceof Headers?n=t.entries():Gn(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let o of n){const i=o[0];if(typeof i!="string")throw new TypeError("expected header name to be a string");const a=Gn(o[1])?o[1]:[o[1]];let l=!1;for(const u of a)u!==void 0&&(e&&!l&&(l=!0,yield[i,null]),yield[i,u])}}const be=t=>{const e=new Headers,n=new Set;for(const o of t){const i=new Set;for(const[a,l]of Tc(o)){const u=a.toLowerCase();i.has(u)||(e.delete(a),i.add(u)),l===null?(e.delete(a),n.add(u)):(e.append(a,l),n.delete(u))}}return{[Go]:!0,values:e,nulls:n}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ge=t=>{var e,n,o,i,a,l;if(typeof globalThis.process<"u")return(o=(n=(e=Yo)===null||e===void 0?void 0:e[t])===null||n===void 0?void 0:n.trim())!==null&&o!==void 0?o:void 0;if(typeof globalThis.Deno<"u")return(l=(a=(i=globalThis.Deno.env)===null||i===void 0?void 0:i.get)===null||a===void 0?void 0:a.call(i,t))===null||l===void 0?void 0:l.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Vo;class Ue{constructor(e){var n,o,i,a,l,u,d,c=e===void 0?{}:e,{baseURL:p=Ge("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:f=(n=Ge("GEMINI_API_KEY"))!==null&&n!==void 0?n:null,apiVersion:h="v1beta"}=c,m=Ae(c,["baseURL","apiKey","apiVersion"]);const g=Object.assign(Object.assign({apiKey:f,apiVersion:h},m),{baseURL:p||"https://generativelanguage.googleapis.com"});this.baseURL=g.baseURL,this.timeout=(o=g.timeout)!==null&&o!==void 0?o:Ue.DEFAULT_TIMEOUT,this.logger=(i=g.logger)!==null&&i!==void 0?i:console;const v="warn";this.logLevel=v,this.logLevel=(l=(a=Jn(g.logLevel,"ClientOptions.logLevel",this))!==null&&a!==void 0?a:Jn(Ge("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&l!==void 0?l:v,this.fetchOptions=g.fetchOptions,this.maxRetries=(u=g.maxRetries)!==null&&u!==void 0?u:2,this.fetch=(d=g.fetch)!==null&&d!==void 0?d:ju(),this.encoder=nc,this._options=g,this.apiKey=f,this.apiVersion=h}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){if(!(this.apiKey&&e.get("x-goog-api-key"))&&!n.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){if(this.apiKey!=null)return be([{"x-goog-api-key":this.apiKey}])}stringifyQuery(e){return Object.entries(e).filter(([n,o])=>typeof o<"u").map(([n,o])=>{if(typeof o=="string"||typeof o=="number"||typeof o=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(o)}`;if(o===null)return`${encodeURIComponent(n)}=`;throw new H(`Cannot stringify type ${typeof o}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${ne}`}defaultIdempotencyKey(){return`stainless-node-retry-${Vu()}`}makeStatusError(e,n,o,i){return V.generate(e,n,o,i)}buildURL(e,n,o){const i=!this.baseURLOverridden()&&o||this.baseURL,a=Hu(e)?new URL(e):new URL(i+(i.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),l=this.defaultQuery();return $u(l)||(n=Object.assign(Object.assign({},l),n)),typeof n=="object"&&n&&!Array.isArray(n)&&(a.search=this.stringifyQuery(n)),a.toString()}async prepareOptions(e){}async prepareRequest(e,{url:n,options:o}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,o){return this.request(Promise.resolve(o).then(i=>Object.assign({method:e,path:n},i)))}request(e,n=null){return new ut(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,o){var i,a,l;const u=await e,d=(i=u.maxRetries)!==null&&i!==void 0?i:this.maxRetries;n==null&&(n=d),await this.prepareOptions(u);const{req:c,url:p,timeout:f}=await this.buildRequest(u,{retryCount:d-n});await this.prepareRequest(c,{url:p,options:u});const h="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),m=o===void 0?"":`, retryOf: ${o}`,g=Date.now();if(G(this).debug(`[${h}] sending request`,j({retryOfRequestLogID:o,method:u.method,url:p,options:u,headers:c.headers})),!((a=u.signal)===null||a===void 0)&&a.aborted)throw new ze;const v=new AbortController,y=await this.fetchWithTimeout(p,c,f,v).catch(Ke),T=Date.now();if(y instanceof globalThis.Error){const S=`retrying, ${n} attempts remaining`;if(!((l=u.signal)===null||l===void 0)&&l.aborted)throw new ze;const C=We(y)||/timed? ?out/i.test(String(y)+("cause"in y?String(y.cause):""));if(n)return G(this).info(`[${h}] connection ${C?"timed out":"failed"} - ${S}`),G(this).debug(`[${h}] connection ${C?"timed out":"failed"} (${S})`,j({retryOfRequestLogID:o,url:p,durationMs:T-g,message:y.message})),this.retryRequest(u,n,o??h);throw G(this).info(`[${h}] connection ${C?"timed out":"failed"} - error; no more retries left`),G(this).debug(`[${h}] connection ${C?"timed out":"failed"} (error; no more retries left)`,j({retryOfRequestLogID:o,url:p,durationMs:T-g,message:y.message})),C?new So:new De({cause:y})}const I=`[${h}${m}] ${c.method} ${p} ${y.ok?"succeeded":"failed"} with status ${y.status} in ${T-g}ms`;if(!y.ok){const S=await this.shouldRetry(y);if(n&&S){const _=`retrying, ${n} attempts remaining`;return await tc(y.body),G(this).info(`${I} - ${_}`),G(this).debug(`[${h}] response error (${_})`,j({retryOfRequestLogID:o,url:y.url,status:y.status,headers:y.headers,durationMs:T-g})),this.retryRequest(u,n,o??h,y.headers)}const C=S?"error; no more retries left":"error; not retryable";G(this).info(`${I} - ${C}`);const w=await y.text().catch(_=>Ke(_).message),P=Wu(w),R=P?void 0:w;throw G(this).debug(`[${h}] response error (${C})`,j({retryOfRequestLogID:o,url:y.url,status:y.status,headers:y.headers,message:R,durationMs:Date.now()-g})),this.makeStatusError(y.status,P,R,y.headers)}return G(this).info(I),G(this).debug(`[${h}] response start`,j({retryOfRequestLogID:o,url:y.url,status:y.status,headers:y.headers,durationMs:T-g})),{response:y,options:u,controller:v,requestLogID:h,retryOfRequestLogID:o,startTime:g}}async fetchWithTimeout(e,n,o,i){const a=n||{},{signal:l,method:u}=a,d=Ae(a,["signal","method"]);l&&l.addEventListener("abort",()=>i.abort());const c=setTimeout(()=>i.abort(),o),p=globalThis.ReadableStream&&d.body instanceof globalThis.ReadableStream||typeof d.body=="object"&&d.body!==null&&Symbol.asyncIterator in d.body,f=Object.assign(Object.assign(Object.assign({signal:i.signal},p?{duplex:"half"}:{}),{method:"GET"}),d);u&&(f.method=u.toUpperCase());try{return await this.fetch.call(void 0,e,f)}finally{clearTimeout(c)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,o,i){var a;let l;const u=i==null?void 0:i.get("retry-after-ms");if(u){const c=parseFloat(u);Number.isNaN(c)||(l=c)}const d=i==null?void 0:i.get("retry-after");if(d&&!l){const c=parseFloat(d);Number.isNaN(c)?l=Date.parse(d)-Date.now():l=c*1e3}if(!(l&&0<=l&&l<60*1e3)){const c=(a=e.maxRetries)!==null&&a!==void 0?a:this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(n,c)}return await Ku(l),this.makeRequest(e,n-1,o)}calculateDefaultRetryTimeoutMillis(e,n){const a=n-e,l=Math.min(.5*Math.pow(2,a),8),u=1-Math.random()*.25;return l*u*1e3}async buildRequest(e,{retryCount:n=0}={}){var o,i,a;const l=Object.assign({},e),{method:u,path:d,query:c,defaultBaseURL:p}=l,f=this.buildURL(d,c,p);"timeout"in l&&Ou("timeout",l.timeout),l.timeout=(o=l.timeout)!==null&&o!==void 0?o:this.timeout;const{bodyHeaders:h,body:m}=this.buildBody({options:l}),g=await this.buildHeaders({options:e,method:u,bodyHeaders:h,retryCount:n});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:u,headers:g},l.signal&&{signal:l.signal}),globalThis.ReadableStream&&m instanceof globalThis.ReadableStream&&{duplex:"half"}),m&&{body:m}),(i=this.fetchOptions)!==null&&i!==void 0?i:{}),(a=l.fetchOptions)!==null&&a!==void 0?a:{}),url:f,timeout:l.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:o,retryCount:i}){let a={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const l=be([a,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),Zu()),await this.authHeaders(e),this._options.defaultHeaders,o,e.headers]);return this.validateHeaders(l),l.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const o=be([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&o.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:ec(e)}:this.encoder({body:e,headers:o})}}Ue.DEFAULT_TIMEOUT=6e4;class F extends Ue{constructor(){super(...arguments),this.interactions=new bo(this)}}Vo=F;F.GeminiNextGenAPIClient=Vo;F.GeminiNextGenAPIClientError=H;F.APIError=V;F.APIConnectionError=De;F.APIConnectionTimeoutError=So;F.APIUserAbortError=ze;F.NotFoundError=Ao;F.ConflictError=wo;F.RateLimitError=Po;F.BadRequestError=Io;F.AuthenticationError=Co;F.InternalServerError=Mo;F.PermissionDeniedError=_o;F.UnprocessableEntityError=Ro;F.toFile=ac;F.Interactions=bo;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ec(t,e){const n={},o=r(t,["name"]);return o!=null&&s(n,["_url","name"],o),n}function Sc(t,e){const n={},o=r(t,["name"]);return o!=null&&s(n,["_url","name"],o),n}function Ic(t,e){const n={},o=r(t,["sdkHttpResponse"]);return o!=null&&s(n,["sdkHttpResponse"],o),n}function Cc(t,e){const n={},o=r(t,["sdkHttpResponse"]);return o!=null&&s(n,["sdkHttpResponse"],o),n}function _c(t,e,n){const o={};if(r(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=r(t,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&s(e,["displayName"],i),r(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=r(t,["epochCount"]);e!==void 0&&a!=null&&s(e,["tuningTask","hyperparameters","epochCount"],a);const l=r(t,["learningRateMultiplier"]);if(l!=null&&s(o,["tuningTask","hyperparameters","learningRateMultiplier"],l),r(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(r(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(r(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=r(t,["batchSize"]);e!==void 0&&u!=null&&s(e,["tuningTask","hyperparameters","batchSize"],u);const d=r(t,["learningRate"]);if(e!==void 0&&d!=null&&s(e,["tuningTask","hyperparameters","learningRate"],d),r(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(r(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return o}function Ac(t,e,n){const o={};let i=r(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const m=r(t,["validationDataset"]);e!==void 0&&m!=null&&s(e,["supervisedTuningSpec"],Yn(m))}else if(i==="PREFERENCE_TUNING"){const m=r(t,["validationDataset"]);e!==void 0&&m!=null&&s(e,["preferenceOptimizationSpec"],Yn(m))}const a=r(t,["tunedModelDisplayName"]);e!==void 0&&a!=null&&s(e,["tunedModelDisplayName"],a);const l=r(t,["description"]);e!==void 0&&l!=null&&s(e,["description"],l);let u=r(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const m=r(t,["epochCount"]);e!==void 0&&m!=null&&s(e,["supervisedTuningSpec","hyperParameters","epochCount"],m)}else if(u==="PREFERENCE_TUNING"){const m=r(t,["epochCount"]);e!==void 0&&m!=null&&s(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],m)}let d=r(n,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const m=r(t,["learningRateMultiplier"]);e!==void 0&&m!=null&&s(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],m)}else if(d==="PREFERENCE_TUNING"){const m=r(t,["learningRateMultiplier"]);e!==void 0&&m!=null&&s(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],m)}let c=r(n,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const m=r(t,["exportLastCheckpointOnly"]);e!==void 0&&m!=null&&s(e,["supervisedTuningSpec","exportLastCheckpointOnly"],m)}else if(c==="PREFERENCE_TUNING"){const m=r(t,["exportLastCheckpointOnly"]);e!==void 0&&m!=null&&s(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],m)}let p=r(n,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const m=r(t,["adapterSize"]);e!==void 0&&m!=null&&s(e,["supervisedTuningSpec","hyperParameters","adapterSize"],m)}else if(p==="PREFERENCE_TUNING"){const m=r(t,["adapterSize"]);e!==void 0&&m!=null&&s(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],m)}if(r(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(r(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const f=r(t,["labels"]);e!==void 0&&f!=null&&s(e,["labels"],f);const h=r(t,["beta"]);return e!==void 0&&h!=null&&s(e,["preferenceOptimizationSpec","hyperParameters","beta"],h),o}function wc(t,e){const n={},o=r(t,["baseModel"]);o!=null&&s(n,["baseModel"],o);const i=r(t,["preTunedModel"]);i!=null&&s(n,["preTunedModel"],i);const a=r(t,["trainingDataset"]);a!=null&&bc(a);const l=r(t,["config"]);return l!=null&&_c(l,n),n}function Rc(t,e){const n={},o=r(t,["baseModel"]);o!=null&&s(n,["baseModel"],o);const i=r(t,["preTunedModel"]);i!=null&&s(n,["preTunedModel"],i);const a=r(t,["trainingDataset"]);a!=null&&Gc(a,n,e);const l=r(t,["config"]);return l!=null&&Ac(l,n,e),n}function Pc(t,e){const n={},o=r(t,["name"]);return o!=null&&s(n,["_url","name"],o),n}function Mc(t,e){const n={},o=r(t,["name"]);return o!=null&&s(n,["_url","name"],o),n}function Nc(t,e,n){const o={},i=r(t,["pageSize"]);e!==void 0&&i!=null&&s(e,["_query","pageSize"],i);const a=r(t,["pageToken"]);e!==void 0&&a!=null&&s(e,["_query","pageToken"],a);const l=r(t,["filter"]);return e!==void 0&&l!=null&&s(e,["_query","filter"],l),o}function xc(t,e,n){const o={},i=r(t,["pageSize"]);e!==void 0&&i!=null&&s(e,["_query","pageSize"],i);const a=r(t,["pageToken"]);e!==void 0&&a!=null&&s(e,["_query","pageToken"],a);const l=r(t,["filter"]);return e!==void 0&&l!=null&&s(e,["_query","filter"],l),o}function Dc(t,e){const n={},o=r(t,["config"]);return o!=null&&Nc(o,n),n}function kc(t,e){const n={},o=r(t,["config"]);return o!=null&&xc(o,n),n}function Uc(t,e){const n={},o=r(t,["sdkHttpResponse"]);o!=null&&s(n,["sdkHttpResponse"],o);const i=r(t,["nextPageToken"]);i!=null&&s(n,["nextPageToken"],i);const a=r(t,["tunedModels"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>qo(u))),s(n,["tuningJobs"],l)}return n}function Lc(t,e){const n={},o=r(t,["sdkHttpResponse"]);o!=null&&s(n,["sdkHttpResponse"],o);const i=r(t,["nextPageToken"]);i!=null&&s(n,["nextPageToken"],i);const a=r(t,["tuningJobs"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>Ze(u))),s(n,["tuningJobs"],l)}return n}function Fc(t,e){const n={},o=r(t,["name"]);o!=null&&s(n,["model"],o);const i=r(t,["name"]);return i!=null&&s(n,["endpoint"],i),n}function bc(t,e){const n={};if(r(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(r(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const o=r(t,["examples"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(a=>a)),s(n,["examples","examples"],i)}return n}function Gc(t,e,n){const o={};let i=r(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const l=r(t,["gcsUri"]);e!==void 0&&l!=null&&s(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(i==="PREFERENCE_TUNING"){const l=r(t,["gcsUri"]);e!==void 0&&l!=null&&s(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}let a=r(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const l=r(t,["vertexDatasetResource"]);e!==void 0&&l!=null&&s(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(a==="PREFERENCE_TUNING"){const l=r(t,["vertexDatasetResource"]);e!==void 0&&l!=null&&s(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}if(r(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return o}function qo(t,e){const n={},o=r(t,["sdkHttpResponse"]);o!=null&&s(n,["sdkHttpResponse"],o);const i=r(t,["name"]);i!=null&&s(n,["name"],i);const a=r(t,["state"]);a!=null&&s(n,["state"],jn(a));const l=r(t,["createTime"]);l!=null&&s(n,["createTime"],l);const u=r(t,["tuningTask","startTime"]);u!=null&&s(n,["startTime"],u);const d=r(t,["tuningTask","completeTime"]);d!=null&&s(n,["endTime"],d);const c=r(t,["updateTime"]);c!=null&&s(n,["updateTime"],c);const p=r(t,["description"]);p!=null&&s(n,["description"],p);const f=r(t,["baseModel"]);f!=null&&s(n,["baseModel"],f);const h=r(t,["_self"]);return h!=null&&s(n,["tunedModel"],Fc(h)),n}function Ze(t,e){const n={},o=r(t,["sdkHttpResponse"]);o!=null&&s(n,["sdkHttpResponse"],o);const i=r(t,["name"]);i!=null&&s(n,["name"],i);const a=r(t,["state"]);a!=null&&s(n,["state"],jn(a));const l=r(t,["createTime"]);l!=null&&s(n,["createTime"],l);const u=r(t,["startTime"]);u!=null&&s(n,["startTime"],u);const d=r(t,["endTime"]);d!=null&&s(n,["endTime"],d);const c=r(t,["updateTime"]);c!=null&&s(n,["updateTime"],c);const p=r(t,["error"]);p!=null&&s(n,["error"],p);const f=r(t,["description"]);f!=null&&s(n,["description"],f);const h=r(t,["baseModel"]);h!=null&&s(n,["baseModel"],h);const m=r(t,["tunedModel"]);m!=null&&s(n,["tunedModel"],m);const g=r(t,["preTunedModel"]);g!=null&&s(n,["preTunedModel"],g);const v=r(t,["supervisedTuningSpec"]);v!=null&&s(n,["supervisedTuningSpec"],v);const y=r(t,["preferenceOptimizationSpec"]);y!=null&&s(n,["preferenceOptimizationSpec"],y);const T=r(t,["tuningDataStats"]);T!=null&&s(n,["tuningDataStats"],T);const I=r(t,["encryptionSpec"]);I!=null&&s(n,["encryptionSpec"],I);const S=r(t,["partnerModelTuningSpec"]);S!=null&&s(n,["partnerModelTuningSpec"],S);const C=r(t,["customBaseModel"]);C!=null&&s(n,["customBaseModel"],C);const w=r(t,["experiment"]);w!=null&&s(n,["experiment"],w);const P=r(t,["labels"]);P!=null&&s(n,["labels"],P);const R=r(t,["outputUri"]);R!=null&&s(n,["outputUri"],R);const U=r(t,["pipelineJob"]);U!=null&&s(n,["pipelineJob"],U);const _=r(t,["serviceAccount"]);_!=null&&s(n,["serviceAccount"],_);const x=r(t,["tunedModelDisplayName"]);x!=null&&s(n,["tunedModelDisplayName"],x);const L=r(t,["veoTuningSpec"]);return L!=null&&s(n,["veoTuningSpec"],L),n}function Vc(t,e){const n={},o=r(t,["sdkHttpResponse"]);o!=null&&s(n,["sdkHttpResponse"],o);const i=r(t,["name"]);i!=null&&s(n,["name"],i);const a=r(t,["metadata"]);a!=null&&s(n,["metadata"],a);const l=r(t,["done"]);l!=null&&s(n,["done"],l);const u=r(t,["error"]);return u!=null&&s(n,["error"],u),n}function Yn(t,e){const n={},o=r(t,["gcsUri"]);o!=null&&s(n,["validationDatasetUri"],o);const i=r(t,["vertexDatasetResource"]);return i!=null&&s(n,["validationDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qc extends K{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new te(W.PAGED_ITEM_TUNING_JOBS,o=>this.listInternal(o),await this.listInternal(n),n),this.get=async n=>await this.getInternal(n),this.tune=async n=>{var o;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((o=n.config)===null||o===void 0)&&o.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const a=Object.assign(Object.assign({},n),{preTunedModel:i});return a.baseModel=void 0,await this.tuneInternal(a)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),a=await this.tuneMldevInternal(i);let l="";return a.metadata!==void 0&&a.metadata.tunedModel!==void 0?l=a.metadata.tunedModel:a.name!==void 0&&a.name.includes("/operations/")&&(l=a.name.split("/operations/")[0]),{name:l,state:qe.JOB_STATE_QUEUED}}}}async getInternal(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Mc(e);return u=E("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>Ze(p))}else{const c=Pc(e);return u=E("{name}",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>qo(p))}}async listInternal(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=kc(e);return u=E("tuningJobs",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=Lc(p),h=new yn;return Object.assign(h,f),h})}else{const c=Dc(e);return u=E("tunedModels",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=Uc(p),h=new yn;return Object.assign(h,f),h})}}async cancel(e){var n,o,i,a;let l,u="",d={};if(this.apiClient.isVertexAI()){const c=Sc(e);return u=E("{name}:cancel",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=Cc(p),h=new vn;return Object.assign(h,f),h})}else{const c=Ec(e);return u=E("{name}:cancel",c._url),d=c._query,delete c._url,delete c._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(f=>{const h=f;return h.sdkHttpResponse={headers:p.headers},h})),l.then(p=>{const f=Ic(p),h=new vn;return Object.assign(h,f),h})}}async tuneInternal(e){var n,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=Rc(e,e);return a=E("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(c=>{const p=c;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>Ze(d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,o;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=wc(e);return a=E("tunedModels",u._url),l=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(c=>{const p=c;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>Vc(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Hc{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Bc=1024*1024*8,Jc=3,$c=1e3,Yc=2,Re="x-goog-upload-status";async function Oc(t,e,n){var o;const i=await Ho(t,e,n),a=await(i==null?void 0:i.json());if(((o=i==null?void 0:i.headers)===null||o===void 0?void 0:o[Re])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return a.file}async function Wc(t,e,n){var o;const i=await Ho(t,e,n),a=await(i==null?void 0:i.json());if(((o=i==null?void 0:i.headers)===null||o===void 0?void 0:o[Re])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const l=Wn(a),u=new nt;return Object.assign(u,l),u}async function Ho(t,e,n){var o,i;let a=0,l=0,u=new He(new Response),d="upload";for(a=t.size;l<a;){const c=Math.min(Bc,a-l),p=t.slice(l,l+c);l+c>=a&&(d+=", finalize");let f=0,h=$c;for(;f<Jc&&(u=await n.request({path:"",body:p,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(l),"Content-Length":String(c)}}}),!(!((o=u==null?void 0:u.headers)===null||o===void 0)&&o[Re]));)f++,await zc(h),h=h*Yc;if(l+=c,((i=u==null?void 0:u.headers)===null||i===void 0?void 0:i[Re])!=="active")break;if(a<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return u}async function Kc(t){return{size:t.size,type:t.type}}function zc(t){return new Promise(e=>setTimeout(e,t))}class Xc{async upload(e,n,o){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Oc(e,n,o)}async uploadToFileSearchStore(e,n,o){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Wc(e,n,o)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Kc(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Qc{create(e,n,o){return new Zc(e,n,o)}}class Zc{constructor(e,n,o){this.url=e,this.headers=n,this.callbacks=o}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const On="x-goog-api-key";class jc{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(On)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(On,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ed="gl-node/";class td{get interactions(){if(this._interactions!==void 0)return this._interactions;if(console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions."),this.vertexai)throw new Error("This version of the GenAI SDK does not support Vertex AI API for interactions.");const e=this.httpOptions;e!=null&&e.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const n=new F({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e==null?void 0:e.timeout});return this._interactions=n.interactions,this._interactions}constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const o=zo(e.httpOptions,e.vertexai,void 0,void 0);o&&(e.httpOptions?e.httpOptions.baseUrl=o:e.httpOptions={baseUrl:o}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const i=new jc(this.apiKey);this.apiClient=new Kl({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:ed+"web",uploader:new Xc,downloader:new Hc}),this.models=new fu(this.apiClient),this.live=new au(this.apiClient,i,new Qc),this.batches=new _r(this.apiClient),this.chats=new rs(this.models,this.apiClient),this.caches=new ns(this.apiClient),this.files=new ms(this.apiClient),this.operations=new hu(this.apiClient),this.authTokens=new Nu(this.apiClient),this.tunings=new qc(this.apiClient),this.fileSearchStores=new Gu(this.apiClient)}}const ct={type:M.ARRAY,description:"An array of storyboard scenes for a short-form marketing video.",items:{type:M.OBJECT,properties:{voiceoverScript:{type:M.STRING,description:"A short, punchy line of text for a voiceover or on-screen caption for the scene. This MUST be one of the exact lines from the user-provided script."},voiceoverGuide:{type:M.STRING,description:"A guide for the voice actor describing the tone, emotion, and delivery for the voiceoverScript line. For example: 'Spoken with excitement and urgency', or 'A calm, reassuring tone.'"},imagePrompt:{type:M.STRING,description:"A detailed prompt for generating the **starting frame** of the scene. It must focus on the static composition: characters' appearance and pose, detailed background, objects, and lighting."},videoPrompt:{type:M.STRING,description:"A concise prompt describing the **action and movement** within the scene. It should focus only on what changes or moves. For example: 'The character looks up, eyes widening in surprise, as a single tear rolls down their cheek.' or 'Camera slowly pans right, following the bird as it takes flight.'"}},required:["voiceoverScript","voiceoverGuide","imagePrompt","videoPrompt"]}},fe={type:M.OBJECT,properties:{scenes:ct},required:["scenes"]},dt={type:M.OBJECT,properties:{script:{type:M.STRING,description:"The full voiceover script, with each scene's line separated by a newline character."}},required:["script"]};M.OBJECT;const nd=`You are a UGC (User-Generated Content) scriptwriting expert specializing in authentic, high-converting videos for supplement brands on platforms like TikTok and Instagram. Your task is to create a script that feels like a real person sharing their genuine experience, based on the provided product info, creator image, and video angle.

**CRITICAL STYLE GUIDELINES:**
*   **TONE:** Must be relatable, trustworthy, and conversational. Use simple, direct language. Avoid corporate marketing jargon at all costs.
*   **PERSONA:** Write from the first-person ("I," "my"). The script should reflect the personality and vibe of the person in the creator image.

**UGC SCRIPT STRUCTURE (You MUST follow this):**
1.  **Hook (Line 1):** Start with a relatable problem or a surprising personal statement to stop the scroll (e.g., "I never thought I'd have this much energy at 3 PM...").
2.  **Introduce Problem/Story (Line 2):** Briefly explain the personal struggle this product solves (e.g., "...I used to crash every single afternoon and felt so sluggish.").
3.  **The Discovery (Line 3):** Introduce the supplement as a solution you found, often with a hint of initial skepticism (e.g., "Then my friend recommended this, and honestly I was skeptical but decided to give it a try.").
4.  **Show, Don't Tell (Lines 4-5):** Describe the routine of using it and the noticeable benefits. Be specific. (e.g., "So now I just mix one scoop in my water every morning...", "After about a week, I noticed I wasn't reaching for that second coffee anymore.").
5.  **The Result (Line 6):** State the amazing, tangible outcome. (e.g., "Now I feel clear-headed and focused all day long, it's been a total game-changer.").
6.  **Call to Action (Line 7):** A simple, low-pressure CTA that feels like a friendly recommendation. You MUST incorporate the user-provided CTA message into this final line.

You will return the response as a single JSON object that strictly adheres to the provided schema. The script should be a single string with each line separated by a newline character ('\\n'). Do not add any extra text or explanations.`,od=`You are a UGC Video Director. Your job is to create visual prompts for a supplement ad that looks like it was authentically filmed by a creator on their phone.

**CRITICAL VISUAL GUIDELINES:**
*   **STYLE:** All scenes must look authentic and user-generated. This means natural lighting, simple compositions, and a "shot on a smartphone" aesthetic. It should NOT look like a professional, polished, or cinematic advertisement.
*   **LOCATIONS:** You MUST invent relatable, everyday settings for the scenes. **DO NOT** use the provided environment images, as there are none. The location must match the context of the voiceover. Good examples include: a clean kitchen counter with morning light, a home office desk, a bathroom shelf, inside a gym bag, in a car cup holder, a nightstand.
*   **SHOT TYPES:** Use simple, phone-friendly shots. AVOID cinematic terms. Use descriptions like:
    *   "Selfie-style shot of the creator talking to the camera."
    *   "POV (Point-of-View) shot showing hands mixing the drink."
    *   "A quick, top-down shot of the product on a table."
    *   "A shot filmed in the bathroom mirror."
    *   "A close-up of the product label."
*   **CONSISTENCY:** You MUST maintain the appearance of the creator (from the creator image) and the product (from the product image) throughout all scenes. Describe their clothing as simple and casual.

For each line of the script, you will generate THREE items:

**1. Voiceover Guide:** A concise guide for delivery (e.g., "speaking conversationally, like talking to a friend," "with a tone of genuine surprise").

**2. Image Prompt:** A detailed prompt for the scene's **starting frame**. Describe the invented UGC location, the creator's action/pose, the product's placement, and the simple shot type.

**3. Video Motion Prompt:** A concise description of simple, natural movement (e.g., "The creator smiles and nods," "picks up the product bottle," "gives a thumbs-up to the camera").

You will return the response as a single JSON object that strictly adheres to the provided schema. The 'voiceoverScript' field in your output for each scene MUST be the exact line from the input script.`,id=`You are a master copywriter named 'Director AI', specializing in short-form videos for health supplements on platforms like TikTok and Instagram Reels. Your task is to transform product information, a video format, and optional images into a compelling voiceover script based on your analysis of the provided images.

**CONTEXT:**
*   **Product Information:** Key features, benefits, and ingredients of the supplement.
*   **Core Idea:** The central creative concept for the video.
*   **Video Format:** The desired style of the video (e.g., 'Benefit Showcase', 'User Testimonial').

**CRITICAL INSTRUCTION: SCRIPT STRUCTURE**
You MUST create a script with 5-7 short, punchy lines. Each line is a new scene. The script must be tailored to the selected **Video Format** and **Core Idea**.
1.  **Hook (Line 1):** An intriguing question or statement to stop the scroll.
2.  **Problem/Intro (Line 2):** Introduce the problem the supplement solves (e.g., "Feeling tired all the time?").
3.  **Solution/Showcase (Lines 3-4):** Introduce the product and highlight its key benefits or ingredients.
4.  **Social Proof/Outcome (Line 5):** Describe the positive outcome or feeling after using the product.
5.  **Call to Action (Line 6-7):** A clear call to action (e.g., "Click the link to learn more," "Upgrade your health routine").

You will return the response as a single JSON object that strictly adheres to the provided schema. The script should be a single string with each line separated by a newline character ('\\n').`,rd=`You are an expert video director named 'Director AI', specializing in short-form videos for health supplements. Your task is to take a finalized, line-by-line voiceover script and generate a detailed image prompt, a concise video motion prompt, and a voiceover delivery guide for EACH line, based on your analysis of provided reference images.

**CONTEXT:**
*   **Finalized Script:** Each line represents a scene.
*   **Product Info:** Key details about the supplement.
*   **Core Idea:** The central creative theme to guide the visuals.
*   **Video Format:** The overall style of the video.

**CRITICAL INSTRUCTION: CINEMATIC SHOT VARIETY**
You **must** use a variety of shots and **MUST NOT** use the same shot type for two consecutive scenes.
*   **Available Shot Types:** Extreme Wide Shot (EWS), Wide Shot (WS), Full Shot (FS), Medium Shot (MS), Medium Close-Up (MCU), Close-Up (CU), Extreme Close-Up (ECU), Point-of-View (POV).

For each line of the script, you will generate a **Voiceover Guide**, an **Image Prompt**, and a **Video Motion Prompt**.

**1. Voiceover Guide:** A concise description of the desired tone (e.g., 'Confident and informative,' 'Calm and reassuring').
**2. Image Prompt:** A detailed paragraph for the scene's starting frame. Include the product/model, a suitable background (e.g., clean kitchen, gym, office), camera angle, and a clean, healthy, and trustworthy visual style, all guided by the **Core Idea**.
**3. Video Motion Prompt:** A concise action-oriented prompt (e.g., 'The person smiles and holds up the bottle,' 'Camera slowly pans over the ingredients list on the label').

You will return the response as a single JSON object that strictly adheres to the provided schema. The 'voiceoverScript' field in your output for each scene MUST be the exact line from the input script.`,sd=`You are a viral marketing expert for health and wellness brands. Your task is to generate a single, highly creative, and engaging video concept (a "core idea") for a supplement product.

**CONTEXT:**
*   **Product Information:** You'll be given key features, benefits, and ingredients.
*   **Product Image:** You'll be given an image of the product.

**YOUR TASK:**
Based on the provided context, generate ONE scroll-stopping core idea for a short-form video. The idea should be a short, descriptive paragraph. Be creative and think outside the box.

**Example Output:**
"A 'day-in-the-life' transition video. It starts with the character looking tired and sluggish in a dimly lit room. After taking the supplement, they transition into a vibrant, energetic version of themselves, successfully tackling work, a gym session, and social activities, all with a high-energy soundtrack."

Do not return JSON. Return only the single paragraph of text describing the idea.`,ad=`You are a creative podcast writer named 'Director AI'. Your task is to generate a natural, conversational podcast script based on a topic, the number of hosts, and an analysis of the hosts' appearances from provided images.

**CONTEXT:**
*   **Topic:** The central theme of the podcast episode.
*   **Number of Hosts:** 1 or 2.

**CRITICAL INSTRUCTION: SCRIPT STRUCTURE**
*   If there is **1 host**, write a monologue-style script. The host should explore the topic with thoughtful insights.
*   If there are **2 hosts**, write a dialogue-style script. Label the speakers as 'Host 1:' and 'Host 2:'. The conversation should be balanced, with hosts building on each other's points.
*   The script should be broken into 7-10 short paragraphs. Each paragraph will become a scene.
*   The tone should be engaging and informative, as if talking directly to a listener.

You will return the script as a single string. Do not use JSON.`,ld=`You are an expert video director named 'Director AI'. Your task is to take a finalized podcast script and create a visual storyboard based on a detailed analysis of the provided host images.

**CONTEXT:**
*   **Podcast Script:** A full script of the podcast dialogue or monologue.
*   **Host Images:** Images of the host(s).

**CRITICAL INSTRUCTION: STORYBOARD GENERATION**

1.  **CHARACTER ANALYSIS (MANDATORY FIRST STEP):**
    *   Before creating any scenes, you MUST meticulously analyze the provided host images.
    *   Create a short, descriptive alias for each host based on their appearance. For example: "Host 1: a man with glasses and a blue sweater," and "Host 2: a woman with curly red hair."
    *   You MUST use these descriptive aliases in ALL \`imagePrompt\` and \`videoPrompt\` fields for **Studio Shots** to refer to the hosts. DO NOT use the generic terms "Host 1" or "Host 2" in your visual prompts. This is critical for visual consistency.

2.  **SCENE SEGMENTATION:** You MUST break down the provided script into scenes based on complete sentences.
    *   **Primary Rule:** A new scene starts at the end of every sentence (marked by '.', '?', or '!').
    *   **Length Guideline:** Aim for scenes to be between 10 and 20 words. This is a guideline, not a strict rule. Prioritize keeping sentences whole and natural.
    *   **Long Sentences:** If a single sentence is significantly longer than 20 words, you MUST split it at a natural grammatical pause (like after a comma or semicolon) to create multiple, consecutive scenes. Each resulting chunk should still be a coherent thought.
    *   **Short Sentences:** Very short sentences should remain as their own scenes.

3.  **VISUAL VARIETY (CRITICAL):**
    *   **Studio Shots (Approx. 70% of scenes):** The majority of scenes should feature the host(s) in the podcast studio. To keep it visually interesting, you **MUST** vary the camera shots. Use a mix of **Wide Shots** (showing both hosts), **Medium Shots** (waist up on one host), and **Close-Ups** (focusing on a host's face for emphasis). Describe the host's expression based on the script line (e.g., 'speaking passionately', 'listening intently', 'laughing').
    *   **Illustrative B-Roll (Approx. 30% of scenes):** For the most impactful or descriptive lines of the script, you MUST create an "Illustrative" scene. This is a visual metaphor or a literal depiction of what is being discussed. The image prompt for these scenes should be a **completely different, highly-detailed, photorealistic scene** that complements the voiceover. It should NOT include the hosts or the studio.

4.  **IMAGE PROMPT GENERATION:**
    *   **For Studio Shots:** Describe the hosts using the **descriptive aliases you created**, the podcast studio setting (modern, professional microphones, headphones), and the specific camera shot (Wide, Medium, or Close-Up). The prompt must clearly state which host is speaking or reacting based on the script line.
    *   **For Illustrative B-Roll:** Describe a vivid, cinematic scene that visually represents the spoken words. Example: If the script says "It felt like climbing a huge mountain," the prompt should be "A breathtaking, photorealistic wide shot of a lone hiker reaching the snowy summit of a massive mountain against a dramatic sunrise."

5.  **VIDEO MOTION PROMPT GENERATION:**
    *   A concise description of movement. For Studio Shots, use the descriptive aliases you created. **The video prompt MUST focus only on the single person speaking in that scene.** Example: 'The man with glasses gestures with his hands while speaking.' For B-Roll, it could be 'The camera slowly pans across the vast landscape.'

You will return the response as a single JSON object that strictly adheres to the provided schema. The 'voiceoverScript' field in your output for each scene MUST be the exact chunk from the input script you segmented.`,ud={type:M.OBJECT,properties:{musicAndPacing:{type:M.STRING,description:"An overall description of the video's music, sound effects, and editing pace."},sceneBreakdown:{type:M.ARRAY,description:"A detailed breakdown of each scene in the video.",items:{type:M.OBJECT,properties:{scene_id:{type:M.INTEGER,description:"Sequential ID for the scene, starting from 1."},type:{type:M.STRING,description:"The marketing purpose of the scene. Must be one of: problem, product, benefit, proof, social-proof, mechanism, offer, CTA."},time:{type:M.STRING,description:"The estimated start and end time of the scene in 'MM:SS-MM:SS' format."},visual:{type:M.STRING,description:"A detailed description of the visuals in this scene."},speech:{type:M.STRING,description:"A transcript of the voice-over or any on-screen text in this scene. If none, state 'No speech or text'."}},required:["scene_id","type","time","visual","speech"]}}},required:["musicAndPacing","sceneBreakdown"]},cd='You are a professional video ad deconstructor. Your mission is to analyze a sequence of keyframes from a video ad and output a structured breakdown in JSON format.\n\n**Nhiá»‡m vá»¥ (Your tasks):**\n1.  **Tá»± Ä‘á»™ng cáº¯t scene theo timestamp (Automatically cut scenes by timestamp):** Based on the sequence of frames provided, identify distinct scenes. A scene is a continuous shot or a series of closely related shots. Estimate the start and end time for each scene. You are given frames captured at a specific FPS from a video of a certain duration. Use this information to calculate the timestamps accurately.\n2.  **GÃ¡n nhÃ£n scene (Label the scene):** For each scene, assign a label that best describes its marketing purpose. You MUST use one of the following labels: `problem`, `product`, `benefit`, `proof`, `social-proof`, `mechanism`, `offer`, `CTA`.\n3.  **TrÃ­ch xuáº¥t (Extract):**\n    *   **visual description:** For each scene, provide a detailed description of what is happening visually.\n    *   **ká»‹ch báº£n voice-over:** For each scene, transcribe any audible speech or text that appears on screen. If there is no speech or text, state "No speech or text."\n    *   **Ã¢m nháº¡c/nhá»‹p Ä‘á»™:** Provide a single, overall summary of the video\'s music, sound design, and editing rhythm.\n\n**Äáº§u ra (Output):**\nYou MUST return a single JSON object that strictly adheres to the provided schema, representing the scene breakdown table (`scene_id`, `type`, `time`, `visual`, `speech`) and the overall `musicAndPacing`.',dd=`You are an expert scriptwriter for high-converting short-form video ads. Your task is to create a NEW script for a NEW product, but you must strictly follow the structure and pacing of an existing successful ad.

**You will be given:**
1.  **Original Ad Analysis:** A detailed scene-by-scene breakdown of the original ad, including scene types and an overall music/pacing description.
2.  **New Product Information:** Key benefits, features, and details about the new product.
3.  **New Target Audience:** The specific audience for the new ad.
4.  **New Big Idea:** The core message for the new product.
5.  **New Product Image:** An image of the new product you are writing the script for.
6.  **New Character/Reviewer Image (Optional):** An image of the person to feature in the new ad.

**YOUR CRITICAL TASK:**
Write a new voiceover script that:
*   Has the **exact same number of scenes** as the original ad's breakdown.
*   Follows the **same sequence of scene types** (e.g., if the original was \`problem\`, \`product\`, \`benefit\`, your new script should also be written for scenes with that purpose in that order).
*   Is written with a rhythm and line length that matches the original's **musicAndPacing** description.
*   Uses language and a tone appropriate for the **New Target Audience**.
*   Accurately incorporates the **New Product Information** into the script.
*   Communicates the **New Big Idea** for the **New Product**.
*   **If a new character image is provided, ensure the script's tone and persona match the person in the image.**
*   The script should be returned as a single JSON object with a "script" key, with each line representing a new scene.
`,pd=`You are an expert video director specializing in recreating the structure and style of successful ads for new brands. Your task is to generate a detailed storyboard for a new script, using a deep analysis of a competitor's ad as a blueprint.

**You will be provided with:**
1.  **Original Ad's Analysis:** A JSON object containing a scene-by-scene breakdown (\`sceneBreakdown\`) of the original ad. Each scene includes its \`type\` (marketing objective), \`time\` (duration), \`visual\` (description of layout and content), and \`speech\`.
2.  **New Product Information:** Key benefits, features, and details about the new product.
3.  **New Target Audience:** The specific audience for the new ad. This should influence the choice of characters, environments, and overall aesthetic.
4.  **New Script:** The finalized voiceover script for the new product. Each line of this script corresponds to a scene in the original ad's breakdown.
5.  **New Product Image:** An image of the new product to be featured.
6.  **New Character/Reviewer Image (Optional):** An image of the person to feature in the new ad.

**YOUR CRITICAL TASK: STORYBOARD RECREATION**
For each line of the **New Script**, you must generate a **voiceover guide**, an **image prompt**, and a **video motion prompt**. You must meticulously recreate the structure of the original scene while adapting the content for the new brand.

**For each scene, you MUST follow this process:**
1.  **Identify the Blueprint:** Look at the corresponding scene in the **Original Ad's Analysis** (e.g., for the first line of the new script, use \`scene_id: 1\` from the analysis).
2.  **Objective (Má»¥c tiÃªu):** Use the \`type\` (e.g., 'problem', 'benefit') from the original analysis to guide the tone and purpose of your generated prompts.
3.  **Layout & Visual Cue (Bá»‘ cá»¥c & Visual Cue):** Analyze the \`visual\` description from the original scene. Your new \`imagePrompt\` MUST recreate the same **layout, camera angle, and core visual elements**, but replace the original product/subject with the **New Product** (from the new product image) and the character from the **New Character/Reviewer Image** (if provided). If no character image is provided, invent one that fits the **New Target Audience**. The setting should also resonate with the new audience.
4.  **Duration & Pacing (Thá»i lÆ°á»£ng):** Use the \`time\` (e.g., "00:02-00:05") from the original scene to inform the complexity and action in your prompts. A short duration implies a quick, simple shot. Your \`videoPrompt\` should describe an action that fits within this timeframe.
5.  **Key Message (ThÃ´ng Ä‘iá»‡p):** The corresponding line from the **New Script** is your key message. Your prompts must create visuals that directly support and illustrate this new message.

**Example Process for Scene 1:**
- **Original Analysis (Scene 1):** \`type: 'problem'\`, \`time: '00:00-00:03'\`, \`visual: 'A close-up shot of a woman looking tired in a dimly lit office.'\`
- **New Script (Line 1):** "Can't focus on your work?"
- **Your Task:** Generate prompts for a **close-up shot** of a **new character** (who fits the new target audience) who looks **tired** in an **office setting**. The scene should feel like it's about a 'problem' and last about 3 seconds. The visuals must clearly convey "Can't focus on your work?". The new product should not be visible yet, just like the original problem-focused scene.

You will return a JSON object that strictly adheres to the provided schema. The \`voiceoverScript\` in your output MUST be the exact line from the new input script.`,fd=`You are an expert director for short-form explainer videos. Your task is to take a full script and a global visual style, and break the script down into a highly granular storyboard where each scene corresponds to only 2-3 seconds of narration.

**CRITICAL INSTRUCTIONS:**

1.  **SEGMENTATION:** You MUST break the provided script into very small, consecutive chunks. Each chunk will be the 'voiceoverScript' for a new scene. A good rule of thumb is 10-15 words per chunk, representing about 2-3 seconds of speech.

2.  **VISUAL STYLE ADHERENCE:** You will be given a [Global Visual Style]. Every single 'imagePrompt' and 'videoPrompt' you generate MUST strictly adhere to this style. For example, if the style is "Claymation", every prompt must describe a scene that looks like it's made of clay.

3.  **ILLUSTRATIVE B-ROLL:** Every scene MUST be an illustrative B-roll shot. This means you should generate a visual metaphor or a literal depiction of what is being discussed in that tiny script chunk. DO NOT show a person talking to the camera.

4.  **PROMPT GENERATION:** For each script chunk, you MUST generate:
    *   **voiceoverScript:** The exact 2-3 second script chunk.
    *   **voiceoverGuide:** A concise guide for delivery (e.g., "clear and informative," "upbeat and engaging").
    *   **imagePrompt:** A detailed prompt for the scene's starting frame, adhering to the [Global Visual Style].
    *   **videoPrompt:** A concise description of simple movement within the scene (e.g., "A line draws itself connecting two points," "The camera slowly pushes in on the main object"), also adhering to the [Global Visual Style].

You will return the response as a single JSON object that strictly adheres to the provided schema, containing a long array of these short scenes.`,hd=`You are a TV producer specializing in engaging "man on the street" style interviews. Your task is to generate a natural, conversational script between a 'Reporter' and an 'Interviewee' based on a given topic and images of the two individuals.

**CONTEXT:**
*   **Topic:** The central theme of the interview.
*   **Images:** You will receive one image of the Reporter and one of the Interviewee. You MUST analyze their appearance and vibe to inform their personality in the script.

**CRITICAL INSTRUCTIONS:**
1.  **Dialogue Format:** You MUST format the script as a dialogue. Every line of speech must start with either "Reporter:" or "Interviewee:".
2.  **Conversational Flow:** The conversation should be a natural back-and-forth. The Reporter should ask insightful questions, and the Interviewee should provide interesting, personal-sounding answers.
3.  **Structure:**
    *   **Introduction (1-2 lines):** The Reporter introduces the topic.
    *   **Core Questions (4-6 lines):** The Reporter asks questions, and the Interviewee responds.
    *   **Conclusion (1 line):** The Reporter thanks the Interviewee or provides a concluding thought.
4.  **Tone:** The tone should be casual, authentic, and engaging, suitable for a social media video.

You will return the script as a single string of plain text. Do not use JSON.`,Bo={type:M.OBJECT,properties:{reporterDescription:{type:M.STRING,description:"A short, descriptive alias for the reporter based on their appearance from the reference image."},intervieweeDescription:{type:M.STRING,description:"A short, descriptive alias for the interviewee based on their appearance from the reference image. If no interviewee image is provided, this can be a generic description."},scenes:ct},required:["reporterDescription","intervieweeDescription","scenes"]},md={type:M.OBJECT,properties:{reporterDescription:{type:M.STRING,description:"A short, descriptive alias for the reporter based on their appearance from the reference image."},intervieweeDescription:{type:M.STRING,description:"A short, descriptive alias for the interviewee based on their appearance from the reference image."},script:{type:M.STRING,description:"The full, generated interview script, with each line starting with 'Reporter:' or 'Interviewee:' and separated by a newline character."},scenes:ct},required:["reporterDescription","intervieweeDescription","script","scenes"]},gd=`You are an expert video director creating a storyboard for a "man on the street" interview. Your task is to take a finalized interview script and generate visual prompts for each line, based on a detailed analysis of the provided Reporter and Interviewee images.

**CONTEXT:**
*   **Finalized Script:** Each line starts with "Reporter:" or "Interviewee:".
*   **Reference Images:** An image of the Reporter (first image) and an image of the Interviewee (second image). You MUST use these images for your analysis.

**CRITICAL INSTRUCTIONS:**

1.  **CHARACTER ANALYSIS (MANDATORY FIRST STEP):**
    *   Before creating any scenes, you MUST meticulously analyze the provided images.
    *   Create a short, descriptive alias for each person based on their appearance. For example: "Reporter: a woman with short brown hair wearing a red jacket," and "Interviewee: a tall man with a beard wearing a blue shirt."
    *   You MUST use these descriptive aliases in ALL subsequent \`imagePrompt\` and \`videoPrompt\` fields to refer to the characters. DO NOT use the generic terms "Reporter" or "Interviewee" in your visual prompts. This is critical for visual consistency.

2.  **SCENE SEGMENTATION:** You MUST break down the provided script into scenes based on complete sentences and speaker changes.
    *   **Primary Rule:** A new scene starts at the end of every sentence (marked by '.', '?', or '!').
    *   **Length Guideline:** Aim for scenes to be between 10 and 20 words. This is a guideline, not a strict rule. Prioritize keeping sentences whole and natural.
    *   **Long Sentences:** If a single sentence of dialogue is significantly longer than 20 words, you MUST split it at a natural grammatical pause (like after a comma) to create multiple, consecutive scenes.
    *   **Speaker Prefix:** When you split a line, you MUST ensure each new scene's 'voiceoverScript' retains the original speaker prefix (e.g., "Reporter:").

3.  **VISUAL VARIETY:** To make the interview dynamic, you MUST vary the shots. Use a mix of:
    *   **Medium Shot (MS):** A shot of the person speaking, from the waist up.
    *   **Close-Up (CU):** A tight shot of the person's face as they speak for emphasis.
    *   **Over-the-Shoulder (OTS):** A shot from behind one person, looking at the other person speaking.
    *   **Two-Shot (WS):** A wide shot showing both the Reporter and Interviewee interacting.
    *   **Illustrative B-Roll:** For some of the Interviewee's answers, create a visual metaphor or a literal depiction of what they are describing. This shot should NOT include the Reporter or Interviewee.

4.  **IMAGE PROMPT GENERATION:**
    *   **Background:** All shots of the Reporter and Interviewee MUST take place in a plausible, consistent outdoor public setting, like a bustling city street, a park, or a plaza. The reporter MUST be holding a microphone.
    *   **Character Consistency:** The people in the prompts MUST be described using the descriptive aliases you created in the Character Analysis step.
    *   **Action:** The image prompt should describe the starting frame of the shot, including the character's expression (e.g., 'listening intently', 'smiling', 'looking thoughtful').

5.  **VIDEO MOTION PROMPT GENERATION:**
    *   Describe a simple, natural action. **The video prompt MUST focus only on the actions of the single person who is speaking in that scene.** Do not describe the other person's reaction. Examples: 'The Interviewee gestures with their hands as they explain,' or 'The camera slowly pushes in for emphasis on the Reporter as they ask a question.'

You will return the response as a single JSON object that strictly adheres to the provided schema. This object MUST contain 'reporterDescription', 'intervieweeDescription', and the 'scenes' array. The 'voiceoverScript' field in your output for each scene MUST be the exact line from the input script, including the "Reporter:" or "Interviewee:" prefix.`,yd=`You are an expert video director creating a storyboard for a "man on the street" interview. Your task is to take a finalized interview script and generate visual prompts for each line, based on a detailed analysis of a single provided MASTER SHOT image which contains the reporter, interviewee, and background.

**CONTEXT:**
*   **Finalized Script:** Each line starts with "Reporter:" or "Interviewee:".
*   **Master Shot Image:** A single image containing both characters and the background scene.

**CRITICAL INSTRUCTIONS:**

1.  **CHARACTER & SCENE ANALYSIS (MANDATORY FIRST STEP):**
    *   Before creating any scenes, you MUST meticulously analyze the provided single master shot image to identify the two speakers (Reporter and Interviewee) and the background environment.
    *   Create a short, descriptive alias for each person based on their appearance. For example: "Reporter: a woman with short brown hair wearing a red jacket," and "Interviewee: a tall man with a beard wearing a blue shirt."
    *   You MUST use these descriptive aliases in ALL subsequent \`imagePrompt\` and \`videoPrompt\` fields to refer to the characters.

2.  **SCENE SEGMENTATION:** You MUST break down the provided script into scenes based on complete sentences and speaker changes.
    *   A new scene starts at the end of every sentence (marked by '.', '?', or '!').
    *   If a single sentence of dialogue is significantly longer than 20 words, you MUST split it at a natural grammatical pause.
    *   Each new scene's 'voiceoverScript' MUST retain the original speaker prefix (e.g., "Reporter:").

3.  **VISUAL VARIETY:** To make the interview dynamic, you MUST generate different shots based on the master shot. You will essentially be 'directing' a virtual camera within this scene. Use a mix of:
    *   **Medium Shot (MS):** A shot of the person speaking, from the waist up.
    *   **Close-Up (CU):** A tight shot of the person's face as they speak for emphasis.
    *   **Over-the-Shoulder (OTS):** A shot from behind one person, looking at the other person speaking.
    *   **Two-Shot (WS):** A wide shot showing both the Reporter and Interviewee interacting, similar to the master shot.
    *   **Illustrative B-Roll:** For some of the Interviewee's answers, create a visual metaphor. This shot should NOT include the characters from the master shot.

4.  **IMAGE PROMPT GENERATION:**
    *   **Background:** All interview shots MUST take place in the exact environment from the master shot. The reporter MUST be holding a microphone.
    *   **Character Consistency:** The people in the prompts MUST be described using the descriptive aliases you created.
    *   **Action:** The image prompt should describe the starting frame of the shot, including the character's expression (e.g., 'listening intently', 'smiling').

5.  **VIDEO MOTION PROMPT GENERATION:**
    *   Describe a simple, natural action. The video prompt MUST focus only on the actions of the single person who is speaking in that scene. Do not describe the other person's reaction. Examples: 'The Interviewee gestures with their hands as they explain,' or 'The camera slowly pushes in for emphasis on the Reporter as they ask a question.'

You will return the response as a single JSON object that strictly adheres to the provided schema. This object MUST contain 'reporterDescription', 'intervieweeDescription', and the 'scenes' array. The 'voiceoverScript' field in your output for each scene MUST be the exact line from the input script, including the "Reporter:" or "Interviewee:" prefix.`,vd=`You are an expert TV producer and video director. Your task is to perform a complete creative process in one step: analyze characters from a single image, write a script based on a topic, and then create a detailed storyboard for that script.

**CONTEXT:**
*   **Topic:** The central theme of the interview.
*   **Master Shot Image:** A single image containing both the Reporter and Interviewee in their interview setting.

**CRITICAL INSTRUCTIONS (MUST be followed in order):**

1.  **CHARACTER & SCENE ANALYSIS (MANDATORY FIRST STEP):**
    *   Meticulously analyze the provided single master shot image to identify the two speakers and the background environment.
    *   Create a short, descriptive alias for each person. For example: "Reporter: a woman with short brown hair wearing a red jacket," and "Interviewee: a tall man with a beard wearing a blue shirt." These will be your \`reporterDescription\` and \`intervieweeDescription\`.

2.  **SCRIPT GENERATION:**
    *   Based on the provided **Topic** and your character analysis, write a natural, conversational script between the 'Reporter' and 'Interviewee'.
    *   The script MUST be formatted as a dialogue. Every line must start with either "Reporter:" or "Interviewee:".
    *   The script should have a clear structure: introduction (1-2 lines), core questions (4-6 lines), and a conclusion (1 line).
    *   This entire generated script will be the value for the \`script\` field in your JSON output.

3.  **STORYBOARD CREATION (using the script you just wrote):**
    *   **SCENE SEGMENTATION:** Break down the script you just generated into scenes. A new scene starts at the end of every sentence.
    *   **VISUAL VARIETY:** Generate different shots based *only* on the master shot image. You are 'directing' a virtual camera. Use a mix of: Medium Shot (MS), Close-Up (CU), Over-the-Shoulder (OTS), and Two-Shot (WS).
    *   **IMAGE PROMPTS:** For each scene, write an \`imagePrompt\`. The prompt must describe the shot type, the character(s) (using the descriptive aliases you created), their expression, and the background (which is always the one from the master shot). The reporter MUST be holding a microphone.
    *   **VIDEO MOTION PROMPTS:** For each scene, write a \`videoPrompt\` describing a simple, natural action, focusing only on the person who is speaking.

You will return the response as a single JSON object that strictly adheres to the provided schema. This object MUST contain 'reporterDescription', 'intervieweeDescription', the generated 'script', and the 'scenes' array. The 'voiceoverScript' field for each scene MUST be the exact line from the script you generated.`,k=()=>{const t=Ie.getGeminiApiKey();if(!t)throw new Error("Gemini API Key not found. Please configure it in the Settings module.");return new td({apiKey:t})},Z=t=>({voiceoverScript:t.voiceoverScript||"",voiceoverGuide:t.voiceoverGuide||"",imagePrompt:t.imagePrompt||"",videoPrompt:t.videoPrompt||"",id:crypto.randomUUID(),images:[],isGeneratingImage:!1,imageGenerationError:null,isGeneratingImagePrompt:!1,isGeneratingVideoPrompt:!1,selectedImageForVideo:void 0,videos:[],isGeneratingVideo:!1,videoGenerationError:null,shouldUpscaleVideo:!1,imageFocusObject:"",imageCameraAngle:"",videoCameraMovement:"Static",videoShootingEffect:"",isGeneratingAudio:!1,audioUrl:void 0,audioGenerationError:null,includeDialogueInPrompt:t.includeDialogueInPrompt!==!1}),Td=`You are an expert creative director and prompt engineer for an AI image and video generation platform. Your task is to take a simple scene description and expand it into a detailed, professional-grade prompt suitable for a generative AI model.

You will be given the following context:
- **Project-Level Context:** Overall information about the video (e.g., product, theme, visual style, target audience).
- **Scene-Level Context:** The specific voiceover script for this scene and any existing simple prompt ideas.
- **Prompt Type:** Whether you need to generate an 'Image Prompt' (for a static starting frame) or a 'Video Motion Prompt' (for the action within the scene).
- **Character/Product Analysis:** Descriptions based on provided images.

**YOUR CRITICAL TASK:**

**If 'Prompt Type' is 'Image Prompt':**
- Generate a rich, descriptive paragraph.
- Describe the composition, camera angle, lighting, colors, and mood in detail.
- Incorporate the project-level visual style and context.
- Based on the Character/Product Analysis, describe any characters (their appearance, clothing, expression) and how they interact with the product or environment.
- Ensure the visual you describe directly supports the scene's voiceover script.

**If 'Prompt Type' is 'Video Motion Prompt':**
- Generate a concise, action-oriented description of movement.
- Describe camera movement (e.g., "slow dolly in," "pan left") and/or subject movement (e.g., "the character smiles and picks up the bottle").
- The motion should be simple and fit within a short scene (2-4 seconds).
- The action must relate directly to the voiceover script and the starting image prompt.

**RULES:**
- You MUST only return a single string containing the generated prompt.
- DO NOT return JSON or any other formatting. Just the raw text of the prompt itself.`,_d=async(t,e,n,o,i)=>{const a=k();try{const u=[{text:`**Project-Level Context:**
${t}

**Scene-Level Context:**
- Voiceover Script: "${e.voiceoverScript}"
- Existing Image Prompt Idea: "${e.imagePrompt}"
- Existing Video Prompt Idea: "${e.videoPrompt}"

**Your Task:** Generate an enhanced **${n==="image"?"Image Prompt":"Video Motion Prompt"}** for this scene.
`}];return o&&u.push({inlineData:{mimeType:"image/jpeg",data:o.split(",")[1]}}),i&&u.push({inlineData:{mimeType:"image/jpeg",data:i.split(",")[1]}}),(await a.models.generateContent({model:"gemini-2.5-flash",contents:{parts:u},config:{systemInstruction:Td,temperature:.7}})).text.trim()}catch(l){throw console.error(`Error generating enhanced ${n} prompt:`,l),new Error(`Failed to generate a suggestion for the ${n} prompt.`)}},Ad=async(t,e,n,o,i,a,l,u)=>{const d=k();try{let c=`Video Angle/Core Idea: ${t}
Call to Action: ${o}`;a&&(c+=`
Product Info & Key Benefits: ${a}`),l&&(c+=`
Target Audience: ${l}`);const p=nd+`

**Output Language:** You MUST generate the script strictly in **${n}**.`,f=[{text:c}];f.push({inlineData:{mimeType:"image/jpeg",data:i.split(",")[1]}}),u&&f.push({inlineData:{mimeType:"image/jpeg",data:u.split(",")[1]}});const m=(await d.models.generateContent({model:"gemini-2.5-flash",contents:{parts:f},config:{systemInstruction:p,responseMimeType:"application/json",responseSchema:dt,temperature:.8,topP:.95}})).text.trim(),g=JSON.parse(m);if(g&&typeof g.script=="string")return g.script;throw new Error("Invalid response format from script generation API.")}catch(c){throw console.error("Error generating voiceover script:",c),new Error("Failed to generate voiceover script. Please check your input or API key and try again.")}},wd=async(t,e,n,o,i,a,l)=>{const u=k();try{const d=`**Finalized Voiceover Script:**
${t}

**Video Angle/Core Idea:** ${e}`;let c=od+`

**Output Language:** You MUST generate all prompts strictly in **${o}**.`;const p=[{text:d}];p.push({inlineData:{mimeType:"image/jpeg",data:i.split(",")[1]}}),l&&p.push({inlineData:{mimeType:"image/jpeg",data:l.split(",")[1]}});const h=(await u.models.generateContent({model:"gemini-2.5-flash",contents:{parts:p},config:{systemInstruction:c,responseMimeType:"application/json",responseSchema:fe}})).text.trim(),m=JSON.parse(h);if(m&&Array.isArray(m.scenes))return m.scenes.map(Z);throw new Error("Invalid response format from prompts generation API.")}catch(d){throw console.error("Error generating prompts from script:",d),new Error("Failed to generate scene prompts. Please check your script or API key and try again.")}},Rd=async(t,e,n,o)=>{var a,l,u,d,c,p;const i=k();try{let f=t;e&&(f=`(${e}) ${t}`),o&&(f=`[Overall tone: ${o}] ${f}`);const m=(p=(c=(d=(u=(l=(a=(await i.models.generateContent({model:"gemini-2.5-flash-preview-tts",contents:[{parts:[{text:f}]}],config:{responseModalities:[ee.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}}}})).candidates)==null?void 0:a[0])==null?void 0:l.content)==null?void 0:u.parts)==null?void 0:d[0])==null?void 0:c.inlineData)==null?void 0:p.data;if(!m)throw new Error("Audio data not found in API response.");return m}catch(f){throw console.error("Error generating speech for scene:",f),new Error("Failed to generate speech for scene.")}},Pd=async(t,e,n,o,i,a)=>{const l=k();try{const d=[{text:`Product Information: ${t}
Core Idea: ${e}
Video Format: ${n}`}];d.push({inlineData:{mimeType:"image/jpeg",data:o.split(",")[1]}}),i&&d.push({inlineData:{mimeType:"image/jpeg",data:i.split(",")[1]}}),a&&d.push({inlineData:{mimeType:"image/jpeg",data:a.split(",")[1]}});const p=(await l.models.generateContent({model:"gemini-2.5-flash",contents:{parts:d},config:{systemInstruction:id,responseMimeType:"application/json",responseSchema:dt}})).text.trim(),f=JSON.parse(p);if(f!=null&&f.script)return f.script;throw new Error("Invalid script format received.")}catch(u){throw console.error("Error in generateVoiceoverScriptForSupplements:",u),new Error("Failed to generate voiceover script for supplements.")}},Md=async(t,e,n,o,i,a,l)=>{const u=k();try{const c=[{text:`Finalized Script:
${t}

Product Info: ${e}
Core Idea: ${n}
Video Format: ${o}`}];c.push({inlineData:{mimeType:"image/jpeg",data:i.split(",")[1]}}),a&&c.push({inlineData:{mimeType:"image/jpeg",data:a.split(",")[1]}}),l&&c.push({inlineData:{mimeType:"image/jpeg",data:l.split(",")[1]}});const f=(await u.models.generateContent({model:"gemini-2.5-flash",contents:{parts:c},config:{systemInstruction:rd,responseMimeType:"application/json",responseSchema:fe}})).text.trim(),h=JSON.parse(f);if(h!=null&&h.scenes)return h.scenes.map(Z);throw new Error("Invalid storyboard format received.")}catch(d){throw console.error("Error in generatePromptsFromScriptForSupplements:",d),new Error("Failed to generate storyboard prompts for supplements.")}},Nd=async(t,e)=>{const n=k();try{const i=[{text:`Product Information: ${t}`},{inlineData:{mimeType:"image/jpeg",data:e.split(",")[1]}}];return(await n.models.generateContent({model:"gemini-2.5-flash",contents:{parts:i},config:{systemInstruction:sd}})).text.trim()}catch(o){throw console.error("Error generating random core idea:",o),new Error("Failed to generate a random core idea.")}},xd=async(t,e,n)=>{const o=k();try{const a=[{text:`Topic: ${t}
Number of Hosts: ${e}`}];return n.forEach(u=>{a.push({inlineData:{mimeType:"image/jpeg",data:u.split(",")[1]}})}),(await o.models.generateContent({model:"gemini-2.5-flash",contents:{parts:a},config:{systemInstruction:ad}})).text.trim()}catch(i){throw console.error("Error generating podcast script:",i),new Error("Failed to generate podcast script.")}},Dd=async(t,e,n)=>{const o=k();try{let i=ld;n==="stage"&&(i=i.replace(/podcast studio/g,"stage for a presentation"));const l=[{text:`Podcast Script:
${t}`}];e.forEach(p=>{l.push({inlineData:{mimeType:"image/jpeg",data:p.split(",")[1]}})});const d=(await o.models.generateContent({model:"gemini-2.5-pro",contents:{parts:l},config:{systemInstruction:i,responseMimeType:"application/json",responseSchema:fe}})).text.trim(),c=JSON.parse(d);if(c!=null&&c.scenes)return c.scenes.map(Z);throw new Error("Invalid storyboard format from podcast analysis.")}catch(i){throw console.error("Error analyzing podcast script:",i),new Error("Failed to analyze podcast script and generate scenes.")}},kd=async(t,e,n)=>{const o=k();try{const i=[{text:`Analyze these ${t.length} frames from a ${n.toFixed(1)}-second video, captured at ${e} FPS.`}];t.forEach(u=>{i.push({inlineData:{mimeType:"image/jpeg",data:u.split(",")[1]}})});const l=(await o.models.generateContent({model:"gemini-2.5-pro",contents:{parts:i},config:{systemInstruction:cd,responseMimeType:"application/json",responseSchema:ud}})).text.trim();return JSON.parse(l)}catch(i){throw console.error("Error analyzing video frames:",i),new Error("Failed to analyze video frames.")}},Ud=async(t,e,n,o,i,a)=>{const l=k();try{const d=[{text:`**Original Ad Analysis:**
${JSON.stringify(t,null,2)}

**New Big Idea:** ${e}
**New Product Info:** ${o||"Not provided."}
**New Target Audience:** ${i||"Not provided."}`},{inlineData:{mimeType:"image/jpeg",data:n.split(",")[1]}}];a&&d.push({inlineData:{mimeType:"image/jpeg",data:a.split(",")[1]}});const p=(await l.models.generateContent({model:"gemini-2.5-flash",contents:{parts:d},config:{systemInstruction:dd,responseMimeType:"application/json",responseSchema:dt}})).text.trim(),f=JSON.parse(p);if(f!=null&&f.script)return f.script;throw new Error("Invalid script format from cloned script generation.")}catch(u){throw console.error("Error generating cloned script:",u),new Error("Failed to generate cloned script.")}},Ld=async(t,e,n,o,i,a)=>{const l=k();try{const d=[{text:`**Original Ad Analysis:**
${JSON.stringify(t,null,2)}

**New Script:**
${e}

**New Product Info:** ${o||"Not provided."}
**New Target Audience:** ${i||"Not provided."}`},{inlineData:{mimeType:"image/jpeg",data:n.split(",")[1]}}];a&&d.push({inlineData:{mimeType:"image/jpeg",data:a.split(",")[1]}});const p=(await l.models.generateContent({model:"gemini-2.5-pro",contents:{parts:d},config:{systemInstruction:pd,responseMimeType:"application/json",responseSchema:fe}})).text.trim(),f=JSON.parse(p);if(f!=null&&f.scenes)return f.scenes.map(Z);throw new Error("Invalid storyboard format from cloned storyboard generation.")}catch(u){throw console.error("Error generating cloned storyboard:",u),new Error("Failed to generate cloned storyboard.")}},Fd=async(t,e)=>{const n=k(),i=[{text:`Based on the following product information and image, describe the ideal target audience for this product in a short, concise sentence.

Product Info: ${t}`},{inlineData:{mimeType:"image/jpeg",data:e.split(",")[1]}}];return(await n.models.generateContent({model:"gemini-2.5-flash",contents:{parts:i}})).text.trim()},bd=async(t,e)=>{const n=k(),i=[{text:`Based on the following product information and image, create a single, powerful "Big Idea" or "Key Message" for an ad campaign. It should be one sentence.

Product Info: ${t}`},{inlineData:{mimeType:"image/jpeg",data:e.split(",")[1]}}];return(await n.models.generateContent({model:"gemini-2.5-flash",contents:{parts:i}})).text.trim()},Gd=async(t,e)=>{const n=k();try{const o=`**Full Script/Topic:**
${t}

**Global Visual Style:** ${e}`,a=(await n.models.generateContent({model:"gemini-2.5-pro",contents:{parts:[{text:o}]},config:{systemInstruction:fd,responseMimeType:"application/json",responseSchema:fe}})).text.trim(),l=JSON.parse(a);if(l!=null&&l.scenes)return l.scenes.map(Z);throw new Error("Invalid storyboard format from explainer storyboard generation.")}catch(o){throw console.error("Error generating explainer storyboard:",o),new Error("Failed to generate explainer storyboard.")}},je=t=>{var i;const[e,n]=t.split(",");if(!e||!n)throw new Error("Invalid Data URL format");const o=(i=e.split(":")[1])==null?void 0:i.split(";")[0];if(!o)throw new Error("Could not determine MIME type from Data URL");return{inlineData:{mimeType:o,data:n}}},Vd=async(t,e,n,o,i,a)=>{if(!t)throw new Error("A primary reference image (reporter for two-shot, interviewee for single-shot) must be provided.");const l=k(),u=[];u.push(je(t));let d="one person (the interviewee)";i==="two-shot"&&(d=e?"two people (a reporter and an interviewee)":"one person (the reporter)",e&&u.push(je(e)));const c=`Generate a single, unique, photorealistic background scene for a street interview.

Background description: "${n}".
**CRITICAL INSTRUCTION:** The reporter MUST be holding a microphone.
The scene must have a strict ${a} aspect ratio. It should be composed to feature ${d}. Use the provided image(s) as a reference for the character(s)' appearance. The background should be the main focus, with the characters placed naturally within it. Each generation should produce a slightly different composition or angle.`,p=[...u,{text:c}],f=async()=>{const g=await l.models.generateContent({model:"gemini-2.5-flash-image",contents:{parts:p},config:{responseModalities:[ee.IMAGE],imageConfig:{aspectRatio:a}}});for(const v of g.candidates[0].content.parts)if(v.inlineData)return`data:${v.inlineData.mimeType};base64,${v.inlineData.data}`;throw new Error("API did not return any image data in a chunk.")},h=Array(o).fill(null).map(()=>f()),m=await Promise.all(h);if(m.length===0)throw new Error("API did not return any images.");return m},qd=async(t,e,n)=>{const o=k();try{const a=[{text:`Topic: ${t}`},{inlineData:{mimeType:"image/jpeg",data:e.split(",")[1]}},{inlineData:{mimeType:"image/jpeg",data:n.split(",")[1]}}];return(await o.models.generateContent({model:"gemini-2.5-flash",contents:{parts:a},config:{systemInstruction:hd}})).text.trim()}catch(i){throw console.error("Error generating street interview script:",i),new Error("Failed to generate street interview script.")}},Hd=async(t,e,n,o)=>{const i=k();try{const l=[{text:`**Finalized Script:**
${t}`},{inlineData:{mimeType:"image/jpeg",data:e.split(",")[1]}}];n&&l.push({inlineData:{mimeType:"image/jpeg",data:n.split(",")[1]}}),l.push({inlineData:{mimeType:"image/jpeg",data:o.split(",")[1]}});const d=(await i.models.generateContent({model:"gemini-2.5-pro",contents:{parts:l},config:{systemInstruction:gd,responseMimeType:"application/json",responseSchema:Bo}})).text.trim(),c=JSON.parse(d);if(c!=null&&c.scenes&&c.reporterDescription&&c.intervieweeDescription)return{scenes:c.scenes.map(Z),reporterDescription:c.reporterDescription,intervieweeDescription:c.intervieweeDescription};throw new Error("Invalid storyboard format from street interview analysis.")}catch(a){throw console.error("Error analyzing street interview script:",a),new Error("Failed to analyze script and generate scenes.")}},Bd=async(t,e)=>{const n=k();try{const i=[{text:`**Finalized Script:**
${t}`},{inlineData:{mimeType:"image/jpeg",data:e.split(",")[1]}}],l=(await n.models.generateContent({model:"gemini-2.5-pro",contents:{parts:i},config:{systemInstruction:yd,responseMimeType:"application/json",responseSchema:Bo}})).text.trim(),u=JSON.parse(l);if(u!=null&&u.scenes&&u.reporterDescription&&u.intervieweeDescription)return{scenes:u.scenes.map(Z),reporterDescription:u.reporterDescription,intervieweeDescription:u.intervieweeDescription};throw new Error("Invalid storyboard format from street interview master shot analysis.")}catch(o){throw console.error("Error analyzing street interview master shot:",o),new Error("Failed to analyze master shot and generate scenes.")}},Jd=async(t,e)=>{const n=k();try{const i=[{text:`**Topic:**
${t}`},{inlineData:{mimeType:"image/jpeg",data:e.split(",")[1]}}],l=(await n.models.generateContent({model:"gemini-2.5-pro",contents:{parts:i},config:{systemInstruction:vd,responseMimeType:"application/json",responseSchema:md}})).text.trim(),u=JSON.parse(l);if(u!=null&&u.scenes&&u.reporterDescription&&u.intervieweeDescription&&u.script)return{script:u.script,scenes:u.scenes.map(Z),reporterDescription:u.reporterDescription,intervieweeDescription:u.intervieweeDescription};throw new Error("Invalid format from script and storyboard master shot analysis.")}catch(o){throw console.error("Error analyzing master shot and generating script/storyboard:",o),new Error("Failed to analyze master shot and generate script/storyboard.")}},$d=async(t,e,n,o,i)=>{const a=k(),l=t.map(g=>je(g)),u=t.length,d=o==="stage"?"on a modern, well-lit stage for a presentation or talk. It could be a TED-style stage.":"in a modern, professional podcast studio with microphones.",c=`Generate a single, unique camera angle of a scene featuring ${u} ${u>1?"people":"person"} ${d}.

The scene description is: "${e}".

Use the provided reference image(s) for the appearance of the person/people. The final image must have a strict ${i} aspect ratio. The shot should be a varied angle, like a wide shot, medium shot, or over-the-shoulder angle. Each generation should produce a different angle.`,p=[...l,{text:c}],f=async()=>{const g=await a.models.generateContent({model:"gemini-2.5-flash-image",contents:{parts:p},config:{responseModalities:[ee.IMAGE],imageConfig:{aspectRatio:i}}});for(const v of g.candidates[0].content.parts)if(v.inlineData)return`data:${v.inlineData.mimeType};base64,${v.inlineData.data}`;throw new Error("API did not return any image data in a chunk.")},h=Array(n).fill(null).map(()=>f()),m=await Promise.all(h);if(m.length===0)throw new Error("API did not return any images.");return m},ae="https://oldapi84.vidtory.net",Ed=t=>{var i;const[e,n]=t.split(",");if(!e||!n)throw new Error("Invalid Data URL format");const o=(i=e.split(":")[1])==null?void 0:i.split(";")[0];if(!o)throw new Error("Could not determine MIME type from Data URL");return{base64:n,mimeType:o}},Jo=async(t,e,n,o,i=5e3,a=3e5)=>{var d,c,p;const l=Date.now();let u="";for(e==="image"?u=`${ae}/api/image/${n==="nano1"?"nano":n}/jobs/${t}`:u=`${ae}/api/video/jobs/${t}`;Date.now()-l<a;){try{const f=await fetch(u,{headers:{"X-API-Key":o}});if(!f.ok){if(f.status===404)throw new Error("Job not found or expired.");console.warn(`Polling failed with status ${f.status}. Retrying...`),await new Promise(m=>setTimeout(m,i));continue}const h=await f.json();if(e==="image"){if(h.status==="done"){const m=h.result||h;if(m.outputs&&m.outputs.length>0)return m.outputs;if(h.outputs)return h.outputs;throw new Error("Job completed but no outputs found.")}}else if(h.status==="COMPLETE"||h.status==="PROCESSING"&&((d=h.payload)==null?void 0:d.ready)===!0){if(((c=h.payload)==null?void 0:c.ready)===!0)return h.payload}else if(h.status==="FAILED")throw new Error(`Video job failed: ${((p=h.error)==null?void 0:p.message)||"Unknown error"}`)}catch(f){if(f instanceof Error&&(f.message.includes("Job not found")||f.message.includes("Video job failed")))throw f;console.error("Transient polling error:",f)}await new Promise(f=>setTimeout(f,i))}throw new Error("Processing timed out.")},Yd=async({prompt:t,aspectRatio:e,subjectUrls:n=[],styleUrl:o,sceneUrl:i,referenceUrls:a=[],model:l})=>{const u=Ie.getBrianApiKey();if(!u)throw new Error("Vidtory API Key not found. Please configure it in the Settings module.");const d=l||Ie.getDefaultImageModel();let c="",p={};if(d==="classic"){c=`${ae}/api/image/generate`;const f=v=>({dataUrl:v}),h=[...n,...a].map(f),m=o?[f(o)]:[],g=i?[f(i)]:[];p={prompt:t,cleanup:!0,aspectRatio:e},h.length>0&&(p.subjects=h),m.length>0&&(p.styles=m),g.length>0&&(p.scenes=g)}else{c=d==="nano1"?`${ae}/api/image/nano`:`${ae}/api/image/nano2`;const f=[{text:t}];[...n,...o?[o]:[],...i?[i]:[],...a].forEach(m=>{const{base64:g,mimeType:v}=Ed(m);f.push({inline_data:{mime_type:v,data:g}})}),p={contents:[{parts:f}],generationConfig:{imageConfig:{aspectRatio:e}},cleanup:!0}}try{const f=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":u},body:JSON.stringify(p)});if(!f.ok){const m=await f.text();throw new Error(`API request failed (${f.status}): ${m}`)}const h=await f.json();if(d==="classic"){if(h.urls&&Array.isArray(h.urls))return h.urls;throw new Error("Classic API did not return URLs.")}if(h.status==="pending"||h.jobId)return(await Jo(h.jobId,"image",d,u,h.pollIntervalMs||5e3)).map(g=>g.url);if(h.status==="done"&&h.outputs)return h.outputs.map(m=>m.url);if(h.result&&h.result.outputs)return h.result.outputs.map(m=>m.url);throw new Error("Unexpected API response format.")}catch(f){throw console.error(`Error generating image with ${d}:`,f),f}},Od=async({prompt:t,startImageUrl:e,aspectRatio:n})=>{var l;const o=Ie.getBrianApiKey();if(!o)throw new Error("Vidtory API Key not found.");const a={prompt:t,generationMode:"START_ONLY",startImage:{dataUrl:e},aspectRatio:n==="16:9"?"VIDEO_ASPECT_RATIO_LANDSCAPE":"VIDEO_ASPECT_RATIO_PORTRAIT",cleanup:!0};try{const u=await fetch(`${ae}/api/video/generate`,{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":o},body:JSON.stringify(a)});if(!u.ok){const f=await u.text();throw new Error(`Video API request failed (${u.status}): ${f}`)}const d=await u.json();if(!d.jobId)throw new Error("No Job ID received from Video API.");const c=await Jo(d.jobId,"video","",o,d.pollIntervalMs||1e4,9e5);return{videoUrl:((l=c.video)==null?void 0:l.url)||c.url,upscaledUrl:void 0,mediaGenerationId:c.jobId,seed:c.seed||0}}catch(u){throw console.error("Error generating video:",u),u}};export{Cd as I,ee as M,M as T,Ad as a,wd as b,Rd as c,Nd as d,Pd as e,Md as f,_d as g,xd as h,Dd as i,$d as j,k,Yd as l,Z as m,Fd as n,bd as o,Ud as p,Ld as q,kd as r,Gd as s,Vd as t,Bd as u,Jd as v,qd as w,Hd as x,Od as y};
