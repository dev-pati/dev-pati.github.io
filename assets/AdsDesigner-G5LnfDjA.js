import{r as l,j as e}from"./index-DX2mtma_.js";import{I as E}from"./lehuyducanhService-BqsWtKXJ.js";import{g as G}from"./mediaService-1p3th5hq.js";import{r as I}from"./media-CDZXYBSY.js";import{A as $}from"./config-PJqXRuVJ.js";import"./settingsService-Tte2DU1T.js";const A=({label:p,id:h,files:o,onAddFiles:d,onRemoveFile:m,onViewImage:g})=>{const i=a=>{a.target.files&&a.target.files.length>0&&d(Array.from(a.target.files)),a.target.value=""};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-md font-bold text-blue-400",children:[p," ",e.jsxs("span",{className:"text-gray-500 text-xs font-normal",children:["(",o.length,")"]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[o.map((a,n)=>{const x=URL.createObjectURL(a);return e.jsxs("div",{className:"relative aspect-square group",children:[e.jsx("img",{src:x,alt:`Preview ${n}`,className:"w-full h-full object-cover rounded-md border border-gray-600 cursor-pointer",onClick:()=>g(x)}),e.jsx("button",{onClick:()=>m(n),className:"absolute -top-1 -right-1 bg-red-600 text-white rounded-full h-5 w-5 flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:"Ã—"})]},`${a.name}-${n}`)}),e.jsxs("label",{htmlFor:h,className:"aspect-square flex flex-col items-center justify-center border-2 border-dashed border-gray-600 rounded-md hover:border-blue-500 hover:bg-gray-700/50 cursor-pointer transition-colors text-gray-400 hover:text-white",children:[e.jsx("i",{className:"fas fa-plus text-xl mb-1"}),e.jsx("span",{className:"text-xs",children:"Add"})]}),e.jsx("input",{id:h,type:"file",accept:"image/*",multiple:!0,onChange:i,className:"hidden"})]})]})},O=({currentUser:p,onLogout:h})=>{const[o,d]=l.useState([]),[m,g]=l.useState([]),[i,a]=l.useState(""),[n,x]=l.useState("16:9"),[u,j]=l.useState(!1),[y,C]=l.useState([]),[v,f]=l.useState(null),[N,c]=l.useState(null),R=s=>d(r=>[...r,...s]),k=s=>d(r=>r.filter((b,t)=>t!==s)),F=s=>g(r=>[...r,...s]),P=s=>g(r=>r.filter((b,t)=>t!==s)),S=async()=>{if(o.length===0){f("At least one Product Image is required.");return}if(!i){f("Please describe the ad.");return}j(!0),f(null);try{const s=await Promise.all(o.map(t=>I(t))),r=await Promise.all(m.map(t=>I(t))),b=await G({provider:"lehuyducanh",model:"nano2",prompt:i,aspectRatio:n,subjectUrls:s,referenceUrls:r});C(t=>[...b,...t])}catch(s){f(s instanceof Error?s.message:"An unknown error occurred.")}finally{j(!1)}},U=s=>{const r=document.createElement("a");r.href=s,r.download=`ads-design-${Date.now()}.jpg`,document.body.appendChild(r),r.click(),document.body.removeChild(r)},w=()=>{switch(n){case"16:9":return"aspect-video";case"9:16":return"aspect-[9/16]";case"1:1":return"aspect-square";default:return"aspect-square"}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col h-full bg-gray-900",children:[e.jsxs("header",{className:"py-4 px-8 bg-gray-800 shadow-md border-b border-gray-700 shrink-0 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-blue-400",children:[e.jsx("i",{className:"fas fa-object-group mr-3"}),"Ads Designer"]}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"High-quality ad generation using Nano 2 model."})]}),$.LOGIN_REQUIRED]}),e.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-8 h-full",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("div",{className:"bg-gray-800 p-6 rounded-2xl border border-gray-700 shadow-lg space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-blue-400 mb-3",children:[e.jsx("i",{className:"fas fa-images mr-2"}),"Assets"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(A,{id:"product-images",label:"Product Images",files:o,onAddFiles:R,onRemoveFile:k,onViewImage:c}),e.jsx("div",{className:"border-t border-gray-700"}),e.jsx(A,{id:"ref-images",label:"Reference / Style Images",files:m,onAddFiles:F,onRemoveFile:P,onViewImage:c})]})]}),e.jsxs("div",{className:"border-t border-gray-700 pt-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-blue-400 mb-3",children:[e.jsx("i",{className:"fas fa-pen-fancy mr-2"}),"Creative Brief"]}),e.jsx("textarea",{value:i,onChange:s=>a(s.target.value),placeholder:"Describe the setting, lighting, and mood of the advertisement...",rows:5,className:"w-full bg-gray-900 border-2 border-gray-600 rounded-lg p-3 text-gray-200 focus:ring-2 focus:ring-blue-500 transition"})]}),e.jsxs("div",{className:"border-t border-gray-700 pt-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-blue-400 mb-3",children:[e.jsx("i",{className:"fas fa-crop-simple mr-2"}),"Format"]}),e.jsx("div",{className:"flex gap-2",children:["16:9","9:16","1:1"].map(s=>e.jsx("button",{onClick:()=>x(s),className:`flex-1 py-3 px-4 rounded-lg font-bold border-2 transition-all ${n===s?"bg-blue-600 border-blue-600 text-white":"bg-gray-900 border-gray-600 text-gray-400 hover:border-blue-500"}`,children:s},s))})]}),e.jsx("button",{onClick:S,disabled:u||o.length===0||!i,className:"w-full bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-6 rounded-full disabled:opacity-50 disabled:cursor-not-allowed transition-all text-xl shadow-lg flex items-center justify-center gap-3",children:u?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin"})," Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-magic"})," Generate Ad"]})}),v&&e.jsx("div",{className:"bg-red-900/50 border border-red-500 text-red-200 p-3 rounded-lg text-sm text-center",children:v})]})}),e.jsx("div",{className:"lg:col-span-3 bg-gray-800 rounded-2xl border-2 border-dashed border-gray-700 flex flex-col p-4 relative overflow-hidden",children:y.length===0&&!u?e.jsxs("div",{className:"flex-grow flex flex-col items-center justify-center text-gray-500",children:[e.jsx("i",{className:"fas fa-image text-6xl mb-4 opacity-50"}),e.jsx("p",{className:"text-xl font-bold",children:"Your ads will appear here"})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 overflow-y-auto max-h-full",children:[y.map((s,r)=>e.jsxs("div",{className:`relative group bg-black rounded-lg overflow-hidden shadow-lg border border-gray-700 ${w()}`,children:[e.jsx("img",{src:s,alt:`Generated Ad ${r+1}`,className:"w-full h-full object-cover cursor-pointer",onClick:()=>c(s)}),e.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-4",children:[e.jsx("button",{onClick:()=>c(s),className:"w-12 h-12 bg-white/20 hover:bg-white/40 rounded-full flex items-center justify-center text-white backdrop-blur-sm transition",title:"View",children:e.jsx("i",{className:"fas fa-eye"})}),e.jsx("button",{onClick:()=>U(s),className:"w-12 h-12 bg-blue-600 hover:bg-blue-500 rounded-full flex items-center justify-center text-white shadow-lg transition",title:"Download",children:e.jsx("i",{className:"fas fa-download"})})]})]},r)),u&&e.jsx("div",{className:`flex items-center justify-center bg-gray-900 rounded-lg border border-gray-700 animate-pulse ${w()}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fas fa-spinner fa-spin text-4xl text-blue-500 mb-2"}),e.jsx("p",{className:"text-gray-400 font-bold",children:"Creating..."})]})})]})})]})})]}),N&&e.jsx(E,{imageUrl:N,onClose:()=>c(null)})]})};export{O as default};
