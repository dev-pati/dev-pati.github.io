import{r as a,j as e}from"./index-3Ior5TtI.js";import{I as H}from"./ImageUpload-C4O-8fYV.js";import{I as T}from"./lehuyducanhService-Ba6mGdSt.js";import{B as I,G as h,g as q,e as K}from"./adsService-CYwiNRbS.js";import{s as Y}from"./settingsService-CbIZ9NBp.js";import"./streetInterviewPrompts-Dzu83YwK.js";const V=({file:y,onFileChange:N})=>{const n=y?URL.createObjectURL(y):null,p=l=>{var c,f;let o=null;"dataTransfer"in l?(l.preventDefault(),o=((c=l.dataTransfer.files)==null?void 0:c[0])||null):o=((f=l.target.files)==null?void 0:f[0])||null,o&&N(o)};return e.jsxs("div",{onDragOver:l=>l.preventDefault(),onDrop:p,className:"relative w-full p-4 border-2 border-dashed border-gray-600 rounded-lg hover:border-blue-500 transition-colors text-center cursor-pointer bg-gray-800/50",children:[e.jsx("input",{type:"file",id:"product-image-upload",accept:"image/*",onChange:p,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer","aria-label":"Upload product image"}),n?e.jsx("img",{src:n,alt:"Product preview",className:"mx-auto max-h-48 rounded-md object-contain"}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx("i",{className:"fas fa-upload text-3xl text-gray-500 mb-2"}),e.jsx("p",{className:"font-semibold text-gray-300",children:"Click to upload or drag and drop"}),e.jsx("p",{className:"text-sm text-gray-500",children:"PNG, JPG, or WEBP (MAX. 4MB)"})]})]})},ee=({currentUser:y,onLogout:N})=>{const[n,p]=a.useState(null),[l,o]=a.useState(null),[c,f]=a.useState("I WENT FROM A SIZE 12 TO A SIZE 4 EFFORTLESSLY"),[E,z]=a.useState(""),[F,A]=a.useState(I.Back),[v,G]=a.useState(h.Female),[g,M]=a.useState("Holding Product Over Shoulder"),[b,w]=a.useState([]),[x,D]=a.useState(!1),[P,m]=a.useState(null),[U,C]=a.useState(null),[i,d]=a.useState(null),[u,S]=a.useState(""),O=()=>Y.getGeminiApiKey()?!0:(m("Please set your Gemini API Key in the Settings module before generating content."),alert("Please set your Gemini API Key in the Settings module before generating content."),!1);a.useEffect(()=>{g==="Holding Product Over Shoulder"&&A(I.Back)},[g]);const B=async()=>{if(O()){if(!n){m("Product Image is required.");return}D(!0),m(null);try{const s=await q(n,c,F,v,l,E,g),t={id:crypto.randomUUID(),type:"subject",data:s};w(r=>[t,...r])}catch(s){m(s instanceof Error?s.message:"An unknown error occurred.")}finally{D(!1)}}},L=s=>{const t=document.createElement("a");t.href=s.data,t.download=`ugly-ad_${s.id.substring(0,6)}.png`,document.body.appendChild(t),t.click(),document.body.removeChild(t)},$=s=>{w(t=>t.filter(r=>r.id!==s))},R=async()=>{if(!O()||!i||!u)return;const s=i.id;d(t=>t?{...t,isProcessing:!0}:null);try{const t=await K(i.data,u);w(r=>r.map(k=>k.id===s?{...k,data:t,sourcePrompt:`Edited with: "${u}"`}:k)),d(null),S("")}catch(t){m(t instanceof Error?t.message:"Failed to edit image."),d(r=>r?{...r,isProcessing:!1}:null)}},j=g==="Holding Product Over Shoulder";return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col h-full bg-gray-900",children:[e.jsxs("header",{className:"py-4 px-8 bg-gray-800 shadow-md border-b border-gray-700 shrink-0 flex justify-between items-center z-10",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-blue-400",children:[e.jsx("i",{className:"fas fa-ad mr-3"}),"Ugly Ads Generator"]}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Generate 'ugly' high-conversion ads."})]}),e.jsx("button",{onClick:N,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-full",children:"Logout"})]}),e.jsx("main",{className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"p-4 md:p-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-lg font-bold text-blue-400",children:"1. Upload Your Product"}),e.jsx(V,{file:n,onFileChange:p})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-lg font-bold text-blue-400",children:"2. Craft Your Message"}),e.jsx("label",{htmlFor:"ad-message",className:"text-sm text-gray-400",children:"Enter the message to display on the image."}),e.jsx("textarea",{id:"ad-message",value:c,onChange:s=>f(s.target.value),rows:3,className:"w-full bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-gray-200 focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-lg font-bold text-blue-400",children:"3. Specify Product Size"}),e.jsx("label",{htmlFor:"product-size",className:"text-sm text-gray-400",children:"Describe the product's size (optional)."}),e.jsx("input",{id:"product-size",type:"text",value:E,onChange:s=>z(s.target.value),placeholder:"e.g., a small 5oz bottle",className:"w-full bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-gray-200 focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-lg font-bold text-blue-400",children:"4. Choose Placement"}),e.jsx("div",{className:`flex gap-2 ${j?"opacity-50":""}`,title:j?'Placement is set to "Back" for this pose.':"",children:Object.values(I).map(s=>e.jsx("button",{onClick:()=>A(s),disabled:j,className:`px-4 py-2 rounded-md font-semibold transition-colors w-full ${F===s?"bg-blue-600 text-white":"bg-gray-700 hover:bg-gray-600 text-gray-300"} ${j?"cursor-not-allowed":""}`,children:s},s))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-bold text-blue-400",children:"5. Customize Character"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"pose-select",className:"text-sm text-gray-400",children:"Pose"}),e.jsxs("select",{id:"pose-select",value:g,onChange:s=>M(s.target.value),className:"w-full bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-gray-200 focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"Default",children:"Default Pose"}),e.jsx("option",{value:"Holding Product Over Shoulder",children:"Holding Product Over Shoulder"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Gender"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>G(h.Female),className:`px-4 py-2 rounded-md font-semibold transition-colors w-1/2 ${v===h.Female?"bg-blue-600 text-white":"bg-gray-700 hover:bg-gray-600 text-gray-300"}`,children:"Female"}),e.jsx("button",{onClick:()=>G(h.Male),className:`px-4 py-2 rounded-md font-semibold transition-colors w-1/2 ${v===h.Male?"bg-blue-600 text-white":"bg-gray-700 hover:bg-gray-600 text-gray-300"}`,children:"Male"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("hr",{className:"flex-grow border-gray-600"}),e.jsx("span",{className:"text-gray-500 text-sm",children:"OR"}),e.jsx("hr",{className:"flex-grow border-gray-600"})]}),e.jsx(H,{id:"character-image",label:"Upload Character Image (Optional)",file:l,onFileChange:o,onViewImage:s=>s&&C(s)})]}),e.jsx("button",{onClick:B,disabled:x||!n,className:"w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-full disabled:opacity-50 disabled:cursor-not-allowed transition-all text-lg flex items-center justify-center gap-2",children:x?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-magic"}),"Generate Ad"]})})]}),e.jsxs("div",{className:"lg:col-span-3 bg-gray-800 rounded-lg border-2 border-dashed border-gray-700 flex items-center justify-center min-h-[60vh] p-4",children:[x&&b.length===0&&e.jsxs("div",{className:"text-center text-blue-300",children:[e.jsx("i",{className:"fas fa-spinner fa-spin text-5xl mb-4"}),e.jsx("p",{className:"text-xl font-bold",children:"Generating your ad..."})]}),P&&e.jsxs("div",{className:"text-center text-red-400 max-w-md",children:[e.jsx("i",{className:"fas fa-exclamation-triangle text-5xl mb-4"}),e.jsx("p",{className:"text-xl font-bold mb-2",children:"Generation Failed"}),e.jsx("p",{className:"text-red-300 bg-red-900/50 p-2 rounded font-mono text-sm",children:P})]}),!x&&!P&&b.length===0&&e.jsxs("div",{className:"text-center text-gray-500 max-w-sm",children:[e.jsx("i",{className:"far fa-image text-6xl mb-4"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-400",children:"Your generated ads will appear here"}),e.jsx("p",{className:"mt-2",children:'Fill in the details on the left and click "Generate" to see the magic happen.'})]}),b.length>0&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 w-full h-full overflow-y-auto p-2",children:[x&&e.jsx("div",{className:"relative group aspect-square bg-gray-700 rounded-md animate-pulse flex items-center justify-center",children:e.jsx("i",{className:"fas fa-spinner fa-spin text-4xl text-gray-500"})}),b.map(s=>e.jsxs("div",{className:"relative group aspect-square cursor-pointer",onClick:()=>C(s.data),children:[e.jsx("img",{src:s.data,alt:"Generated ad",className:"w-full h-full object-contain rounded-md bg-gray-900"}),s.isProcessing&&e.jsxs("div",{className:"absolute inset-0 bg-black/70 flex items-center justify-center text-white text-lg rounded-md",children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Processing..."]}),e.jsxs("div",{className:"absolute inset-0 bg-black/70 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center pointer-events-none rounded-md",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 pointer-events-auto",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>L(s),title:"Download",className:"w-12 h-12 bg-blue-600 hover:bg-blue-500 text-white rounded-full flex items-center justify-center text-xl",children:e.jsx("i",{className:"fas fa-download"})}),e.jsx("button",{onClick:()=>{S(""),d(s)},title:"Edit",className:"w-12 h-12 bg-purple-600 hover:bg-purple-500 text-white rounded-full flex items-center justify-center text-xl",children:e.jsx("i",{className:"fas fa-edit"})})]}),e.jsx("button",{onClick:t=>{t.stopPropagation(),$(s.id)},title:"Delete",className:"absolute top-2 right-2 w-8 h-8 bg-red-600 hover:bg-red-500 text-white rounded-full flex items-center justify-center text-lg font-bold pointer-events-auto",children:"Ã—"})]})]},s.id))]})]})]})})})]}),U&&e.jsx(T,{imageUrl:U,onClose:()=>C(null)}),i&&e.jsx("div",{className:"fixed inset-0 bg-black/80 z-40 flex items-center justify-center p-4",onClick:()=>d(null),children:e.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 p-6 w-full max-w-4xl flex flex-col md:flex-row gap-6",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"md:w-1/2",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-400 mb-4",children:"Edit Image"}),e.jsx("img",{src:i.data,alt:"Editing asset",className:"w-full h-auto object-contain rounded-md aspect-square bg-gray-900"})]}),e.jsxs("div",{className:"md:w-1/2 flex flex-col",children:[e.jsx("label",{htmlFor:"edit-prompt",className:"text-xl font-bold text-gray-300 mb-2",children:"Edit Prompt"}),e.jsx("textarea",{id:"edit-prompt",value:u,onChange:s=>S(s.target.value),placeholder:"e.g., Change the person's shirt to red",className:"w-full bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-gray-200 focus:ring-2 focus:ring-purple-500 text-lg flex-grow",rows:8}),e.jsxs("div",{className:"flex gap-4 mt-4",children:[e.jsx("button",{onClick:()=>d(null),className:"w-full bg-gray-600 hover:bg-gray-500 text-white font-bold py-3 px-4 rounded-full text-xl",children:"Cancel"}),e.jsx("button",{onClick:R,disabled:i.isProcessing||!u,className:"w-full bg-purple-600 hover:bg-purple-500 text-white font-bold py-3 px-4 rounded-full disabled:opacity-50 text-xl flex items-center justify-center gap-2",children:i.isProcessing?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin"}),"Applying..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-magic"}),"Apply Edit"]})})]})]})]})})]})};export{ee as default};
