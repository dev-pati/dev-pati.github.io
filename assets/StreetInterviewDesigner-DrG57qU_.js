import{r as s,j as e}from"./index-WZ944UgW.js";import{u as B,c as dt,b as gt,r as je,t as ke,s as mt,O as ut,e as pt,d as bt,S as ht}from"./telegramService-Ba9-Zoq2.js";import{I as ie}from"./ImageUpload-DksvPInp.js";import{t as Ve,u as ft,v as vt,w as Ne,x as xt,c as wt,m as Ce,I as yt}from"./lehuyducanhService-p9mbsEAy.js";import{r as P,i as St,f as Ge,d as Ae}from"./media-CDZXYBSY.js";import{s as Te}from"./settingsService-CbIZ9NBp.js";import"./streetInterviewPrompts-Dzu83YwK.js";const Fe=[{value:"Kore",label:"Kore (Female)"},{value:"Puck",label:"Puck (Male)"},{value:"Charon",label:"Charon (Male)"},{value:"Fenrir",label:"Fenrir (Male)"},{value:"Zephyr",label:"Zephyr (Male)"}],It=b=>{const{reporterImage:z,setReporterImage:h,intervieweeImage:J,setIntervieweeImage:G,topic:D,setTopic:U,pastedScript:A,setPastedScript:Q,onGenerateStoryboard:R,isGeneratingStoryboard:x,reporterVoice:$,setReporterVoice:u,intervieweeVoice:M,setIntervieweeVoice:T,videoAspectRatio:O,setVideoAspectRatio:c,interviewMode:d,setInterviewMode:L,backgroundPrompt:g,setBackgroundPrompt:N,onGenerateBackgrounds:W,isGeneratingBackgrounds:j,selectedBackground:H,globalVoiceInstruction:f,setGlobalVoiceInstruction:_,customBackgroundFile:y,setCustomBackgroundFile:q,backgroundVariationsCount:v,setBackgroundVariationsCount:X}=b,[k,K]=s.useState("custom"),[S,E]=s.useState("generate");return e.jsxs("div",{className:"bg-gray-800 p-6 rounded-2xl border border-gray-700 shadow-lg flex flex-col gap-6",children:[e.jsxs("div",{className:"flex mb-2 border-b-2 border-gray-700",children:[e.jsxs("button",{onClick:()=>K("custom"),className:`flex-1 text-center font-bold py-3 transition-all duration-300 flex items-center justify-center gap-2 ${k==="custom"?"text-blue-400 border-b-4 border-blue-500":"text-gray-400 hover:text-white"}`,children:[e.jsx("i",{className:"fas fa-tools"})," Custom Setup"]}),e.jsxs("button",{onClick:()=>K("quick-start"),className:`flex-1 text-center font-bold py-3 transition-all duration-300 flex items-center justify-center gap-2 ${k==="quick-start"?"text-yellow-400 border-b-4 border-yellow-500":"text-gray-400 hover:text-white"}`,children:[e.jsx("i",{className:"fas fa-bolt"})," Quick Start"]})]}),k==="custom"&&e.jsxs("div",{className:"flex flex-col gap-6 animate-fade-in",children:[e.jsxs("h3",{className:"text-xl font-bold text-blue-400 -mb-2",children:[e.jsx("i",{className:"fas fa-users mr-2"}),"Cast"]}),e.jsx(ie,{id:"reporter-image",label:"Reporter Image (Optional)",file:z,onFileChange:h}),e.jsx(ie,{id:"interviewee-image",label:"Interviewee Image (Optional)",file:J,onFileChange:G}),e.jsx("div",{className:"border-t-2 border-gray-700 -mx-6"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-blue-400 mb-2",children:[e.jsx("i",{className:"fas fa-image mr-2"}),"Background Scene"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-md font-bold text-gray-300 mb-2",children:"Interview Mode"}),e.jsxs("div",{className:"flex gap-2 bg-gray-900 border-2 border-gray-600 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>L("two-shot"),className:`flex-1 py-2 px-4 rounded-md text-sm font-bold transition-all ${d==="two-shot"?"bg-blue-600":"bg-transparent text-gray-400 hover:bg-gray-700"}`,children:"Two-Person Shot"}),e.jsx("button",{onClick:()=>L("single-shot"),className:`flex-1 py-2 px-4 rounded-md text-sm font-bold transition-all ${d==="single-shot"?"bg-blue-600":"bg-transparent text-gray-400 hover:bg-gray-700"}`,children:"Interviewee Only"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"background-prompt",className:"block text-md font-bold text-gray-300 mb-2",children:"Generate with AI"}),e.jsx("input",{id:"background-prompt",type:"text",value:g,onChange:l=>N(l.target.value),className:"w-full bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-gray-200"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"bg-count",className:"block text-md font-bold text-gray-300 mb-2",children:"Number of Variations"}),e.jsx("input",{id:"bg-count",type:"number",min:"1",max:"8",value:v,onChange:l=>X(parseInt(l.target.value,10)),className:"w-full bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-gray-200"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"aspect-ratio-street",className:"block text-md font-bold text-gray-300 mb-2",children:"Video Aspect Ratio"}),e.jsxs("select",{id:"aspect-ratio-street",value:O,onChange:l=>c(l.target.value),className:"w-full bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-gray-200",children:[e.jsx("option",{value:"9:16",children:"9:16 (Portrait)"}),e.jsx("option",{value:"16:9",children:"16:9 (Landscape)"})]})]}),e.jsx("button",{onClick:W,disabled:j,className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-full disabled:opacity-50 flex items-center justify-center gap-2",children:j?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin"})," Generating..."]}):"Generate Backgrounds"})]})]}),k==="quick-start"&&e.jsxs("div",{className:"flex flex-col gap-6 animate-fade-in",children:[e.jsx("div",{className:"bg-yellow-900/30 border border-yellow-700/50 p-3 rounded-lg text-center text-yellow-200 text-sm",children:e.jsxs("p",{children:[e.jsx("i",{className:"fas fa-bolt mr-2"}),"Upload a finalized photo of the interview scene. We'll generate different shots from it."]})}),e.jsx(ie,{id:"street-interview-custom-bg",label:"Master Shot",file:y,onFileChange:q}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"aspect-ratio-street-quick",className:"block text-md font-bold text-gray-300 mb-2",children:"Video Aspect Ratio"}),e.jsxs("select",{id:"aspect-ratio-street-quick",value:O,onChange:l=>c(l.target.value),className:"w-full bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-gray-200",children:[e.jsx("option",{value:"9:16",children:"9:16 (Portrait)"}),e.jsx("option",{value:"16:9",children:"16:9 (Landscape)"})]})]})]}),e.jsx("div",{className:"border-t-2 border-gray-700 -mx-6"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-blue-400 mb-2",children:[e.jsx("i",{className:"fas fa-cog mr-2"}),"Audio & Video"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reporter-voice",className:"block text-md font-bold text-gray-300 mb-2",children:"Reporter's Voice"}),e.jsx("select",{id:"reporter-voice",value:$,onChange:l=>u(l.target.value),className:"w-full bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-gray-200",children:Fe.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"interviewee-voice",className:"block text-md font-bold text-gray-300 mb-2",children:"Interviewee's Voice"}),e.jsx("select",{id:"interviewee-voice",value:M,onChange:l=>T(l.target.value),className:"w-full bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-gray-200",children:Fe.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"global-voice-instruction-street",className:"block text-md font-bold text-gray-300 mb-2",children:"Global Voice Instruction (Optional)"}),e.jsx("textarea",{id:"global-voice-instruction-street",value:f,onChange:l=>_(l.target.value),placeholder:"e.g., Speak in an excited and fast-paced style.",className:"w-full bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-gray-200",rows:2})]})]}),e.jsx("div",{className:"border-t-2 border-gray-700 -mx-6"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-blue-400 mb-4",children:[e.jsx("i",{className:"fas fa-file-alt mr-2"}),"Scripting"]}),e.jsxs("div",{className:"flex gap-1 bg-gray-900 border-2 border-gray-600 rounded-lg p-1 mb-4",children:[e.jsxs("button",{onClick:()=>E("generate"),className:`flex-1 py-2 px-4 rounded-md text-sm font-bold ${S==="generate"?"bg-blue-600":"bg-transparent text-gray-400 hover:bg-gray-700"}`,children:[e.jsx("i",{className:"fas fa-magic mr-2"}),"From Topic"]}),e.jsxs("button",{onClick:()=>E("paste"),className:`flex-1 py-2 px-4 rounded-md text-sm font-bold ${S==="paste"?"bg-blue-600":"bg-transparent text-gray-400 hover:bg-gray-700"}`,children:[e.jsx("i",{className:"fas fa-paste mr-2"}),"From Script"]})]}),S==="generate"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"interview-topic",className:"block text-md font-bold text-gray-300 mb-2",children:"Interview Topic"}),e.jsx("textarea",{id:"interview-topic",value:D,onChange:l=>U(l.target.value),placeholder:"e.g., What are your thoughts on remote work?",className:"w-full bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-gray-200",rows:3})]}),S==="paste"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"pasted-script",className:"block text-md font-bold text-gray-300 mb-2",children:"Paste Script"}),e.jsx("textarea",{id:"pasted-script",value:A,onChange:l=>Q(l.target.value),placeholder:`Reporter: What's one thing you can't live without?
Interviewee: Definitely my morning coffee. I'm not a person until I've had my coffee.`,className:"w-full bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-gray-200",rows:8})]})]}),e.jsx("div",{className:"border-t-2 border-gray-700 -mx-6 pt-6",children:e.jsx("button",{onClick:R,disabled:x||!D&&!A,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-full disabled:opacity-50 transition-all text-lg flex items-center justify-center gap-2",title:!D&&!A?"Please provide a topic or script":"Generate Storyboard",children:x?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin"})," Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-wand-magic-sparkles"})," Generate Storyboard"]})})})]})},Rt=({currentUser:b,onLogout:z})=>{const[h,J]=s.useState("two-shot"),[G,D]=s.useState("A busy city street with a shallow depth of field"),[U,A]=s.useState([]),[Q,R]=s.useState(!1),[x,$]=s.useState(),[u,M]=s.useState(""),[T,O]=s.useState(""),[c,d]=s.useState([]),[L,g]=s.useState(null),[N,W]=s.useState("Puck"),[j,H]=s.useState("Kore"),[f,_]=s.useState("9:16"),[y,q]=s.useState(""),[v,X]=s.useState(null),[k,K]=s.useState(4),[S,E]=s.useState(""),[C,l]=s.useState(""),[Y,le]=s.useState("input"),[ee,te]=s.useState(""),[ce,de]=s.useState(!1),[w,ge]=s.useState(null),[p,me]=s.useState(null),[jt,kt]=s.useState({}),[ue,pe]=s.useState(null),[Pe,Vt]=s.useState(!1),[De,be]=s.useState(!1),[Ue,he]=s.useState(!1),[Ee,Nt]=s.useState(!1),[Be,fe]=s.useState(!1),[Re,Ct]=s.useState(!1),[$e,Gt]=s.useState(!1),[ve,xe]=s.useState(!1),[ae,we]=s.useState(!1),[Me,ye]=s.useState(!1),[Oe,Se]=s.useState(!1),[At,Le]=s.useState({storyboard:0,image:0,video:0}),F=s.useCallback(()=>{if(b){const a=B.getUsage(b);Le({storyboard:a.generateStoryboard.count,image:a.generateImage.count,video:a.generateVideo.count})}},[b]);s.useEffect(()=>{F()},[b,F]),s.useEffect(()=>{if(v){const a=URL.createObjectURL(v);$(a)}},[v]);const We=s.useCallback(async()=>{R(!0),g(null);try{if(h==="single-shot"){const a=p?await P(p):void 0,r=await Ve(a,void 0,G,k,h,f);A(r)}else{const a=w?await P(w):void 0,r=p?await P(p):void 0,o=await Ve(a,r,G,k,h,f);A(o)}}catch(a){g(a instanceof Error?a.message:"Failed to generate background scenes.")}finally{R(!1)}},[w,p,G,h,f,k]),Ie=s.useCallback(async()=>{if(!B.canPerformAction(b,"generateStoryboard")){g("Daily limit reached for storyboard generations.");return}if(!u&&!T){g("Please provide a topic or script before generating the storyboard.");return}de(!0),g(null);try{let a,r=T;if(v){const o=await P(v);if(!r&&u){const t=await ft(u,o);r=t.script,a={scenes:t.scenes,reporterDescription:t.reporterDescription,intervieweeDescription:t.intervieweeDescription}}else if(r)a=await vt(r,o);else throw new Error("In Quick Start mode, you must provide either a topic or a script.");d(a.scenes.map(t=>({...t,selectedImageForVideo:o})))}else{if(!x)throw new Error("Please select a background from the generated options.");const o=w?await P(w):void 0,t=p?await P(p):void 0;let n,i;if(h==="single-shot"){if(!t)throw new Error("Interviewee image must be provided in 'Interviewee Only' mode.");n=t}else{if(!o)throw new Error("Reporter image must be provided.");n=o,i=t}if(!r&&u)if(h==="single-shot"){const m=t||o;if(!m)throw new Error("Please upload at least one character image for 'Interviewee Only' mode.");r=await Ne(u,o||m,t||m)}else{if(!o||!t)throw new Error("To generate a script from a topic, please provide both character images in 'Two-Person Shot' mode.");r=await Ne(u,o,t)}else if(!r)throw new Error("Please provide a topic or a script.");a=await xt(r,n,i,x),d(a.scenes.map(m=>({...m,selectedImageForVideo:x})))}E(a.reporterDescription),l(a.intervieweeDescription),te(r),B.logAction(b,"generateStoryboard"),F(),le("prompts_generated")}catch(a){g(a instanceof Error?a.message:"An unknown error occurred.")}finally{de(!1)}},[b,F,T,u,v,w,p,x,h]),re=s.useCallback(async a=>{const r=c.find(n=>n.id===a);if(!r)return;let o=N,t=r.voiceoverScript;t.toLowerCase().startsWith("reporter:")?(o=N,t=t.substring(9).trim()):t.toLowerCase().startsWith("interviewee:")?(o=j,t=t.substring(12).trim()):o=j,d(n=>n.map(i=>i.id===a?{...i,isGeneratingAudio:!0,audioGenerationError:null}:i));try{const n=await wt(t,r.voiceoverGuide,o,y),i=dt(n),m=URL.createObjectURL(i);d(I=>I.map(V=>V.id===a?{...V,audioUrl:m,isGeneratingAudio:!1}:V))}catch(n){const i=n instanceof Error?n.message:"An unknown audio generation error occurred.";d(m=>m.map(I=>I.id===a?{...I,isGeneratingAudio:!1,audioGenerationError:i}:I))}},[c,N,j,y]),_e=s.useCallback(async a=>{console.log("Image generation per scene is disabled for the Street Interview module.")},[]),oe=s.useCallback(async a=>{if(!B.canPerformAction(b,"generateVideo"))throw new Error("Daily video generation limit reached.");const r=c.find(o=>o.id===a);if(!r||!r.selectedImageForVideo)throw new Error("No image selected for video generation.");d(o=>o.map(t=>t.id===a?{...t,isGeneratingVideo:!0,videoGenerationError:null}:t));try{const o=await St(r.selectedImageForVideo);let t="";if(h==="two-shot"?(t+=`There are two people in the scene:
`,t+=`- The Reporter is: ${S}
`,t+=`- The Interviewee is: ${C}

`):(t+=`There is one person in the scene:
`,t+=`- The Interviewee is: ${C}

`),r.voiceoverScript.toLowerCase().startsWith("reporter:")?t+=`In this scene, the Reporter (${S}) is speaking.
`:r.voiceoverScript.toLowerCase().startsWith("interviewee:")?t+=`In this scene, the Interviewee (${C}) is speaking.
`:t+=`In this scene, the Interviewee (${C}) is speaking.
`,t+=`Motion/Action: ${r.videoPrompt}
`,r.includeDialogueInPrompt!==!1){const ne=r.voiceoverScript.replace(/^(Reporter:|Interviewee:)\s*/i,"");y&&(t+=`
Dialogue style: "${y}"`),t+=`
Dialogue in English: "${ne}"`}t+=`

No Music Background`;const{videoUrl:n,upscaledUrl:i,mediaGenerationId:m,seed:I,publicUrl:V,upscaledPublicUrl:it}=await gt({provider:"lehuyducanh",prompt:t,imageUrl:o,upscale:r.shouldUpscaleVideo,aspectRatio:f}),lt={url:V||n,mediaGenerationId:m,seed:I,upscaledUrl:it||i};d(ne=>ne.map(Z=>{if(Z.id!==a)return Z;const ct=[...Z.videos||[],lt];return{...Z,videos:ct,isGeneratingVideo:!1}})),B.logAction(b,"generateVideo"),F()}catch(o){const t=o instanceof Error?o.message:"An unknown error occurred.";throw d(n=>n.map(i=>i.id===a?{...i,isGeneratingVideo:!1,videoGenerationError:t}:i)),o}},[c,b,F,f,y,h,S,C]),qe=(a,r)=>{d(o=>o.map(t=>t.id===a?{...t,includeDialogueInPrompt:r}:t))},Ke=(a,r)=>{d(o=>o.map(t=>t.id===a?{...t,voiceoverScript:r}:t))},Ze=(a,r)=>{d(o=>o.map(t=>{if(t.id!==a)return t;const n=[...t.videos];return n.splice(r,1),{...t,videos:n}}))},ze=(a,r)=>d(o=>o.map(t=>t.id===a?{...t,imagePrompt:r}:t)),Je=(a,r)=>d(o=>o.map(t=>t.id===a?{...t,videoPrompt:r}:t)),Qe=(a,r)=>d(o=>o.map(t=>t.id===a?{...t,voiceoverGuide:r}:t)),He=a=>{d(r=>{const o=r.length?r[Math.max(0,Math.min(a-1,r.length-1))]:void 0,t=o?{...o,id:crypto.randomUUID?crypto.randomUUID():`scene-${Date.now()}`,images:[...o.images],videos:(o.videos||[]).map(i=>({...i,isUpscaling:!1,upscaleError:null})),isGeneratingImage:!1,imageGenerationError:null,isGeneratingVideo:!1,videoGenerationError:null,isGeneratingAudio:!1,audioGenerationError:null,audioUrl:o.audioUrl}:Ce({voiceoverScript:"New scene..."}),n=[...r];return n.splice(a,0,t),n})},Xe=s.useCallback(()=>{const a=v?URL.createObjectURL(v):x;a?(d(r=>r.map(o=>({...o,selectedImageForVideo:a}))),alert("Set the selected background for all scenes.")):alert("Please select or upload a background first.")},[x,v]),Ye=s.useCallback(async()=>{be(!0);const a=c.filter(r=>!r.audioUrl).map(r=>()=>re(r.id));await je(a,5),be(!1)},[c,re]),et=s.useCallback(async()=>{he(!0);const a=c.filter(r=>r.selectedImageForVideo&&(!r.videos||r.videos.length===0)).map(r=>()=>oe(r.id));await je(a,5),he(!1)},[c,oe]),tt=s.useCallback(()=>{alert("Batch image generation is not applicable for this module. All scenes use the pre-generated background.")},[]),at=s.useCallback(async()=>{const{botToken:a,chatId:r}=Te.getTelegramConfig();if(!a||!r){alert("Please configure Telegram settings first in the Settings page.");return}const o=c.map((t,n)=>t.selectedImageForVideo?{type:"photo",url:t.selectedImageForVideo,caption:`Scene ${n+1}: ${t.voiceoverScript}`,fileName:`${String(n+1).padStart(3,"0")}_scene_image.jpg`}:null).filter(t=>t!==null);if(o.length===0){alert("No selected background images found in scenes to send.");return}ye(!0),g(null);try{await ke.sendMedia(o),alert("All scene images sent to Telegram successfully!")}catch(t){const n=t instanceof Error?t.message:"Failed to send images to Telegram.";g(n),alert(n)}finally{ye(!1)}},[c]),rt=s.useCallback(async()=>{const{botToken:a,chatId:r}=Te.getTelegramConfig();if(!a||!r){alert("Please configure Telegram settings first in the Settings page.");return}const o=c.flatMap((t,n)=>(t.videos||[]).map((i,m)=>({type:"video",url:i.upscaledUrl||i.url,caption:`Scene ${n+1}: ${t.voiceoverScript}`,fileName:`${String(n+1).padStart(3,"0")}_video_${String(m+1).padStart(2,"0")}.mp4`}))).filter(t=>t.url);if(o.length===0){alert("No videos found to send.");return}Se(!0),g(null);try{await ke.sendMedia(o),alert("All videos sent to Telegram successfully!")}catch(t){const n=t instanceof Error?t.message:"Failed to send videos to Telegram.";g(n),alert(n)}finally{Se(!1)}},[c]),se=c.length>0,ot=s.useCallback(async()=>{if(!se){alert("Please generate a storyboard before saving.");return}xe(!0);try{const a=w?{name:w.name,data:await Ge(w)}:void 0,r=p?{name:p.name,data:await Ge(p)}:void 0,o={version:"1.4.0-street-interview",topic:u,scenes:c,voiceoverScript:ee,generationStep:Y,reporterImage:a,intervieweeImage:r,reporterVoice:N,intervieweeVoice:j,videoAspectRatio:f,globalVoiceInstruction:y,reporterDescription:S,intervieweeDescription:C},t=new Blob([JSON.stringify(o,null,2)],{type:"application/json"});mt(t,`${u.substring(0,20).replace(/\s/g,"_")||"street-interview"}.sivproj`)}catch(a){g(a instanceof Error?a.message:"Failed to save project.")}finally{xe(!1)}},[se,c,u,ee,Y,w,p,N,j,f,y,S,C]),st=s.useCallback(async a=>{var o,t;const r=(o=a.target.files)==null?void 0:o[0];if(r){we(!0);try{const n=await r.text(),i=JSON.parse(n);if(!((t=i.version)!=null&&t.includes("-street-interview")))throw new Error("Invalid project file for this module.");M(i.topic||"");const I=(i.scenes||[]).map(V=>({...Ce(V),...V}));d(I),te(i.voiceoverScript||""),le(i.generationStep||"input"),W(i.reporterVoice||"Puck"),H(i.intervieweeVoice||"Kore"),_(i.videoAspectRatio||"9:16"),q(i.globalVoiceInstruction||""),E(i.reporterDescription||""),l(i.intervieweeDescription||""),i.reporterImage&&ge(await Ae(i.reporterImage.data,i.reporterImage.name)),i.intervieweeImage&&me(await Ae(i.intervieweeImage.data,i.intervieweeImage.name))}catch(n){g(n instanceof Error?n.message:"Failed to import project.")}finally{we(!1),a.target.value=""}}},[]),nt=a=>{window.confirm("Are you sure you want to delete this scene? This action cannot be undone.")&&d(r=>r.filter(o=>o.id!==a))};return e.jsxs(e.Fragment,{children:[e.jsxs("header",{className:"py-4 px-8 bg-gray-800 shadow-lg border-b border-gray-700 shrink-0 flex justify-between items-center flex-wrap gap-y-2",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-blue-400",children:[e.jsx("i",{className:"fas fa-microphone-lines mr-3"}),"Street Interview Designer"]}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Generate dynamic two-person interview videos."})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("label",{htmlFor:"import-project-siv",className:`text-center bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-full transition-all duration-300 flex items-center justify-center gap-2 text-sm shadow-sm ${ae?"cursor-not-allowed opacity-50":"cursor-pointer"}`,children:ae?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-folder-open"}),"Import"]})}),e.jsx("input",{id:"import-project-siv",type:"file",accept:".sivproj",className:"hidden",onChange:st,disabled:ae}),e.jsx("button",{onClick:ot,disabled:ve||!se,className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-full disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 flex items-center justify-center gap-2 text-sm shadow-sm",children:ve?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-save"}),"Save"]})})]}),e.jsx("button",{onClick:z,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-full",children:"Logout"})]})]}),e.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto p-4 md:p-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 xl:grid-cols-4 gap-8 items-start",children:[e.jsx("div",{className:"lg:sticky lg:top-8 xl:col-span-1",children:e.jsx(It,{reporterImage:w,setReporterImage:ge,intervieweeImage:p,setIntervieweeImage:me,topic:u,setTopic:M,pastedScript:T,setPastedScript:O,onGenerateStoryboard:Ie,isGeneratingStoryboard:ce,reporterVoice:N,setReporterVoice:W,intervieweeVoice:j,setIntervieweeVoice:H,videoAspectRatio:f,setVideoAspectRatio:_,interviewMode:h,setInterviewMode:J,backgroundPrompt:G,setBackgroundPrompt:D,onGenerateBackgrounds:We,isGeneratingBackgrounds:Q,selectedBackground:x,globalVoiceInstruction:y,setGlobalVoiceInstruction:q,customBackgroundFile:v,setCustomBackgroundFile:X,backgroundVariationsCount:k,setBackgroundVariationsCount:K})}),e.jsx("div",{className:"lg:col-span-2 xl:col-span-3",children:e.jsx(ut,{generationStep:Y,scenes:c,isLoading:ce,isGeneratingPrompts:!1,error:L,voiceoverScript:ee,onVoiceoverScriptChange:te,onGeneratePrompts:Ie,sceneOverrides:{},onGenerateImage:_e,onSceneImagePromptChange:ze,onSceneVideoPromptChange:Je,onSceneVoiceoverGuideChange:Qe,onSceneEnhancementChange:()=>{},onSceneOverrideChange:()=>{},onDeleteImage:()=>{},onViewImage:pe,onUploadImageForVideo:()=>{},onGenerateAllImages:tt,isBatchGenerating:Pe,onViewStoryboard:()=>fe(!0),onDownloadAllImages:()=>bt(U.length>0?c.map(a=>({...a,images:U})):c),isDownloadingImages:Re,onDownloadAllVideos:()=>pt(c),isDownloadingVideos:$e,onSelectImageForVideo:()=>{},onGenerateVideo:oe,onToggleVideoUpscale:()=>{},onUpscaleVideo:()=>{},onGenerateAllVideos:et,isBatchGeneratingVideos:Ue,onUpscaleAllVideos:()=>{},isBatchUpscalingVideos:Ee,generatedEnvironments:U,onGenerateAudio:re,onGenerateAllAudio:Ye,isBatchGeneratingAudio:De,activeModule:"street-interview",onAddScene:He,onPickAllImages:Xe,onSelectEnvironment:$,selectedEnvironment:x,onSendAllImagesToTelegram:at,isSendingImagesToTelegram:Me,onSendAllVideosToTelegram:rt,isSendingVideosToTelegram:Oe,videoAspectRatio:f,onToggleDialogueInPrompt:qe,onGenerateEnhancedPrompt:()=>{},onSceneVoiceoverScriptChange:Ke,onDeleteScene:nt,onDeleteVideo:Ze})})]})}),ue&&e.jsx(yt,{imageUrl:ue,onClose:()=>pe(null)}),Be&&e.jsx(ht,{scenes:c,onClose:()=>fe(!1),videoAspectRatio:f})]})};export{Rt as default};
